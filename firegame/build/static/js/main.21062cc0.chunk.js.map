{"version":3,"sources":["routes/7wd/app/index.module.css","shared/styles.module.css","routes/love_letter/app/index.module.css","firegame/components/index.module.css","firegame/firebase.tsx","firegame/writer/game.tsx","firegame/writer/lobby.tsx","firegame/writer/utils.tsx","firegame/writer/writer.tsx","shared/store.tsx","shared/shared.tsx","routes/fox/app/utils/utils.tsx","routes/fox/app/main/playCard.tsx","routes/fox/app/main/HandCard.tsx","routes/fox/app/main/Hand.tsx","routes/fox/app/main/Field.tsx","routes/fox/app/main/Rules.tsx","routes/fox/app/main/Main.tsx","routes/fox/app/utils/NewGame.tsx","shared/components/sidebar/LogEntry.tsx","shared/components/sidebar/SharedLog.tsx","shared/components/sidebar/SharedSidebar.tsx","routes/fox/app/sidebar/Sidebar.tsx","routes/fox/app/Fox.tsx","routes/timeline/app/utils/utils.tsx","routes/timeline/app/main/Hand.tsx","routes/timeline/app/main/Board.tsx","routes/timeline/app/main/Main.tsx","routes/timeline/app/utils/Quizlet.tsx","routes/timeline/app/utils/NewGame.tsx","routes/7wd/app/utils/types.tsx","routes/timeline/app/sidebar/Settings.tsx","routes/timeline/app/sidebar/Sidebar.tsx","routes/timeline/app/Timeline.tsx","routes/7wd/app/main/Science.tsx","routes/7wd/app/main/Main.tsx","routes/7wd/app/utils/bank.tsx","routes/7wd/app/main/structure/StructureCard.tsx","routes/7wd/app/main/structure/Structure.tsx","routes/7wd/app/main/player/Tokens.tsx","routes/7wd/app/main/player/Wonders.tsx","routes/7wd/app/main/player/Sciences.tsx","routes/7wd/app/main/player/Cards.tsx","routes/7wd/app/main/player/God.tsx","routes/7wd/app/main/player/Player.tsx","routes/7wd/app/main/Military.tsx","routes/7wd/app/main/Trash.tsx","routes/7wd/app/main/commercial/Isis.tsx","routes/7wd/app/main/commercial/ChooseWonder.tsx","routes/7wd/app/main/commercial/DestroyCard.tsx","routes/7wd/app/main/commercial/Revive.tsx","routes/7wd/app/main/commercial/Library.tsx","routes/7wd/app/main/commercial/DestroyWonder.tsx","routes/7wd/app/main/commercial/PickGod.tsx","routes/7wd/app/main/commercial/Anubis.tsx","routes/7wd/app/main/commercial/Ra.tsx","routes/7wd/app/main/commercial/Nisaba.tsx","routes/7wd/app/main/commercial/Enki.tsx","routes/7wd/app/main/commercial/Baal.tsx","routes/7wd/app/main/commercial/Theater.tsx","routes/7wd/app/main/commercial/Gate.tsx","routes/7wd/app/main/commercial/Commercial.tsx","routes/7wd/app/main/Pantheon.tsx","routes/7wd/app/utils/utils.tsx","routes/7wd/app/utils/NewGame.tsx","routes/love_letter/app/utils/NewGame.tsx","routes/7wd/app/sidebar/Sidebar.tsx","routes/7wd/app/X7wd.tsx","routes/love_letter/app/utils/utils.tsx","routes/love_letter/app/main/Action.tsx","routes/love_letter/app/Rules.tsx","routes/love_letter/app/main/HandCard.tsx","routes/love_letter/app/main/Me.tsx","routes/love_letter/app/main/Cardinal.tsx","routes/love_letter/app/main/Baroness.tsx","routes/love_letter/app/main/ActionComponent.tsx","routes/love_letter/app/main/Bishop.tsx","routes/love_letter/app/main/BishopDiscard.tsx","routes/love_letter/app/main/Guard.tsx","routes/love_letter/app/main/Winner.tsx","routes/splendor/app/utils/bank.tsx","routes/love_letter/app/main/TwoPlayerAside.tsx","routes/love_letter/app/main/Main.tsx","routes/love_letter/app/sidebar/Sidebar.tsx","routes/love_letter/app/LoveLetter.tsx","routes/splendor/app/utils/utils.tsx","routes/splendor/app/main/Me.tsx","routes/splendor/app/main/Players.tsx","routes/splendor/app/main/Cards.tsx","routes/splendor/app/main/Nobles.tsx","routes/splendor/app/main/Tokens.tsx","routes/splendor/app/main/Main.tsx","routes/splendor/app/utils/NewGame.tsx","routes/splendor/app/sidebar/Sidebar.tsx","firegame/games.tsx","routes/splendor/app/Splendor.tsx","firegame/components/Home.tsx","firegame/components/LoadingPage.tsx","firegame/components/LoginPage.tsx","firegame/components/GameWrapper.tsx","App.tsx","serviceWorker.ts","index.tsx","routes/timeline/app/index.module.css"],"names":["module","exports","database","latest","config","databaseURL","offset","init","firebase","initializeApp","window","clear","ref","set","undo","gamePath","once","then","data","val","now","Date","latestChild","path","callback","limitToLast","on","snapshot","Object","keys","push","obj","connect","sendGameStateHelper","gameWrapper","Firebase","receiveGameUpdate","record","info","timestamp","store","gameW","update","playerId","me","userId","playerName","lobby","message","host","id","game","updateTimestamp","mePath","setLobbyFromRemote","remoteLobby","entries","person","username","signin","length","lobbyEquals","gameHasStarted","setInterval","initialized","Error","lobbyPath","roomPath","undefined","process","REACT_APP_NAMESPACE","location","hostname","replace","split","gameName","roomId","update_","localStorage","version","VERSION","Math","random","toString","substr","getUserId","setUsername","myUserObj","signInTime","sendGameState","isNewGame","lastInfo","alert","game_","writer","Shared","utils","this","getCurrent","currentPlayer","playerIndexByIndex","index","players","map","player","indexOf","playerIndexById","getPlayer","myIndex","currentIndex","arr","i","j","floor","f","dict","forEach","t","key","userName","value","count","Array","from","enumType","values","filter","e","store_","shared","deal","dealer","lead","deck","suit","String","fromCharCode","shuffle","buildDeck","assign","hand","dealHand","tricks","dealPlayers","trump","shift","sortHand","sort","a","b","getSortPosition","card","codePointAt","getText","playCard","getMe","fromStaging","Boolean","staging","handlePre_3_5","handCard","canPlay","splice","duringMessage","drawnCard","text","unshift","handleDuring_3_5","winner","incrementPlayerTurn","wins","score","handlePost_1_7","previous","scores","join","playerState","scoreFromTricks","HandCard","className","styles","bubble","onClick","play","bind","props","isMyTurn","React","Component","Hand","Field","l","Rules","Main","createPlayers","params","setDefault","NewGame","Promise","resolve","LogEntry","revert","getMessage","w","wrapper","time","toLocaleTimeString","history","Log","state","updateHistory","newState","JSON","parse","stringify","setState","dont_grow","log_entry_parent","log_entry_child","becomeHost","response","prompt","open","SharedSidebar","name","sidebar","renderStartNewGame","kick","renderPlayer","renderInfo","href","SharedLog","getParams","catch","console","error","maybeSyncParams","document","title","Sidebar","startNewGame","prefix","parts","Fox","my_turn","main","content","sortBoard","board","getHand","renderCard","termIndex","handIndex","term","terms","classes","selectedIndex","css","selectedCard","selectCard","word","image","src","alt","stopPropagation","Board","getCardsAndTargets","cardsAndTargets","renderTarget","target","last","wrongTarget","selectTarget","board_card","correct","incorrect","definition","targetIndex","leftBound","rightBound","isBetween","pop","_api_url","SET_URL","fetch","base","json","responses","models","TERMS_URL","SEARCH_URL","FOLDER_URL","fetchBySetId","setId","setPromise","Quizlet","termsPromise","all","fetchByQuery","queryString","setDeck","_imageUrl","rank","swap","useRank","reverse","parseInt","setPlayers","handSize","setBoard","boardStartingSize","Age","Resource","Color","ScienceEnum","Upgrade","God","ScienceToken","CommercialEnum","quizlet","Settings","handSizeRef","createRef","boardSizeRef","swapRef","reverseRef","useRankRef","quizletRef","fetchFromFolder","settings_form","settings_input","type","defaultValue","size","settings_select","onChange","selectChange","defaultChecked","getSets","refresh","fetchedFromFolderVersion","sets","setsToTitles","preventDefault","option","options","current","fetchFromFolderHelper","fetchedFromFolder","seedFromFolder","blob","promises","folderSet","model","checked","settingsRef","Timeline","SelectedEnum","Science","flex","sciences","slice","taken","token","renderScience","scienceToken","select","enumName","isMyCommercial","science","buildScienceToken","cards","age","one","color","brown","cost","extra","resource","wood","clay","stone","money","grey","paper","glass","blue","upgradesTo","water","points","crescent","mask","red","military","sword","crown","horseshoe","yellow","discount","vase","green","wheel","writing","book","bowl","gear","two","upgradesFrom","pillar","sun","capital","helmet","resourceOptions","barrel","harp","lamp","three","cardIndex","wonders","wonder","built","astrolabe","tablet","guild","purple","max","temple","godUpgrade","egyptian","phoenician","mesopotamian","roman","greek","gods","source","addCommercial","commercial","anubis","playerIndex","ra","isis","zeus","revive","enki","nisaba","gainScience","law","baal","astarte","myTokens","militaryBonuses","oppTokens","getOpponent","minerva","increaseMilitary","gate","m","assignEnki","goAgain","destroyGrey","destroyBrown","expansion","stealMoney","library","theater","find","godIndex","structure","bank","StructureCard","structure_card","x","y","style","transform","visibility","zIndex","revealed","godExpansion","backgroundColor","getCardCost","renderExtra","Structure","row","structure_row","structure_first_row","Tokens","tokens","tokenIndex","usedTokens","commercials","isGod","Wonders","nowrap","_","renderWonder","playerWonder","wonderIndex","contents","renderBuilt","renderUnbuilt","built_wonder","selected","selectSelf","getWonderCost","Sciences","Cards","cardsByColor","arrToDict","renderColorCards","toLocaleString","god","Player","selectWonder","getScore","scienceTokens","Military","NUM_POSITIONS","getFill","getMilitaryPoints","abs","endCommercial","militaryDiff","stars","repeat","trash","Isis","pWonder","trashIndex","ChooseWonder","total","wondersToChoose","remaining","indexS","chooseWonder","DestroyCard","victim","destroyCard","Revive","reviveCard","handleCardGain","Library","scienceName","DestroyWonder","PickGod","godTokens","selectedPantheon","pantheon","reset","Anubis","wondersToUnbuild","concat","wonderObj","Ra","wondersToSteal","Nisaba","Enki","Baal","cardsToSteal","Theater","flatMap","Gate","Commercial","destroyWonder","pickGod","Pantheon","renderGod","pantheonIndex","selectPantheon","godContent","keyName","build","onKeyDown","renderPlayers","getPlayers","Trash","selectTrash","selectedTarget","discountToken","buyGod","Utils","tokenToPoints","agriculture","mathematics","mysticism","philosophy","wentFirst","cardsToUse","ic","assignGate","matchAge","purples","mapRow","rowIndex","getMilitary","rawCosts","costs","countResources","myResources","oppResources","discounts","price","paid","r","needed","pricePer","includes","getWonderOptions","r_","o","masonry","getCostCost","engineering","pool","resources","cardPoints","reduce","moneyPoints","guildPoints","g","militaryPoints","sciencePoints","wonderPoints","godPoints","numTemples","amount","architecture","polioretics","direction","diff","bonus","scienceIcons","col","rowBelow","gridX","isPurchase","urbanism","strategy","structureCard","canTakeCard","economy","resourceCost","c","rowAboveY","rowAbove","aboveCard","takeToken","theology","flat","sc","3","6","9","prepareToChooseWonders","maybePrepareExpansion","isNaN","Card","expansionRef","_7wd","COUNTS","guard","priest","baron","handmaid","prince","king","countess","princess","bishop","queen","constable","sycophant","baroness","cardinal","guardX","jester","assassin","Ranks","v","aside","p","played","two_p_aside","getValue","ComponentsE","setWinner","orderedPlayers","h","tiedPlayers","knockedOut","draw","RULES","FLAVOR","cardString","getCard","discard","advanceTurn","Me","Cardinal","action","requestAnimationFrame","actionHelper","targets","finish","execute","p1","p2","renderView","renderChoose","view","choose","prev","Baroness","msg","ActionComponent","executed","Bishop","inputRef","onSubmit","executeHelper","choice","msgB","BishopDiscard","toDiscard","cardB","Guard","Winner","rawMsg","ranks","actioning","Token","Level","ComponentsM","bishopDiscard","Action","getTargets","loser","diffQ","cc","TwoPlayerAside","LoveLetter","level","black","white","nobles","tooManyTokens","over","num","n","mustDiscard","selectToken","selectedTokens","buyHandCard","Players","tokensString","enumArray","reserve","goldSelected","buyCard","selectGold","gainToken","gold","finishTurn","Nobles","isSelected","renderToken","take","allowSelect","clearSelect","s","min","toTake","allowed","buyCardHelper","goldToPay","outstanding","bill","NaN","handValue","myColors","noble","number","setCards","setNobles","setTokens","fox","timeline","loveletter","splendor","Home","games","renderLink","to","toLocaleUpperCase","LoadingPage","LoginPage","login","GameWrapper","forceUpdate","component","App","exact","routes","render","match","getRoutes","ReactDOM","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.21062cc0.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"structure_first_row\":\"app_structure_first_row__1SfcR\",\"structure_row\":\"app_structure_row__1ZtZT\",\"structure_card\":\"app_structure_card__1lUW2\",\"built_wonder\":\"app_built_wonder__3QPgH\",\"nowrap\":\"app_nowrap__3S69u\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bubble\":\"styles_bubble__1BYLx\",\"flex\":\"styles_flex__2Uon1\",\"dont_grow\":\"styles_dont_grow__3fglV\",\"log_entry_parent\":\"styles_log_entry_parent__Spbio\",\"log_entry_child\":\"styles_log_entry_child__24WM2\",\"my_turn\":\"styles_my_turn__1uYPS\",\"grey\":\"styles_grey__3crEA\",\"sidebar\":\"styles_sidebar__31Rw6\",\"main\":\"styles_main__2EatF\",\"content\":\"styles_content__8FZAu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"blue\":\"app_blue__OP3Ng\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"login\":\"components_login__1by_G\"};","// https://console.firebase.google.com/u/0/project/firegame-7eb05/database/firegame-7eb05/data/~2F\n\nimport firebase from \"firebase/app\";\nimport \"firebase/database\";\nimport { gamePath } from \"./writer/utils\";\n\nconst config = { databaseURL: \"https://firegame-7eb05.firebaseio.com/\" };\n\nvar database: { ref: (path: string) => any };\ntype ResultType = { val: () => BlobType | null };\ntype BlobType = any;\n\nvar latest: string;\n\nvar offset: number = 0;\nfunction init(): void {\n\tfirebase.initializeApp(config);\n\tdatabase = firebase.database();\n\t// @ts-ignore\n\twindow.clear = () => database.ref(\"/\").set({});\n\t// @ts-ignore\n\twindow.undo = () => database.ref(`${gamePath()}/${latest}`).set({});\n\tdatabase\n\t\t.ref(\".info/serverTimeOffset\")\n\t\t.once(\"value\")\n\t\t.then((data: ResultType) => (offset = data.val()));\n}\n\nfunction now(): number {\n\treturn offset + Date.now();\n}\n\nfunction latestChild(path: string, callback: (value: BlobType) => void): void {\n\tdatabase\n\t\t.ref(path)\n\t\t.limitToLast(1)\n\t\t.on(\"value\", (snapshot: ResultType) => {\n\t\t\tvar val = snapshot.val();\n\t\t\tif (val) latest = Object.keys(val)[0];\n\t\t\tcallback(val);\n\t\t});\n}\n\nfunction push(path: string, obj: BlobType): void {\n\tdatabase.ref(path).push(obj);\n}\n\nfunction connect(path: string, callback: (value: BlobType) => void): void {\n\tdatabase.ref(path).on(\"value\", (snapshot: ResultType) => {\n\t\tvar val = snapshot.val();\n\t\tcallback(val);\n\t});\n}\n\nfunction set(path: string, obj: BlobType): void {\n\tdatabase.ref(path).set(obj);\n}\n\nexport default { init, now, latestChild, push, connect, set };\n","import store, { GameWrapperType } from \"../../shared/store\";\n\nimport Firebase from \"../firebase\";\n\nimport { gamePath, update } from \"./utils\";\n\nconst GAME_EXPIRE_TIME = 2 * 60 * 60 * 1000;\n\ntype RecordType<T> = { [updateKey: string]: GameWrapperType<T> };\n\nfunction enterGame(): void {\n\tFirebase.latestChild(gamePath(), receiveGameUpdate);\n}\n\nfunction sendGameState<T>(message: string, game: T, isNewGame?: boolean): void {\n\tconst lastInfo = store.gameW.info;\n\tconst gameWrapper: GameWrapperType<T> = {\n\t\tgame,\n\t\tinfo: {\n\t\t\tid: lastInfo.id + 1,\n\t\t\ttimestamp: Firebase.now(),\n\t\t\thost: lastInfo.host,\n\t\t\tplayerId: store.me.userId,\n\t\t\tplayerName: store.lobby[store.me.userId],\n\t\t\tmessage,\n\t\t},\n\t};\n\tif (game === undefined) delete gameWrapper.game;\n\tif (lastInfo.alert) gameWrapper.info.alert = lastInfo.alert;\n\tif (isNewGame) gameWrapper.info.isNewGame = isNewGame;\n\tsendGameStateHelper(gameWrapper);\n}\n\nfunction sendGameStateHelper<T>(gameWrapper: GameWrapperType<T>): void {\n\tFirebase.push(gamePath(), gameWrapper);\n}\n\nfunction receiveGameUpdate<T>(record: RecordType<T>): void {\n\tif (record) {\n\t\tconst timestamp = Object.keys(record)[0];\n\t\tconst gameWrapper = record[timestamp];\n\t\tif (Firebase.now() - gameWrapper.info.timestamp < GAME_EXPIRE_TIME) {\n\t\t\t// @ts-ignore read only\n\t\t\tstore.gameW = gameWrapper;\n\t\t\tupdate();\n\t\t\treturn;\n\t\t}\n\t}\n\tif (store.gameW) return;\n\tconst gameWrapper: GameWrapperType<T | null> = {\n\t\tinfo: {\n\t\t\tplayerId: store.me.userId,\n\t\t\tplayerName: store.lobby[store.me.userId],\n\t\t\tmessage: \"opened a room\",\n\t\t\thost: store.me.userId,\n\t\t\ttimestamp: Firebase.now(),\n\t\t\tid: 0,\n\t\t},\n\t\tgame: null,\n\t};\n\tsendGameStateHelper(gameWrapper);\n}\n\nexport { enterGame, sendGameState };\n","import store, { LobbyType } from \"../../shared/store\";\n\nimport Firebase from \"../firebase\";\n\nimport { lobbyPath, mePath, update } from \"./utils\";\nimport { enterGame } from \"./game\";\n\nconst PRESENT_EXPIRE = 3000;\nconst HEARTBEAT_INTERVAL = 1000;\n\ntype RemotePersonType = {\n\tuserId: string;\n\tusername: string;\n\ttimestamp: number;\n\tsignInTime: number;\n};\n\nfunction heartbeat(): void {\n\tsetInterval(updateTimestamp, HEARTBEAT_INTERVAL);\n}\n\nfunction updateTimestamp(): void {\n\tFirebase.set(`${mePath()}/timestamp`, Firebase.now());\n}\n\nfunction lobbyEquals(lobby: LobbyType): boolean {\n\tif (!store.lobby) return false;\n\tif (Object.keys(lobby).length !== Object.keys(store.lobby).length)\n\t\treturn false;\n\tfor (let [userId, username] of Object.entries(lobby)) {\n\t\tif (store.lobby[userId] !== username) return false;\n\t}\n\treturn true;\n}\n\nfunction setLobbyFromRemote(remoteLobby: {\n\t[userId: string]: RemotePersonType;\n}): void {\n\tconst lobby: LobbyType = {};\n\tif (remoteLobby) {\n\t\tfor (let [userId, person] of Object.entries(remoteLobby)) {\n\t\t\tif (Firebase.now() - person.timestamp > PRESENT_EXPIRE) continue;\n\t\t\tlobby[userId] = person.username;\n\t\t\tif (userId === store.me.userId) signin();\n\t\t}\n\t}\n\tif (!lobbyEquals(lobby)) {\n\t\t// @ts-ignore read only\n\t\tstore.lobby = lobby;\n\t\tupdate();\n\t}\n}\n\nfunction setUsername(username: string): void {\n\tconst userId: string = store.me.userId;\n\tconst now: number = Firebase.now();\n\tconst myUserObj: RemotePersonType = {\n\t\tuserId,\n\t\tusername,\n\t\ttimestamp: now,\n\t\tsignInTime: now,\n\t};\n\tFirebase.set(mePath(), myUserObj);\n}\n\nvar gameHasStarted: boolean = false;\nfunction signin(): void {\n\tif (gameHasStarted) return;\n\tgameHasStarted = true;\n\theartbeat();\n\tenterGame();\n}\n\nfunction enterLobby() {\n\tFirebase.connect(lobbyPath(), setLobbyFromRemote);\n}\n\nexport { setUsername, enterLobby };\n","import { VERSION } from \"../../shared/shared\";\nimport store, { MeType } from \"../../shared/store\";\n\nimport Firebase from \"../firebase\";\n\nimport { enterLobby } from \"./lobby\";\n\nvar initialized = false;\nfunction init(roomId: number, gameName: string, update_: () => void) {\n\tif (initialized) return;\n\tinitialized = true;\n\tFirebase.init();\n\tconst userId = getUserId();\n\tconst me: MeType = {\n\t\troomId,\n\t\tgameName,\n\t\tVERSION,\n\t\tuserId,\n\t};\n\t// @ts-ignore read only\n\tstore.me = me;\n\tupdate = update_;\n\tenterLobby();\n}\n\nfunction getUserId(): string {\n\tif (localStorage.version !== VERSION) {\n\t\tlocalStorage.version = VERSION;\n\t\tlocalStorage.userId = `u_${Math.random().toString(16).substr(2)}`;\n\t}\n\treturn localStorage.userId;\n}\n\nvar update = function (): void {\n\tthrow Error(\"this should be overwritten during init\");\n};\n\nfunction lobbyPath(): string {\n\treturn `${roomPath()}/lobby`;\n}\n\nfunction mePath(userId?: string): string {\n\tif (userId === undefined) userId = store.me.userId;\n\treturn `${lobbyPath()}/${userId}`;\n}\n\nfunction namespace(): string {\n\treturn (\n\t\tprocess.env.REACT_APP_NAMESPACE ||\n\t\twindow.location.hostname.replace(\"www.\", \"\").split(\".\")[0]\n\t);\n}\n\nfunction roomPath(): string {\n\treturn `${namespace()}/${store.me.gameName}/${store.me.roomId}`;\n}\n\nfunction gamePath(): string {\n\treturn `${roomPath()}/game`;\n}\n\nexport { init, update, mePath, lobbyPath, gamePath };\n","import { init } from \"./utils\";\nimport { setUsername } from \"./lobby\";\nimport { sendGameState } from \"./game\";\n\nexport default { init, setUsername, sendGameState };\n","import writer from \"../firegame/writer/writer\";\n\nvar store: StoreType<any>;\n\nexport type StoreType<T> = Readonly<{\n\tme: Readonly<MeType>;\n\tlobby: Readonly<LobbyType>;\n\tgameW: Readonly<GameWrapperType<T>>;\n\tupdate: (message: string, newGame?: T) => void;\n}>;\n\nexport type MeType = {\n\tuserId: string;\n\troomId: number;\n\tgameName: string;\n\tVERSION: string;\n};\n\nexport type GameWrapperType<T> = {\n\tinfo: InfoType;\n\tgame: T;\n};\n\nexport type LobbyType = { [userId: string]: string };\n\nexport type InfoType = {\n\thost: string;\n\ttimestamp: number;\n\tid: number;\n\tmessage: string;\n\tplayerId: string;\n\tplayerName: string;\n\tisNewGame?: boolean;\n\talert?: string;\n};\n\nfunction update<T>(message: string, game_: T | undefined = undefined): void {\n\tconst game = game_ || store.gameW.game;\n\twriter.sendGameState(message, game, game_ !== undefined);\n}\n\n// @ts-ignore store initialization\nstore = { update };\n\nexport default store;\n","import store from \"./store\";\n\nexport const VERSION: string = \"v0.1.1\";\n\ninterface TurnGame<T extends PlayerType> {\n\tcurrentPlayer: number;\n\tplayers: T[];\n}\n\ninterface PlayerType {\n\tuserId: string;\n\tuserName: string;\n}\n\nclass Shared<T extends TurnGame<U>, U extends PlayerType> {\n\tconstructor() {\n\t\t// @ts-ignore\n\t\twindow.store = store;\n\t\t// @ts-ignore\n\t\twindow.utils = this;\n\t}\n\n\tisMyTurn(game_: T | undefined = undefined): boolean {\n\t\tconst game: T = game_ || store.gameW.game!;\n\t\tif (!game) return false;\n\t\treturn this.getCurrent(game).userId === store.me.userId;\n\t}\n\n\tincrementPlayerTurn(game_: T | undefined = undefined): void {\n\t\tconst game: T = game_ || store.gameW.game!;\n\t\tgame.currentPlayer = this.playerIndexByIndex(\n\t\t\tgame.currentPlayer + 1,\n\t\t\tgame\n\t\t);\n\t}\n\n\tplayerIndexByIndex(\n\t\tindex: number,\n\t\tgame_: T | undefined = undefined\n\t): number {\n\t\tconst game: T = game_ || store.gameW.game!;\n\t\treturn index % game.players.length;\n\t}\n\n\tplayerIndexById(userId: string, game_: T | undefined = undefined): number {\n\t\tconst game: T = game_ || store.gameW.game!;\n\t\treturn game.players.map((player) => player.userId).indexOf(userId);\n\t}\n\n\tmyIndex(game: T | undefined = undefined): number {\n\t\treturn this.playerIndexById(store.me.userId, game);\n\t}\n\n\tgetPlayer(index: number, game_: T | undefined = undefined): U {\n\t\tconst game: T = game_ || store.gameW.game!;\n\t\treturn game.players[index];\n\t}\n\n\tgetMe(game_: T | undefined = undefined): U {\n\t\treturn this.getPlayer(this.myIndex(game_));\n\t}\n\n\tgetCurrent(game_: T | undefined = undefined): U {\n\t\treturn this.getPlayer(this.currentIndex(game_), game_);\n\t}\n\n\tcurrentIndex(game_: T | undefined = undefined): number {\n\t\tconst game: T = game_ || store.gameW.game!;\n\t\treturn game.currentPlayer;\n\t}\n\n\tshuffle<T>(arr: T[]): T[] {\n\t\tfor (let i = arr.length - 1; i > 0; i--) {\n\t\t\tlet j = Math.floor(Math.random() * (i + 1));\n\t\t\t[arr[i], arr[j]] = [arr[j], arr[i]];\n\t\t}\n\t\treturn arr;\n\t}\n\n\tarrToDict<T>(arr: T[], f: (t: T) => string): { [key: string]: T[] } {\n\t\tconst dict: { [key: string]: T[] } = {};\n\t\tarr.forEach((t) => {\n\t\t\tconst key = f(t);\n\t\t\tif (!dict[key]) dict[key] = [];\n\t\t\tdict[key].push(t);\n\t\t});\n\t\treturn dict;\n\t}\n\n\tm(index: number) {\n\t\tconst game: T = store.gameW.game;\n\t\tconst player = game.players[index];\n\t\tplayer.userId = store.me.userId;\n\t\tstore.update(`is masquerading as ${player.userName}`);\n\t}\n\n\trepeat<X>(value: X, count: number): X[] {\n\t\treturn Array.from(new Array(count).map(() => value));\n\t}\n\n\tenumArray<X>(enumType: X): number[] {\n\t\treturn Object.values(enumType).filter((e) => typeof e === \"number\");\n\t}\n}\n\nexport default Shared;\n","import Shared from \"../../../../shared/shared\";\nimport store, { StoreType } from \"../../../../shared/store\";\n\nimport { GameType, Card, PlayerType } from \"./NewGame\";\n\nconst store_: StoreType<GameType> = store;\nconst shared: Shared<GameType, PlayerType> = new Shared();\nconst NUM_RANKS = 11;\nconst NUM_SUITS = 3;\nconst TRICKS_PER_ROUND = 13;\n\nfunction deal(game: GameType): GameType {\n\tgame.currentPlayer = game.dealer;\n\tgame.dealer = shared.playerIndexByIndex(game.dealer + 1, game);\n\tgame.lead = null;\n\tgame.deck = buildDeck();\n\tgame.players = dealPlayers(game);\n\tgame.trump = game.deck.shift()!;\n\treturn game;\n}\n\nfunction buildDeck(): Card[] {\n\tconst deck = [];\n\tfor (let i = 0; i < NUM_SUITS; i++) {\n\t\tlet suit = String.fromCharCode(65 + i);\n\t\tfor (let value = 1; value <= NUM_RANKS; value++) {\n\t\t\tdeck.push({ suit, value });\n\t\t}\n\t}\n\tshared.shuffle(deck);\n\treturn deck;\n}\n\nfunction dealPlayers(game: GameType): PlayerType[] {\n\treturn game.players.map((player) =>\n\t\tObject.assign(player, { hand: dealHand(game), tricks: 0 })\n\t);\n}\n\nfunction dealHand(game: GameType): Card[] {\n\tconst hand = [];\n\tfor (let i = 0; i < TRICKS_PER_ROUND; i++) {\n\t\thand.push(game.deck.shift()!);\n\t}\n\tsortHand(hand);\n\treturn hand;\n}\n\nfunction sortHand(hand: Card[]): void {\n\thand.sort((a, b) => getSortPosition(a) - getSortPosition(b));\n}\n\nfunction getSortPosition(card: Card) {\n\treturn card.suit.codePointAt(0)! * NUM_RANKS + card.value;\n}\n\nfunction getText(card: Card) {\n\treturn `${card.suit}/${card.value || \"-\"}`;\n}\n\nexport { store_ as store, deal, shared, getText, sortHand };\n","import { store, shared, deal, getText, sortHand } from \"../utils/utils\";\nimport { Card, PlayerType } from \"../utils/NewGame\";\n\nfunction playCard(index: number): string | void {\n\tconst me = shared.getMe();\n\tvar card = me.hand![index];\n\tconst game = store.gameW.game;\n\tconst fromStaging = Boolean(game.staging);\n\tif (fromStaging) {\n\t\thandlePre_3_5(card);\n\t\tcard = game.staging!;\n\t\tgame.staging = null;\n\t} else if (game.lead) {\n\t\tif (!canPlay(card, game.lead)) return alert(\"cant play that card\");\n\t}\n\tme.hand!.splice(index, 1);\n\tif (!fromStaging) {\n\t\tvar duringMessage = handleDuring_3_5(card);\n\t\tif (duringMessage !== null) {\n\t\t\tgame.staging = card;\n\t\t\treturn store.update(duringMessage);\n\t\t}\n\t}\n\tvar text = getText(card);\n\tif (!game.lead) {\n\t\tgame.lead = card;\n\t\tshared.incrementPlayerTurn();\n\t\treturn store.update(`lead with ${text}`);\n\t} else {\n\t\tvar winner;\n\t\tif (wins(card)) {\n\t\t\twinner = me;\n\t\t} else {\n\t\t\tshared.incrementPlayerTurn();\n\t\t\twinner = shared.getCurrent();\n\t\t}\n\t\twinner.tricks++;\n\t\thandlePost_1_7(card, winner);\n\t\tgame.previous = `${getText(game.lead)} vs ${text}`;\n\t\tgame.lead = null;\n\t\tvar message = `played ${text}`;\n\t\tif (me.hand!.length === 0) {\n\t\t\tvar scores = game.players\n\t\t\t\t.map((player) => `${player.userName}: ${player.tricks}`)\n\t\t\t\t.join(\" / \");\n\t\t\tmessage = `${message} - new hand - ${scores}`;\n\t\t\tgame.previous += `\\n${scores}`;\n\t\t\tscoreFromTricks();\n\t\t\tdeal(game);\n\t\t}\n\t\tstore.update(message);\n\t}\n}\n\nfunction canPlay(card: Card, lead: Card) {\n\tif (card.suit === lead.suit) {\n\t\tif (lead.value !== 11) {\n\t\t\treturn true;\n\t\t} else if (card.value === 1) {\n\t\t\treturn true;\n\t\t}\n\t}\n\tvar hand = shared.getMe().hand;\n\tfor (var i = 0; i < hand!.length; i++) {\n\t\tvar handCard = hand![i];\n\t\tif (handCard.suit === lead.suit) {\n\t\t\tif (lead.value === 11) {\n\t\t\t\tif (handCard.value > card.value) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nfunction handlePre_3_5(card: Card) {\n\tconst game = store.gameW.game;\n\tif (game.staging!.value === 5) {\n\t\tgame.deck.push(card);\n\t} else if (game.staging!.value === 3) {\n\t\tgame.trump = card;\n\t}\n}\n\nfunction handleDuring_3_5(card: Card) {\n\tconst hand = shared.getMe().hand!;\n\tconst game = store.gameW.game;\n\tif (card.value === 5) {\n\t\tvar drawnCard = game.deck.shift()!;\n\t\tvar text = getText(drawnCard);\n\t\talert(`you drew ${text}`);\n\t\thand.unshift(drawnCard);\n\t\tsortHand(hand);\n\t\treturn \"draws a card\";\n\t}\n\tif (card.value === 3) {\n\t\thand.unshift(game.trump);\n\t\tsortHand(hand);\n\t\treturn \"swaps trump\";\n\t}\n\treturn null;\n}\n\nfunction handlePost_1_7(card: Card, winner: PlayerType) {\n\tconst me = shared.getMe();\n\tconst game = store.gameW.game;\n\tif (card.value === 1) {\n\t\tif (winner !== me) {\n\t\t\tshared.incrementPlayerTurn();\n\t\t}\n\t} else if (game.lead!.value === 1) {\n\t\tif (winner === me) {\n\t\t\tshared.incrementPlayerTurn();\n\t\t}\n\t}\n\tif (card.value === 7) winner.score++;\n\tif (game.lead!.value === 7) winner.score++;\n}\n\nfunction wins(card: Card) {\n\tconst game = store.gameW.game;\n\tconst lead = game.lead!;\n\tif (card.suit === lead.suit) {\n\t\treturn card.value > lead.value;\n\t} else {\n\t\tif (card.value === 9) {\n\t\t\tif (lead.value !== 9) {\n\t\t\t\tif (lead.suit === game.trump.suit) {\n\t\t\t\t\treturn card.value > lead.value;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (lead.value === 9) {\n\t\t\tif (card.value < lead.value) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn card.suit === game.trump.suit;\n\t}\n}\n\nfunction scoreFromTricks() {\n\tconst players = store.gameW.game.players;\n\tfor (var i = 0; i < players.length; i++) {\n\t\tvar playerState = players[i];\n\t\tswitch (playerState.tricks) {\n\t\t\tcase 0:\n\t\t\tcase 1:\n\t\t\tcase 2:\n\t\t\tcase 3:\n\t\t\t\tplayerState.score += 6;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tplayerState.score += 1;\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tplayerState.score += 2;\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\tplayerState.score += 3;\n\t\t\t\tbreak;\n\t\t\tcase 7:\n\t\t\tcase 8:\n\t\t\tcase 9:\n\t\t\t\tplayerState.score += 6;\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport default playCard;\n","import React from \"react\";\n\nimport { store, getText, shared } from \"../utils/utils\";\nimport { Card } from \"../utils/NewGame\";\n\nimport playCard from \"./playCard\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass HandCard extends React.Component<{ card: Card; index: number }> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble} onClick={this.play.bind(this)}>\n\t\t\t\t{getText(this.props.card)}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tplay() {\n\t\tif (!shared.isMyTurn()) return;\n\t\tconst message = playCard(this.props.index);\n\t\tif (message) store.update(message);\n\t}\n}\n\nexport default HandCard;\n","import React from \"react\";\n\nimport { shared } from \"../utils/utils\";\nimport { Card } from \"../utils/NewGame\";\n\nimport HandCard from \"./HandCard\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Hand extends React.Component {\n\trender() {\n\t\tconst me = shared.getMe();\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Hand</h2>\n\t\t\t\t{me &&\n\t\t\t\t\tme.hand &&\n\t\t\t\t\tme.hand.map((card: Card, index: number) => (\n\t\t\t\t\t\t<HandCard key={index} card={card} index={index} />\n\t\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Hand;\n","import React from \"react\";\n\nimport { store, getText } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Field extends React.Component {\n\trender() {\n\t\tconst l = store.gameW.game.lead || { suit: \"-\", value: 0 };\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<p>Trump</p>\n\t\t\t\t\t<p>{getText(store.gameW.game.trump)}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<p>Lead</p>\n\t\t\t\t\t<p>{getText(l)}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<p>Last</p>\n\t\t\t\t\t<p>{store.gameW.game.previous}</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Field;\n","import React from \"react\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Rules extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Rules</h2>\n\t\t\t\t<pre className={styles.bubble}>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>11</span>{\" \"}\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\tIf lead, force either a 1 of same suit or highest\n\t\t\t\t\t\t\tcard of same suit\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>9</span>\n\t\t\t\t\t\t{\"  \"}\n\t\t\t\t\t\t<span>Counts as trump if is only 9</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>7</span>\n\t\t\t\t\t\t{\"  \"}\n\t\t\t\t\t\t<span>Winner of this trick gets a point</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>5</span>\n\t\t\t\t\t\t{\"  \"}\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\tDraw a card, then put a card at bottom of deck\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>3</span>\n\t\t\t\t\t\t{\"  \"}\n\t\t\t\t\t\t<span>May trade trump card with a card in hand</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>1</span>\n\t\t\t\t\t\t{\"  \"}\n\t\t\t\t\t\t<span>Lead next trick even if lose this trick</span>\n\t\t\t\t\t</div>\n\t\t\t\t</pre>\n\t\t\t\t<pre className={styles.bubble}>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>0-3</span>\n\t\t\t\t\t\t{\"  \"}/<span>6</span> <span>Humble</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>4</span>\n\t\t\t\t\t\t{\"    \"}/<span>1</span> <span>DEFEATED</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>5</span>\n\t\t\t\t\t\t{\"    \"}/<span>2</span> <span>Defeated</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>6</span>\n\t\t\t\t\t\t{\"    \"}/<span>3</span> <span>defeated</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>7-9</span>\n\t\t\t\t\t\t{\"  \"}/<span>6</span> <span>Victory</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span>10-13</span>/<span>0</span> <span>Greedy</span>\n\t\t\t\t\t</div>\n\t\t\t\t</pre>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Rules;\n","import React from \"react\";\n\nimport Hand from \"./Hand\";\nimport Field from \"./Field\";\nimport Rules from \"./Rules\";\n\nclass Main extends React.Component<{}, { selectedIndex: number }> {\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Hand />\n\t\t\t\t<br />\n\t\t\t\t<Field />\n\t\t\t\t<br />\n\t\t\t\t<Rules />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Main;\n","import { LobbyType } from \"../../../../shared/store\";\n\nimport { deal, shared } from \"./utils\";\n\nexport type GameType = {\n\tparams: Params;\n\tcurrentPlayer: number;\n\tplayers: PlayerType[];\n\tdealer: number;\n\tdeck: Card[];\n\tlead: Card | null;\n\ttrump: Card;\n\tstaging: Card | null;\n\tprevious: string;\n};\n\nexport type Params = {\n\tlobby: LobbyType;\n};\n\nexport type PlayerType = {\n\thand?: Card[];\n\ttricks: number;\n\tscore: number;\n\tuserId: string;\n\tuserName: string;\n};\n\nexport type Card = { suit: string; value: number };\n\nfunction NewGame(params: Params): PromiseLike<GameType> {\n\t// @ts-ignore game being constructed\n\tconst game: GameType = {};\n\tgame.params = params;\n\treturn Promise.resolve(game)\n\t\t.then(createPlayers)\n\t\t.then(setDefault)\n\t\t.then(deal);\n}\n\nfunction createPlayers(game: GameType): GameType {\n\tgame.players = Object.keys(game.params.lobby).map(\n\t\t(userId, index: number) => ({\n\t\t\thand: [],\n\t\t\ttricks: 0,\n\t\t\tscore: 0,\n\t\t\tuserId,\n\t\t\tuserName: game.params.lobby[userId],\n\t\t})\n\t);\n\treturn game;\n}\n\nfunction setDefault(game: GameType): GameType {\n\tgame.dealer = shared.myIndex(game);\n\tgame.previous = \"new game\";\n\treturn game;\n}\n\nexport default NewGame;\n","import React from \"react\";\n\nimport store, { GameWrapperType } from \"../../store\";\n\nclass LogEntry<T> extends React.Component<{\n\twrapper: GameWrapperType<T>;\n\thistory: GameWrapperType<T>[];\n}> {\n\trender() {\n\t\treturn <pre onClick={this.revert.bind(this)}>{this.getMessage()}</pre>;\n\t}\n\n\tgetMessage() {\n\t\tconst w = this.props.wrapper;\n\t\tconst time = new Date(w.info.timestamp).toLocaleTimeString();\n\t\treturn `(${w.info.id}) [${w.info.playerName}] ${w.info.message} ${time}`;\n\t}\n\n\trevert(): void {\n\t\tconst userId = store.me.userId;\n\t\tif (store.gameW.info.host !== userId) {\n\t\t\t// for (let gameW of this.props.history) {\n\t\t\t// if (gameW.info.id === this.props.wrapper.info.id) break;\n\t\t\t// if (gameW.info.playerId !== userId) {\n\t\t\talert(\"only the host can revert\");\n\t\t\treturn;\n\t\t\t// }\n\t\t\t// }\n\t\t}\n\t\tconst message = `restored to [${this.getMessage()}]`;\n\t\tstore.update(message, this.props.wrapper.game);\n\t}\n}\n\nexport default LogEntry;\n","import React from \"react\";\n\nimport store, { GameWrapperType } from \"../../store\";\n\nimport LogEntry from \"./LogEntry\";\n\nimport styles from \"../../styles.module.css\";\n\nconst history: GameWrapperType<any>[] = [];\n\nabstract class Log<T> extends React.Component<\n\t{},\n\t{ history: GameWrapperType<T>[] }\n> {\n\tconstructor(props: {}) {\n\t\tsuper(props);\n\t\tthis.state = { history };\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.updateHistory();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.updateHistory();\n\t}\n\n\tupdateHistory() {\n\t\tconst newState = store.gameW;\n\t\tif (\n\t\t\t!this.state.history[0] ||\n\t\t\tnewState.info.id !== this.state.history[0].info.id\n\t\t) {\n\t\t\tthis.state.history.unshift(JSON.parse(JSON.stringify(newState)));\n\t\t\tconst a = newState.info.alert;\n\t\t\tdelete newState.info.alert;\n\t\t\tif (a) alert(a);\n\t\t\t// trigger rerender\n\t\t\tthis.setState({});\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Log</h2>\n\t\t\t\t<div className={styles.dont_grow}>\n\t\t\t\t\t<div className={styles.log_entry_parent}>\n\t\t\t\t\t\t<div className={styles.log_entry_child}>\n\t\t\t\t\t\t\t{this.state.history.map((wrapper, index) => (\n\t\t\t\t\t\t\t\t<LogEntry\n\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\twrapper={wrapper}\n\t\t\t\t\t\t\t\t\thistory={this.state.history}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Log;\n","import React from \"react\";\n\nimport store from \"../../store\";\n\nimport { mePath } from \"../../../firegame/writer/utils\";\nimport Firebase from \"../../../firegame/firebase\";\nimport SharedLog from \"./SharedLog\";\n\nimport styles from \"../../../shared/styles.module.css\";\n\nabstract class SharedSidebar<T> extends React.Component {\n\tabstract name: string;\n\tabstract NewGame: (params: T) => any;\n\tabstract renderStartNewGame(): JSX.Element;\n\tabstract getParams(): T;\n\tabstract isMyTurn: () => boolean;\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.sidebar}>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2>{this.name}</h2>\n\t\t\t\t\t<div>{this.renderStartNewGame()}</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2 onClick={becomeHost}>Lobby</h2>\n\t\t\t\t\t{Object.entries(store.lobby).map(\n\t\t\t\t\t\t([userId, userName], index) => (\n\t\t\t\t\t\t\t<div key={index} onClick={() => kick(userId)}>\n\t\t\t\t\t\t\t\t{this.renderPlayer(userId, userName)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t{this.renderInfo()}\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2>\n\t\t\t\t\t\t<a href={\"..\"}>Home</a>\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t\t<SharedLog />\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderPlayer(userId: string, userName: string): JSX.Element {\n\t\treturn <>{userName}</>;\n\t}\n\n\tstartNewGame() {\n\t\tPromise.resolve()\n\t\t\t.then(this.getParams.bind(this))\n\t\t\t.then(this.NewGame)\n\t\t\t.catch((e) => {\n\t\t\t\talert(e);\n\t\t\t\tconsole.error(e);\n\t\t\t})\n\t\t\t.then((game) => game && store.update(\"started a new game\", game));\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.maybeSyncParams();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.maybeSyncParams();\n\t}\n\n\tmaybeSyncParams(): void {\n\t\tdocument.title = (this.isMyTurn() ? \"(!) \" : \"\") + this.name;\n\t}\n\n\trenderInfo(): JSX.Element | null {\n\t\treturn null;\n\t}\n}\n\nfunction kick(userId: string) {\n\tif (store.gameW.info.host !== store.me.userId) return;\n\tif (userId === store.me.userId) {\n\t\talert(\"Can't kick yourself.\");\n\t\treturn;\n\t}\n\tFirebase.set(mePath(userId), {});\n}\n\nfunction becomeHost() {\n\tif (store.gameW.info.host === store.me.userId) {\n\t\talert(\"You're already the host.\");\n\t\treturn;\n\t}\n\tconst response = window.prompt(\"Enter the password to become the host.\");\n\tif (!response) return;\n\tif (response !== \"danrules\") {\n\t\twindow.open(\"https://www.youtube.com/watch?v=RfiQYRn7fBg\");\n\t\treturn;\n\t}\n\tstore.gameW.info.host = store.me.userId;\n\tstore.update(\"became the host\");\n}\n\nexport default SharedSidebar;\n","import React from \"react\";\n\nimport { store, shared as utils } from \"../utils/utils\";\nimport NewGame, { Params } from \"../utils/NewGame\";\n\nimport SharedSidebar from \"../../../../shared/components/sidebar/SharedSidebar\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Sidebar extends SharedSidebar<Params> {\n\tname = \"Fox in the Forest\";\n\tNewGame = NewGame;\n\tisMyTurn = utils.isMyTurn.bind(utils);\n\n\tgetParams(): Params {\n\t\treturn {\n\t\t\tlobby: store.lobby,\n\t\t};\n\t}\n\n\trenderStartNewGame() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<button onClick={this.startNewGame.bind(this)}>New Game</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderPlayer(userId: string, userName: string): JSX.Element {\n\t\tvar prefix = \"\";\n\t\tif (store.gameW.info.host === userId) prefix += \"(host) \";\n\t\tif (store.me.userId === userId) prefix += \"(you) \";\n\t\tconst parts = [<p key={\"name\"}>{`${prefix}${store.lobby[userId]}`}</p>];\n\t\tconst player =\n\t\t\tstore.gameW.game?.players[shared.playerIndexById(userId)];\n\t\tif (player) {\n\t\t\tparts.push(<p key={\"tricks\"}>tricks: {player.tricks}</p>);\n\t\t\tparts.push(<p key={\"score\"}>score: {player.score}</p>);\n\t\t}\n\t\treturn (\n\t\t\t<div key={userId} className={styles.bubble}>\n\t\t\t\t{parts}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Sidebar;\n","import React from \"react\";\n\nimport { shared, store } from \"./utils/utils\";\nimport Main from \"./main/Main\";\nimport Sidebar from \"./sidebar/Sidebar\";\n\nimport styles from \"../../../shared/styles.module.css\";\n\nclass Fox extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={`${shared.isMyTurn() && styles.my_turn}`}>\n\t\t\t\t<div className={styles.main}>\n\t\t\t\t\t<Sidebar />\n\t\t\t\t\t<div className={styles.content}>\n\t\t\t\t\t\t<div>{store.gameW.game && <Main />}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Fox;\n","import Shared from \"../../../../shared/shared\";\nimport store, { StoreType } from \"../../../../shared/store\";\n\nimport { GameType, PlayerType } from \"./NewGame\";\n\nconst store_: StoreType<GameType> = store;\nconst shared: Shared<GameType, PlayerType> = new Shared();\n\nfunction sortBoard(game: GameType) {\n\tgame.board.sort((a, b) => a - b);\n}\n\nexport { store_ as store, sortBoard, shared };\n","import React from \"react\";\n\nimport { store, shared } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport css from \"../index.module.css\";\n\nclass Hand extends React.Component<{\n\tselectedIndex?: number;\n\tselectCard: (index: number) => void;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Hand</h2>\n\t\t\t\t{this.getHand()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetHand() {\n\t\tconst me = shared.getMe();\n\t\tif (!me) return null;\n\t\treturn (me.hand || []).map(this.renderCard.bind(this));\n\t}\n\n\trenderCard(termIndex: number, handIndex: number) {\n\t\tconst term = store.gameW.game!.terms[termIndex];\n\t\tconst classes = [styles.bubble];\n\t\tif (this.props.selectedIndex === handIndex)\n\t\t\tclasses.push(css.selectedCard);\n\t\treturn (\n\t\t\t<div\n\t\t\t\tkey={handIndex}\n\t\t\t\tclassName={classes.join(\" \")}\n\t\t\t\tonClick={(e: React.MouseEvent) => this.selectCard(handIndex, e)}\n\t\t\t>\n\t\t\t\t<div className={css.info}>\n\t\t\t\t\t<div className={css.card}>\n\t\t\t\t\t\t<p>{term.word}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t{term.image && (\n\t\t\t\t\t\t<img className={css.image} src={term.image} alt=\"\" />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tselectCard(selectedIndex: number, e: React.MouseEvent): void {\n\t\te.stopPropagation();\n\t\tthis.props.selectCard(selectedIndex);\n\t}\n}\n\nexport default Hand;\n","import React from \"react\";\n\nimport { store } from \"../utils/utils\";\n\nimport { GameType } from \"../utils/NewGame\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport css from \"../index.module.css\";\n\nclass Board extends React.Component<{\n\tselectTarget: (index: number) => void;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Timeline</h2>\n\t\t\t\t{this.getCardsAndTargets()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetCardsAndTargets() {\n\t\tconst cardsAndTargets: JSX.Element[] = [this.renderTarget(0)];\n\t\tconst game: GameType = store.gameW.game!;\n\t\tgame.board.forEach((termIndex: number, index: number) => {\n\t\t\tcardsAndTargets.push(this.renderCard(termIndex));\n\t\t\tcardsAndTargets.push(this.renderTarget(index + 1));\n\t\t});\n\t\treturn cardsAndTargets;\n\t}\n\n\trenderTarget(index: number) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tkey={`t${index}`}\n\t\t\t\tclassName={`${styles.bubble} ${css.target} ${\n\t\t\t\t\tstore.gameW.game.last?.wrongTarget === index\n\t\t\t\t\t\t? css.wrongTarget\n\t\t\t\t\t\t: \"\"\n\t\t\t\t}`}\n\t\t\t\tonClick={(e: React.MouseEvent) => this.selectTarget(index, e)}\n\t\t\t></div>\n\t\t);\n\t}\n\n\trenderCard(termIndex: number) {\n\t\tconst term = store.gameW.game!.terms[termIndex];\n\t\tconst classes = [styles.bubble, css.board_card];\n\t\tconst last = store.gameW.game!.last;\n\t\tif (termIndex === last?.termIndex) {\n\t\t\tclasses.push(last!.correct ? css.correct : css.incorrect);\n\t\t}\n\t\treturn (\n\t\t\t<div key={`c${termIndex}`} className={classes.join(\" \")}>\n\t\t\t\t<div className={css.info}>\n\t\t\t\t\t<div className={css.card}>\n\t\t\t\t\t\t<p>{term.word}</p>\n\t\t\t\t\t\t<p>{term.definition}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t{term.image && (\n\t\t\t\t\t\t<img className={css.image} src={term.image} alt=\"\" />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tselectTarget(index: number, e: React.MouseEvent) {\n\t\te.stopPropagation();\n\t\tthis.props.selectTarget(index);\n\t}\n}\n\nexport default Board;\n","import React from \"react\";\n\nimport { shared, store, sortBoard } from \"../utils/utils\";\nimport { GameType } from \"../utils/NewGame\";\n\nimport Hand from \"./Hand\";\nimport Board from \"./Board\";\n\nclass Main extends React.Component<{}, { selectedIndex: number }> {\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Hand\n\t\t\t\t\tselectedIndex={this.state?.selectedIndex}\n\t\t\t\t\tselectCard={this.selectCard.bind(this)}\n\t\t\t\t/>\n\t\t\t\t<Board selectTarget={this.selectTarget.bind(this)} />\n\t\t\t</div>\n\t\t);\n\t}\n\n\tselectCard(selectedIndex: number) {\n\t\tif (!shared.isMyTurn()) return;\n\t\tif (this.state?.selectedIndex === selectedIndex) selectedIndex = -1;\n\t\tthis.setState({ selectedIndex });\n\t}\n\n\tselectTarget(targetIndex: number) {\n\t\tif (!shared.isMyTurn()) return;\n\t\tif (!(this.state?.selectedIndex > -1))\n\t\t\treturn alert(\"need to select a card from hand first\");\n\t\tconst game = store.gameW.game;\n\t\tconst leftBound = game.board[targetIndex - 1];\n\t\tconst rightBound = game.board[targetIndex];\n\t\tconst me = game.players[game.currentPlayer];\n\t\tconst termIndex = me.hand![this.state.selectedIndex];\n\t\tconst correct = this.isBetween(termIndex, leftBound, rightBound);\n\t\tgame.last = { correct, termIndex };\n\t\tgame.board.push(me.hand!.splice(this.state.selectedIndex, 1)[0]);\n\t\tif (!correct) {\n\t\t\tconst deck = game.deck;\n\t\t\tif (deck) me.hand!.push(deck.pop()!);\n\t\t\tgame.last.wrongTarget =\n\t\t\t\tleftBound > termIndex ? targetIndex + 1 : targetIndex;\n\t\t} else if (me.hand!.length === 0) {\n\t\t\tstore.gameW.info.alert = `${me.userName} wins!`;\n\t\t}\n\t\tsortBoard(store.gameW.game);\n\t\tthis.setState({ selectedIndex: -1 });\n\t\tconst term = store.gameW.game.terms[termIndex];\n\t\tconst message = `played [${term.word}]: [${term.definition}] - ${\n\t\t\tcorrect ? \"CORRECT\" : \"WRONG\"\n\t\t}`;\n\t\tthis.incrementPlayerTurn();\n\t\tstore.update(message);\n\t}\n\n\tincrementPlayerTurn() {\n\t\tfor (let i = 0; i < store.gameW.game.players.length; i++) {\n\t\t\tshared.incrementPlayerTurn();\n\t\t\tif ((shared.getCurrent().hand || []).length > 0) return;\n\t\t}\n\t}\n\n\tisBetween(\n\t\ttermIndex: number,\n\t\tleftBound: number,\n\t\trightBound: number\n\t): boolean {\n\t\tif (leftBound > termIndex || rightBound < termIndex) {\n\t\t\tconst game: GameType = store.gameW.game;\n\t\t\tconst definition = game.terms[termIndex].definition;\n\t\t\treturn (\n\t\t\t\tgame.terms[leftBound]?.definition === definition ||\n\t\t\t\tgame.terms[rightBound]?.definition === definition\n\t\t\t);\n\t\t}\n\t\treturn true;\n\t}\n}\n\nexport default Main;\n","const _api_url =\n\t\"https://cors-anywhere.herokuapp.com/https://quizlet.com/webapi/3.1/\";\nconst TERMS_URL = _api_url + \"terms?filters[isDeleted]=0&filters[setId]=\";\nconst SET_URL = _api_url + \"sets/\";\nconst SEARCH_URL = SET_URL + \"search?filters[isDeleted]=0&perPage=9&query=\";\nconst FOLDER_URL =\n\t_api_url + \"folder-sets?filters[folderId]=49189251&filters[isDeleted]=0\";\n\nfunction _fetch(base: string, path: string): Promise<any> {\n\treturn fetch(base + path)\n\t\t.then((response) => response.json())\n\t\t.then((response) => response.responses[0].models);\n}\n\nexport default {\n\tfetch: _fetch,\n\tTERMS_URL,\n\tSEARCH_URL,\n\tFOLDER_URL,\n\tSET_URL,\n};\n","import { LobbyType } from \"../../../../shared/store\";\n\nimport { sortBoard, shared } from \"./utils\";\nimport Quizlet from \"./Quizlet\";\n\nexport type GameType = {\n\tparams: Params;\n\tcurrentPlayer: number;\n\ttitle: string;\n\tsetId: number;\n\tterms: TermType[];\n\tdeck?: number[];\n\tplayers: PlayerType[];\n\tboard: number[];\n\tlast?: { termIndex: number; correct: boolean; wrongTarget?: number };\n};\n\nexport type Params = {\n\tquizlet: string;\n\thandSize: number;\n\tboardStartingSize: number;\n\tswap: boolean;\n\treverse: boolean;\n\tuseRank: boolean;\n\tlobby: LobbyType;\n};\n\nexport type TermType = {\n\tword: string;\n\tdefinition: string;\n\timage: string;\n\trank: number;\n};\n\nexport type PlayerType = {\n\tindex: number;\n\tuserId: string;\n\thand?: number[];\n\tuserName: string;\n};\n\ntype DataType = { response: any; game: GameType };\n\nfunction NewGame(params: Params): PromiseLike<GameType> {\n\tconst base = parseInt(params.quizlet) ? fetchBySetId : fetchByQuery;\n\t// @ts-ignore game being constructed\n\tconst game: GameType = {};\n\tgame.params = params;\n\treturn base(params.quizlet)\n\t\t.then((response) => ({\n\t\t\tresponse,\n\t\t\tgame,\n\t\t}))\n\t\t.then(setDeck)\n\t\t.then(setPlayers)\n\t\t.then(setBoard)\n\t\t.then((data) => data.game);\n}\n\nfunction fetchBySetId(setId: string): Promise<any> {\n\tconst setPromise = Quizlet.fetch(Quizlet.SET_URL, setId).then(\n\t\t(response) => response.set[0]\n\t);\n\tconst termsPromise = Quizlet.fetch(Quizlet.TERMS_URL, setId).then(\n\t\t(response) => response.term\n\t);\n\treturn Promise.all([setPromise, termsPromise]).then(([set, terms]) => ({\n\t\tset,\n\t\tterms,\n\t}));\n}\n\nfunction fetchByQuery(queryString: string): Promise<any> {\n\treturn Quizlet.fetch(Quizlet.SEARCH_URL, queryString)\n\t\t.then((response) => response.set[0].id)\n\t\t.then(fetchBySetId);\n}\n\nfunction setDeck(data: DataType): DataType {\n\tconst terms: TermType[] = data.response.terms.map((term: any) => ({\n\t\tdefinition: term.definition || null,\n\t\tword: term.word || null,\n\t\timage: term._imageUrl || null,\n\t\trank: term.rank || 0,\n\t}));\n\tif (data.game.params.swap)\n\t\tterms.forEach((term: any) => {\n\t\t\t[term.word, term.definition] = [term.definition, term.word];\n\t\t});\n\tif (data.game.params.useRank)\n\t\tterms.forEach((term) => {\n\t\t\tterm.definition = (term.rank + 1).toString();\n\t\t});\n\tterms.sort((a, b) => a.rank - b.rank);\n\tif (data.game.params.reverse) terms.reverse();\n\n\tdata.game.title = data.response.set.title;\n\tdata.game.setId = data.response.set.id;\n\tdata.game.terms = terms;\n\tdata.game.deck = shared.shuffle(\n\t\tObject.keys(terms).map((index) => parseInt(index))\n\t);\n\treturn data;\n}\n\nfunction setPlayers(data: DataType): DataType {\n\tconst players = Object.keys(data.game.params.lobby).map(\n\t\t(userId, index: number) => ({\n\t\t\tindex,\n\t\t\tuserName: data.game.params.lobby[userId],\n\t\t\tuserId,\n\t\t\thand: data.game.deck!.splice(0, data.game.params.handSize),\n\t\t})\n\t);\n\tdata.game.players = players;\n\tdata.game.currentPlayer = shared.myIndex(data.game);\n\treturn data;\n}\n\nfunction setBoard(data: DataType): DataType {\n\tdata.game.board = data.game.deck!.splice(\n\t\t0,\n\t\tdata.game.params.boardStartingSize\n\t);\n\tif (data.game.board.length < 1)\n\t\tthrow Error(`too few terms in that set (${data.game.terms.length})`);\n\tsortBoard(data.game);\n\treturn data;\n}\n\nexport default NewGame;\n","import { LobbyType } from \"../../../../shared/store\";\n\nexport interface CardType {\n\tname: string;\n\tage: Age;\n\tcolor: Color;\n\tcost: Resource[];\n\tupgradesTo?: Upgrade;\n\tupgradesFrom?: Upgrade;\n\textra: {\n\t\tresource?: Resource[];\n\t\tresourceOptions?: Resource[];\n\t\tpoints?: number;\n\t\tmilitary?: number;\n\t\tscience?: ScienceEnum;\n\t\tdiscount?: Resource[];\n\t\tf?: () => void;\n\t\tguild?: (player: PlayerType) => number;\n\t\tgodUpgrade?: God;\n\t};\n\tmessage?: string;\n}\n\nexport enum Age {\n\tone = 1,\n\ttwo,\n\tthree,\n\tguild,\n\ttemple,\n}\n\nexport enum Resource {\n\tmoney = \"$\",\n\tclay = \"\",\n\tstone = \"\",\n\twood = \"\",\n\tpaper = \"\",\n\tglass = \"\",\n}\n\nexport enum Color {\n\tbrown,\n\tgrey,\n\tyellow,\n\tred,\n\tblue,\n\tgreen,\n\tpurple,\n}\n\nexport enum ScienceEnum {\n\twheel,\n\ta,\n\twriting,\n\tbowl,\n\tastrolabe,\n\ttablet,\n\tlaw,\n}\n\nexport enum Upgrade {\n\tlamp,\n\ttarget,\n\twater,\n\tcrescent,\n\tmask,\n\thorseshoe,\n\tvase,\n\tbarrel,\n\thelmet,\n\tsword,\n\tpillar,\n\tsun,\n\tcrown,\n\tbook,\n\tgear,\n\tcapital,\n\tharp,\n}\n\nexport enum God {\n\tegyptian,\n\tmesopotamian,\n\tgreek,\n\troman,\n\tphoenician,\n}\n\nexport enum ScienceToken {\n\tagriculture = \"$6 + 4 points\",\n\tmathematics = \"3 points / science token\",\n\turbanism = \"$6 + $4 when upgrading\",\n\tpolioretics = \"siege $1 / military\",\n\tarchitecture = \"free wonders\",\n\tlaw = \"extra science symbol\",\n\teconomy = \"opponents pay you when buying\",\n\tmasonry = \"free blue cards\",\n\tmysticism = \"2 points per god token\",\n\tengineering = \"upgrades cost $1\",\n\tphilosophy = \"7 points\",\n\ttheology = \"go again when building wonder\",\n\tstrategy = \"military moves extra\",\n}\n\nexport type GameType = {\n\tparams: Params;\n\tcurrentPlayer: number;\n\tplayers: PlayerType[];\n\tage: Age;\n\tstructure: StructureCardType[][];\n\ttrash?: number[];\n\tcommercials?: CommercialType[];\n\tsciences: { taken?: boolean; token: ScienceToken }[];\n\twentFirst: number;\n\twondersToChoose: number[];\n\tmilitary: number;\n\n\tdiscounts: number[];\n\tgodTokens: God[];\n\tgods: { [g in God]: number[] };\n\tpantheon: number[];\n\tminerva?: number;\n\tastarte?: number;\n\tenki?: ScienceToken[];\n};\n\nexport type Params = {\n\tlobby: LobbyType;\n\tgodExpansion: boolean;\n};\n\nexport type StructureCardType = {\n\tcardIndex: number;\n\toffset: number;\n\trevealed: boolean;\n\ttaken: boolean;\n};\n\nexport type PlayerType = {\n\tuserId: string;\n\tuserName: string;\n\tcards?: number[];\n\twonders: PlayerWonder[];\n\tmoney: number;\n\tmilitaryBonuses: { [x: number]: number };\n\tindex: number;\n\tscienceTokens?: ScienceToken[];\n\ttokens?: TokenType[];\n\tgods?: number[];\n\tscienceIcons?: { [x in ScienceEnum]?: number };\n};\n\nexport type PlayerWonder = { built: boolean; wonderIndex: number };\n\nexport type TokenType = {\n\tvalue: God | number;\n\tisGod: boolean;\n};\n\nexport type CommercialType = {\n\tcommercial: CommercialEnum;\n\tplayerIndex: number;\n\tlibrary?: ScienceToken[];\n};\n\nexport enum CommercialEnum {\n\tscience = \"select a science token\",\n\tchooseWonder = \"choose a wonder\",\n\tdestroyGrey = \"destroy a grey card\",\n\tdestroyBrown = \"destroy a brown card\",\n\trevive = \"construct a card from discard\",\n\tlibrary = \"choose a science token\",\n\tdestroyWonder = \"destroy one of your wonders\",\n\tpickGod = \"choose a god to add to the pantheon\",\n\tanubis = \"unbuild a wonder\",\n\tra = \"steal an unbuilt wonder\",\n\tisis = \"use a card from the trash to build a wonder\",\n\tzeus = \"destoy a card from the strucutre\",\n\tnisaba = \"copy a science card\",\n\tenki = \"select 1 / 2 science tokens\",\n\tbaal = \"steal a brown/grey card\",\n\ttheater = \"pick a god\",\n\tgate = \"pick a top god\",\n\tminerva = \"place Minerva\",\n}\n\nexport type WonderType = {\n\tname: string;\n\tcost: Resource[];\n\tmessage: string;\n\tf: () => void;\n\tgoAgain?: boolean;\n\tpoints?: number;\n\texpansion?: boolean;\n\tresourceOptions?: Resource[];\n};\n\nexport type GodType = {\n\tname: string;\n\tsource?: God;\n\tmessage: string;\n\tf: () => void;\n\tpoints?: () => number;\n};\n","import React, { RefObject } from \"react\";\n\nimport { store } from \"../utils/utils\";\nimport Quizlet from \"../utils/Quizlet\";\nimport { Params } from \"../utils/NewGame\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport css from \"../index.module.css\";\n\nconst DEFAULT_SET_ID = \"284065846\";\n\ntype SetsToTitlesType = { [setId: number]: string };\n\nclass Settings extends React.Component<{}, { setsToTitles: SetsToTitlesType }> {\n\thandSizeRef: RefObject<HTMLInputElement> = React.createRef();\n\tboardSizeRef: RefObject<HTMLInputElement> = React.createRef();\n\tswapRef: RefObject<HTMLInputElement> = React.createRef();\n\treverseRef: RefObject<HTMLInputElement> = React.createRef();\n\tuseRankRef: RefObject<HTMLInputElement> = React.createRef();\n\tquizletRef: RefObject<HTMLInputElement> = React.createRef();\n\n\tcomponentDidMount() {\n\t\tif (this.state) return;\n\t\tthis.fetchFromFolder();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<form className={css.settings_form}>\n\t\t\t\t<div>\n\t\t\t\t\t<span>Hand Size: </span>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName={css.settings_input}\n\t\t\t\t\t\ttype={\"text\"}\n\t\t\t\t\t\tdefaultValue={\"6\"}\n\t\t\t\t\t\tsize={4}\n\t\t\t\t\t\tref={this.handSizeRef}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<span>Board Size: </span>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName={css.settings_input}\n\t\t\t\t\t\ttype={\"number\"}\n\t\t\t\t\t\tdefaultValue={\"6\"}\n\t\t\t\t\t\tref={this.boardSizeRef}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<label>\n\t\t\t\t\t\tSwap: <input type={\"checkbox\"} ref={this.swapRef} />\n\t\t\t\t\t</label>\n\t\t\t\t\t<br />\n\t\t\t\t\t<label>\n\t\t\t\t\t\tReverse:{\" \"}\n\t\t\t\t\t\t<input type={\"checkbox\"} ref={this.reverseRef} />\n\t\t\t\t\t</label>\n\t\t\t\t\t<br />\n\t\t\t\t\t<label>\n\t\t\t\t\t\tUse Rank:{\" \"}\n\t\t\t\t\t\t<input type={\"checkbox\"} ref={this.useRankRef} />\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.dont_grow}>\n\t\t\t\t\t<select\n\t\t\t\t\t\tclassName={css.settings_select}\n\t\t\t\t\t\tonChange={this.selectChange.bind(this)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<option defaultChecked>Select Set</option>\n\t\t\t\t\t\t{this.state && this.getSets()}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<span onClick={this.refresh.bind(this)}>Quizlet: </span>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype={\"text\"}\n\t\t\t\t\t\tsize={DEFAULT_SET_ID.length + 2}\n\t\t\t\t\t\tref={this.quizletRef}\n\t\t\t\t\t\tdefaultValue={DEFAULT_SET_ID}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t);\n\t}\n\n\trefresh() {\n\t\tlocalStorage.fetchedFromFolderVersion = null;\n\t\tthis.fetchFromFolder().then(() => alert(\"refreshed\"));\n\t}\n\n\tgetSets(): JSX.Element[] {\n\t\tconst sets: JSX.Element[] = [];\n\t\tfor (let [setId, title] of Object.entries(this.state.setsToTitles)) {\n\t\t\tsets.push(\n\t\t\t\t<option key={setId} value={setId}>\n\t\t\t\t\t{title}\n\t\t\t\t</option>\n\t\t\t);\n\t\t}\n\t\treturn sets;\n\t}\n\n\tselectChange(e: React.ChangeEvent<HTMLSelectElement>): void {\n\t\te.preventDefault();\n\t\tconst index = e.target.selectedIndex;\n\t\tif (index === 0) return;\n\t\tconst option = e.target.options[index];\n\t\tthis.quizletRef.current!.value = option.value;\n\t}\n\n\tfetchFromFolder(): Promise<void> {\n\t\treturn this.fetchFromFolderHelper().then((setsToTitles) =>\n\t\t\tthis.setState({ setsToTitles })\n\t\t);\n\t}\n\n\tfetchFromFolderHelper(): Promise<SetsToTitlesType> {\n\t\tif (\n\t\t\tlocalStorage.fetchedFromFolderVersion === store.me.VERSION &&\n\t\t\tlocalStorage.fetchedFromFolder\n\t\t)\n\t\t\treturn Promise.resolve(localStorage.fetchedFromFolder).then(\n\t\t\t\tJSON.parse\n\t\t\t);\n\t\treturn Quizlet.fetch(Quizlet.FOLDER_URL, \"\")\n\t\t\t.then(this.seedFromFolder.bind(this))\n\t\t\t.then((fetchedFromFolder) => {\n\t\t\t\tlocalStorage.fetchedFromFolder = JSON.stringify(\n\t\t\t\t\tfetchedFromFolder\n\t\t\t\t);\n\t\t\t\tlocalStorage.fetchedFromFolderVersion = store.me.VERSION;\n\t\t\t\treturn fetchedFromFolder;\n\t\t\t});\n\t}\n\n\tseedFromFolder(blob: any): Promise<SetsToTitlesType> {\n\t\tconst promises = blob.folderSet.map((model: { setId: number }) =>\n\t\t\tQuizlet.fetch(Quizlet.SET_URL, model.setId.toString())\n\t\t);\n\t\treturn Promise.all(promises)\n\t\t\t.then((responses: any[]) =>\n\t\t\t\tresponses.map((response: any) => {\n\t\t\t\t\tconst set = response.set[0];\n\t\t\t\t\treturn { id: set.id, title: set.title };\n\t\t\t\t})\n\t\t\t)\n\t\t\t.then((responses: any[]) => {\n\t\t\t\tconst setsToTitles: SetsToTitlesType = {};\n\t\t\t\tresponses.forEach(\n\t\t\t\t\t(response: { id: number; title: string }) =>\n\t\t\t\t\t\t(setsToTitles[response.id] = response.title)\n\t\t\t\t);\n\t\t\t\treturn setsToTitles;\n\t\t\t});\n\t}\n\n\tgetParams(): Params {\n\t\treturn {\n\t\t\tlobby: store.lobby,\n\t\t\tquizlet: this.quizletRef.current!.value,\n\t\t\thandSize: parseInt(this.handSizeRef.current!.value),\n\t\t\tboardStartingSize: parseInt(this.boardSizeRef.current!.value),\n\t\t\tswap: this.swapRef.current!.checked,\n\t\t\treverse: this.reverseRef.current!.checked,\n\t\t\tuseRank: this.useRankRef.current!.checked,\n\t\t};\n\t}\n\n\t// todo accept params as arg and assert isNewGame in callsite\n\tmaybeSyncParams() {\n\t\tif (store.gameW.info.isNewGame) {\n\t\t\tconst params = store.gameW.game.params;\n\t\t\tthis.quizletRef.current!.value = params.quizlet;\n\t\t\t// todo set quizlet dropdown too\n\t\t\tthis.handSizeRef.current!.value = params.handSize.toString();\n\t\t\tthis.boardSizeRef.current!.value = params.boardStartingSize.toString();\n\t\t\tthis.swapRef.current!.checked = params.swap;\n\t\t\tthis.reverseRef.current!.checked = params.reverse;\n\t\t\tthis.useRankRef.current!.checked = params.useRank;\n\t\t}\n\t}\n}\n\nexport default Settings;\n","import React, { RefObject } from \"react\";\n\nimport SharedSidebar from \"../../../../shared/components/sidebar/SharedSidebar\";\nimport NewGame, { Params, GameType } from \"../utils/NewGame\";\nimport { store, shared as utils } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport css from \"../index.module.css\";\nimport Settings from \"./Settings\";\n\nclass Sidebar extends SharedSidebar<Params> {\n\tsettingsRef: RefObject<Settings> = React.createRef();\n\tname = \"Timeline\";\n\tNewGame = NewGame;\n\tisMyTurn = utils.isMyTurn.bind(utils);\n\n\trenderStartNewGame() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Settings ref={this.settingsRef} />\n\t\t\t\t<button onClick={this.startNewGame.bind(this)}>New Game</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetParams() {\n\t\treturn this.settingsRef.current!.getParams();\n\t}\n\n\tmaybeSyncParams() {\n\t\tsuper.maybeSyncParams();\n\t\tthis.settingsRef.current?.maybeSyncParams();\n\t}\n\n\trenderInfo() {\n\t\tconst game: GameType = store.gameW.game;\n\t\tif (!game) return null;\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<div className={css.info}>\n\t\t\t\t\t<p>{game.title}</p>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tSet Id: <span>{game.setId}</span>\n\t\t\t\t\t</p>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tCurrent Player:{\" \"}\n\t\t\t\t\t\t<span>{game.players[game.currentPlayer].userName}</span>\n\t\t\t\t\t</p>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{game.players.map((player) => (\n\t\t\t\t\t\t\t<p key={player.index}>\n\t\t\t\t\t\t\t\t{player.userName} ({(player.hand || []).length})\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Sidebar;\n","import React from \"react\";\n\nimport { shared, store } from \"./utils/utils\";\nimport Main from \"./main/Main\";\nimport Sidebar from \"./sidebar/Sidebar\";\n\nimport styles from \"../../../shared/styles.module.css\";\n\nclass Timeline extends React.Component {\n\trender() {\n\t\t// todo css help\n\t\t// sidebar and main should scroll on separate tracks\n\t\treturn (\n\t\t\t<div className={`${shared.isMyTurn() && styles.my_turn}`}>\n\t\t\t\t<div className={styles.main}>\n\t\t\t\t\t<Sidebar />\n\t\t\t\t\t<div className={styles.content}>\n\t\t\t\t\t\t<div>{store.gameW.game && <Main />}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Timeline;\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\nimport { ScienceToken, CommercialEnum } from \"../utils/types\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nexport const NUM_SCIENCES = 5;\n\nclass Science extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Sciences</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{store.gameW.game.sciences\n\t\t\t\t\t\t.slice(0, NUM_SCIENCES)\n\t\t\t\t\t\t.filter((obj) => !obj.taken)\n\t\t\t\t\t\t.map((obj) => obj.token)\n\t\t\t\t\t\t.map(this.renderScience.bind(this))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderScience(scienceToken: ScienceToken) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tkey={scienceToken}\n\t\t\t\tclassName={styles.bubble}\n\t\t\t\ttitle={scienceToken}\n\t\t\t\tonClick={() => this.select(scienceToken)}\n\t\t\t>\n\t\t\t\t{utils.enumName(scienceToken, ScienceToken)}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tselect(token: ScienceToken) {\n\t\tif (!utils.isMyCommercial(CommercialEnum.science)) return;\n\t\tutils.buildScienceToken(token);\n\t}\n}\n\nexport default Science;\n","import React from \"react\";\nimport Hotkeys from \"react-hot-keys\";\n\nimport utils, { store } from \"../utils/utils\";\n\nimport Structure from \"./structure/Structure\";\nimport Player from \"./player/Player\";\nimport Military from \"./Military\";\nimport Trash from \"./Trash\";\nimport Commercial from \"./commercial/Commercial\";\nimport Science from \"./Science\";\nimport Pantheon from \"./Pantheon\";\nimport { Age } from \"../utils/types\";\n\nexport enum SelectedEnum {\n\ttrash = -2,\n\tbuild = -1,\n\t// wonder = 0+\n}\n\nclass Main extends React.Component<\n\t{},\n\t{\n\t\tselectedTarget?: SelectedEnum;\n\t\tselectedPantheon?: number;\n\t\tusedTokens?: { [tokenIndex: number]: boolean };\n\t}\n> {\n\tconstructor(props: {}) {\n\t\tsuper(props);\n\t\tthis.state = {};\n\t}\n\n\tonKeyDown(keyName: string) {\n\t\tswitch (keyName) {\n\t\t\tcase \"t\":\n\t\t\t\tthis.select(SelectedEnum.trash);\n\t\t\t\tbreak;\n\t\t\tcase \"b\":\n\t\t\t\tthis.select(SelectedEnum.build);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconst wonderIndex = parseInt(keyName) - 1;\n\t\t\t\tif (wonderIndex >= (utils.getMe()?.wonders || []).length)\n\t\t\t\t\treturn;\n\t\t\t\tthis.select(wonderIndex);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Hotkeys\n\t\t\t\t\tkeyName=\"t,b,1,2,3,4,5,6,7\"\n\t\t\t\t\tonKeyDown={this.onKeyDown.bind(this)}\n\t\t\t\t></Hotkeys>\n\t\t\t\t{store.gameW.game.commercials && (\n\t\t\t\t\t<Commercial\n\t\t\t\t\t\tselectedPantheon={this.state.selectedPantheon}\n\t\t\t\t\t\treset={this.reset.bind(this)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{store.gameW.game.params.godExpansion && (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Pantheon\n\t\t\t\t\t\t\tselectPantheon={this.selectPantheon.bind(this)}\n\t\t\t\t\t\t\tselectedPantheon={this.state.selectedPantheon}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<div>\n\t\t\t\t\t<Structure\n\t\t\t\t\t\tselectCard={this.selectCard.bind(this)}\n\t\t\t\t\t\t{...this.props}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{this.renderPlayers()}\n\t\t\t\t<div>\n\t\t\t\t\t<Military players={this.getPlayers()} />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<Science />\n\t\t\t\t</div>\n\t\t\t\t<Trash\n\t\t\t\t\tselect={this.selectTrash.bind(this)}\n\t\t\t\t\tselected={this.state.selectedTarget === SelectedEnum.trash}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treset() {\n\t\tthis.setState({\n\t\t\tselectedTarget: undefined,\n\t\t\tselectedPantheon: undefined,\n\t\t\tusedTokens: undefined,\n\t\t});\n\t}\n\n\tgetPlayers() {\n\t\treturn utils.myIndex() >= 0\n\t\t\t? [utils.getMe(), utils.getOpponent()]\n\t\t\t: store.gameW.game.players;\n\t}\n\n\trenderPlayers() {\n\t\tconst players = this.getPlayers();\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Player\n\t\t\t\t\tplayer={players[0]}\n\t\t\t\t\tselected={this.state.selectedTarget}\n\t\t\t\t\tusedTokens={this.state.usedTokens}\n\t\t\t\t\tselectWonder={this.select.bind(this)}\n\t\t\t\t\tdiscount={this.discountToken.bind(this)}\n\t\t\t\t/>\n\t\t\t\t<Player\n\t\t\t\t\tplayer={players[1]}\n\t\t\t\t\tselectWonder={() => null}\n\t\t\t\t\tdiscount={() => null}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tselectPantheon(selectedPantheon: number) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst godIndex = store.gameW.game.pantheon[selectedPantheon];\n\t\tif (store.gameW.game.age === Age.one) {\n\t\t\tif (godIndex !== -1) return;\n\t\t\tif (this.state.selectedPantheon === selectedPantheon)\n\t\t\t\tselectedPantheon = -1;\n\t\t\tthis.setState({ selectedPantheon });\n\t\t} else {\n\t\t\tutils.buyGod(selectedPantheon, this.state.usedTokens);\n\t\t\tthis.reset();\n\t\t}\n\t}\n\n\tdiscountToken(tokenIndex: number) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst usedTokens = this.state.usedTokens || {};\n\t\tif (usedTokens[tokenIndex]) {\n\t\t\tdelete usedTokens[tokenIndex];\n\t\t} else {\n\t\t\tusedTokens[tokenIndex] = true;\n\t\t}\n\t\tthis.setState({ usedTokens });\n\t}\n\n\tselect(selectedTarget: SelectedEnum) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tif (this.state.selectedTarget === selectedTarget) return this.reset();\n\t\tthis.setState({ selectedTarget });\n\t}\n\n\tselectTrash() {\n\t\tthis.select(SelectedEnum.trash);\n\t}\n\n\tselectCard(x: number, y: number) {\n\t\tconst message = utils.selectCard(x, y, this.state.selectedTarget);\n\t\tif (!message) return;\n\t\tthis.reset();\n\t\tstore.update(message);\n\t}\n}\n\nexport default Main;\n","import { NUM_SCIENCES } from \"../main/Science\";\n\nimport utils, { store } from \"./utils\";\nimport {\n\tCardType,\n\tAge,\n\tColor,\n\tResource,\n\tUpgrade,\n\tScienceEnum,\n\tPlayerType,\n\tGod,\n\tGodType,\n\tCommercialEnum,\n\tWonderType,\n} from \"./types\";\n\nconst cards: CardType[] = [\n\t{\n\t\tname: \"lumber yard\",\n\t\tage: Age.one,\n\t\tcolor: Color.brown,\n\t\tcost: [],\n\t\textra: { resource: [Resource.wood] },\n\t},\n\t{\n\t\tname: \"clay pool\",\n\t\tage: Age.one,\n\t\tcolor: Color.brown,\n\t\tcost: [],\n\t\textra: { resource: [Resource.clay] },\n\t},\n\t{\n\t\tname: \"quarry\",\n\t\tage: Age.one,\n\t\tcolor: Color.brown,\n\t\tcost: [],\n\t\textra: { resource: [Resource.stone] },\n\t},\n\t{\n\t\tname: \"logging camp\",\n\t\tage: Age.one,\n\t\tcolor: Color.brown,\n\t\tcost: [Resource.money],\n\t\textra: { resource: [Resource.wood] },\n\t},\n\t{\n\t\tname: \"stone pit\",\n\t\tage: Age.one,\n\t\tcolor: Color.brown,\n\t\tcost: [Resource.money],\n\t\textra: { resource: [Resource.stone] },\n\t},\n\t{\n\t\tname: \"clay pit\",\n\t\tage: Age.one,\n\t\tcolor: Color.brown,\n\t\tcost: [Resource.money],\n\t\textra: { resource: [Resource.clay] },\n\t},\n\t{\n\t\tname: \"press\",\n\t\tage: Age.one,\n\t\tcolor: Color.grey,\n\t\tcost: [Resource.money],\n\t\textra: { resource: [Resource.paper] },\n\t},\n\t{\n\t\tname: \"glassworks\",\n\t\tage: Age.one,\n\t\tcolor: Color.grey,\n\t\tcost: [Resource.money],\n\t\textra: { resource: [Resource.glass] },\n\t},\n\t{\n\t\tname: \"baths\",\n\t\tage: Age.one,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.stone],\n\t\tupgradesTo: Upgrade.water,\n\t\textra: { points: 3 },\n\t},\n\t{\n\t\tname: \"altar\",\n\t\tage: Age.one,\n\t\tcolor: Color.blue,\n\t\tcost: [],\n\t\tupgradesTo: Upgrade.crescent,\n\t\textra: { points: 3 },\n\t},\n\t{\n\t\tname: \"theater\",\n\t\tage: Age.one,\n\t\tcolor: Color.blue,\n\t\tcost: [],\n\t\tupgradesTo: Upgrade.mask,\n\t\textra: { points: 3 },\n\t},\n\t{\n\t\tname: \"guard tower\",\n\t\tage: Age.one,\n\t\tcolor: Color.red,\n\t\tcost: [],\n\t\textra: { military: 1 },\n\t},\n\t{\n\t\tname: \"garrison\",\n\t\tage: Age.one,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.clay],\n\t\tupgradesTo: Upgrade.sword,\n\t\textra: { military: 1 },\n\t},\n\t{\n\t\tname: \"palisade\",\n\t\tage: Age.one,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.money, Resource.money],\n\t\tupgradesTo: Upgrade.crown,\n\t\textra: { military: 1 },\n\t},\n\t{\n\t\tname: \"stable\",\n\t\tage: Age.one,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.wood],\n\t\tupgradesTo: Upgrade.horseshoe,\n\t\textra: { military: 1 },\n\t},\n\t{\n\t\tname: \"stone reserve\",\n\t\tage: Age.one,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.money, Resource.money, Resource.money],\n\t\textra: { discount: [Resource.stone] },\n\t},\n\t{\n\t\tname: \"wood reserve\",\n\t\tage: Age.one,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.money, Resource.money, Resource.money],\n\t\textra: { discount: [Resource.wood] },\n\t},\n\t{\n\t\tname: \"clay reserve\",\n\t\tage: Age.one,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.money, Resource.money, Resource.money],\n\t\textra: { discount: [Resource.clay] },\n\t},\n\t{\n\t\tname: \"tavern\",\n\t\tage: Age.one,\n\t\tcolor: Color.yellow,\n\t\tcost: [],\n\t\textra: { f: () => (utils.getMe().money += 4) },\n\t\tmessage: \"$4\",\n\t\tupgradesTo: Upgrade.vase,\n\t},\n\t{\n\t\tname: \"apothecary\",\n\t\tage: Age.one,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.glass],\n\t\textra: { points: 1, science: ScienceEnum.wheel },\n\t},\n\t{\n\t\tname: \"workshop\",\n\t\tage: Age.one,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.paper],\n\t\textra: { points: 1, science: ScienceEnum.a },\n\t},\n\t{\n\t\tname: \"scriptorium\",\n\t\tage: Age.one,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.money, Resource.money],\n\t\textra: { science: ScienceEnum.writing },\n\t\tupgradesTo: Upgrade.book,\n\t},\n\t{\n\t\tname: \"pharmacist\",\n\t\tage: Age.one,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.money, Resource.money],\n\t\textra: { science: ScienceEnum.bowl },\n\t\tupgradesTo: Upgrade.gear,\n\t},\n\t{\n\t\tname: \"sawmill\",\n\t\tage: Age.two,\n\t\tcolor: Color.brown,\n\t\tcost: [Resource.money, Resource.money],\n\t\textra: { resource: [Resource.wood, Resource.wood] },\n\t},\n\t{\n\t\tname: \"brickyard\",\n\t\tage: Age.two,\n\t\tcolor: Color.brown,\n\t\tcost: [Resource.money, Resource.money],\n\t\textra: { resource: [Resource.clay, Resource.clay] },\n\t},\n\t{\n\t\tname: \"shelf quarry\",\n\t\tage: Age.two,\n\t\tcolor: Color.brown,\n\t\tcost: [Resource.money, Resource.money],\n\t\textra: { resource: [Resource.stone, Resource.stone] },\n\t},\n\t{\n\t\tname: \"drying room\",\n\t\tage: Age.two,\n\t\tcolor: Color.grey,\n\t\tcost: [],\n\t\textra: { resource: [Resource.paper] },\n\t},\n\t{\n\t\tname: \"glassblower\",\n\t\tage: Age.two,\n\t\tcolor: Color.grey,\n\t\tcost: [],\n\t\textra: { resource: [Resource.glass] },\n\t},\n\t{\n\t\tname: \"courthouse\",\n\t\tage: Age.two,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.wood, Resource.wood, Resource.glass],\n\t\textra: { points: 5 },\n\t},\n\t{\n\t\tname: \"aqueduct\",\n\t\tage: Age.two,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.stone, Resource.stone, Resource.stone],\n\t\tupgradesFrom: Upgrade.water,\n\t\textra: { points: 5 },\n\t},\n\t{\n\t\tname: \"statue\",\n\t\tage: Age.two,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.clay, Resource.clay],\n\t\tupgradesFrom: Upgrade.mask,\n\t\tupgradesTo: Upgrade.pillar,\n\t\textra: { points: 4 },\n\t},\n\t{\n\t\tname: \"temple\",\n\t\tage: Age.two,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.wood, Resource.paper],\n\t\tupgradesFrom: Upgrade.crescent,\n\t\tupgradesTo: Upgrade.sun,\n\t\textra: { points: 4 },\n\t},\n\t{\n\t\tname: \"rostrum\",\n\t\tage: Age.two,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.stone, Resource.wood],\n\t\tupgradesTo: Upgrade.capital,\n\t\textra: { points: 4 },\n\t},\n\t{\n\t\tname: \"archery range\",\n\t\tage: Age.two,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.stone, Resource.wood, Resource.paper],\n\t\tupgradesTo: Upgrade.target,\n\t\textra: { military: 2 },\n\t},\n\t{\n\t\tname: \"barracks\",\n\t\tage: Age.two,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.money, Resource.money, Resource.money],\n\t\tupgradesFrom: Upgrade.sword,\n\t\textra: { military: 1 },\n\t},\n\t{\n\t\tname: \"walls\",\n\t\tage: Age.two,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.stone, Resource.stone],\n\t\textra: { military: 2 },\n\t},\n\t{\n\t\tname: \"horse breeders\",\n\t\tage: Age.two,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.wood, Resource.clay],\n\t\tupgradesTo: Upgrade.horseshoe,\n\t\textra: { military: 1 },\n\t},\n\t{\n\t\tname: \"parade ground\",\n\t\tage: Age.two,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.clay, Resource.clay, Resource.glass],\n\t\tupgradesTo: Upgrade.helmet,\n\t\textra: { military: 2 },\n\t},\n\t{\n\t\tname: \"forum\",\n\t\tage: Age.two,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.money, Resource.money, Resource.money, Resource.clay],\n\t\textra: { resourceOptions: [Resource.glass, Resource.paper] },\n\t},\n\t{\n\t\tname: \"caravansery\",\n\t\tage: Age.two,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.money, Resource.money, Resource.paper, Resource.glass],\n\t\textra: {\n\t\t\tresourceOptions: [Resource.wood, Resource.clay, Resource.stone],\n\t\t},\n\t},\n\t{\n\t\tname: \"customs house\",\n\t\tage: Age.two,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.money, Resource.money, Resource.money, Resource.money],\n\t\textra: { discount: [Resource.glass, Resource.paper] },\n\t},\n\t{\n\t\tname: \"brewery\",\n\t\tage: Age.two,\n\t\tcolor: Color.yellow,\n\t\tcost: [],\n\t\textra: { f: () => (utils.getMe().money += 6) },\n\t\tmessage: \"$6\",\n\t\tupgradesTo: Upgrade.barrel,\n\t},\n\t{\n\t\tname: \"school\",\n\t\tage: Age.two,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.paper, Resource.paper, Resource.wood],\n\t\textra: { points: 1, science: ScienceEnum.wheel },\n\t\tupgradesTo: Upgrade.harp,\n\t},\n\t{\n\t\tname: \"laboratory\",\n\t\tage: Age.two,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.wood, Resource.glass, Resource.glass],\n\t\textra: { points: 1, science: ScienceEnum.a },\n\t\tupgradesTo: Upgrade.lamp,\n\t},\n\t{\n\t\tname: \"library\",\n\t\tage: Age.two,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.stone, Resource.wood, Resource.glass],\n\t\textra: { points: 2, science: ScienceEnum.writing },\n\t\tupgradesFrom: Upgrade.book,\n\t},\n\t{\n\t\tname: \"dispensary\",\n\t\tage: Age.two,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.clay, Resource.clay, Resource.stone],\n\t\textra: { points: 2, science: ScienceEnum.bowl },\n\t\tupgradesFrom: Upgrade.gear,\n\t},\n\t{\n\t\tname: \"pantheon\",\n\t\tage: Age.three,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.clay, Resource.wood, Resource.paper, Resource.paper],\n\t\textra: { points: 6 },\n\t\tupgradesFrom: Upgrade.sun,\n\t},\n\t{\n\t\tname: \"obelisk\",\n\t\tage: Age.three,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.stone, Resource.stone, Resource.glass],\n\t\textra: { points: 5 },\n\t},\n\t{\n\t\tname: \"senate\",\n\t\tage: Age.three,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.clay, Resource.clay, Resource.stone, Resource.paper],\n\t\textra: { points: 5 },\n\t\tupgradesFrom: Upgrade.capital,\n\t},\n\t{\n\t\tname: \"gardens\",\n\t\tage: Age.three,\n\t\tcolor: Color.blue,\n\t\tcost: [Resource.clay, Resource.clay, Resource.wood, Resource.wood],\n\t\textra: { points: 6 },\n\t\tupgradesFrom: Upgrade.pillar,\n\t},\n\t{\n\t\tname: \"palace\",\n\t\tage: Age.three,\n\t\tcolor: Color.blue,\n\t\tcost: [\n\t\t\tResource.clay,\n\t\t\tResource.wood,\n\t\t\tResource.stone,\n\t\t\tResource.glass,\n\t\t\tResource.glass,\n\t\t],\n\t\textra: { points: 7 },\n\t},\n\t{\n\t\tname: \"town hall\",\n\t\tage: Age.three,\n\t\tcolor: Color.blue,\n\t\tcost: [\n\t\t\tResource.stone,\n\t\t\tResource.stone,\n\t\t\tResource.stone,\n\t\t\tResource.wood,\n\t\t\tResource.wood,\n\t\t],\n\t\textra: { points: 7 },\n\t},\n\t{\n\t\tname: \"fortifications\",\n\t\tage: Age.three,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.stone, Resource.stone, Resource.clay, Resource.paper],\n\t\textra: { military: 2 },\n\t\tupgradesFrom: Upgrade.crown,\n\t},\n\t{\n\t\tname: \"pretorium\",\n\t\tage: Age.three,\n\t\tcolor: Color.red,\n\t\tcost: [\n\t\t\tResource.money,\n\t\t\tResource.money,\n\t\t\tResource.money,\n\t\t\tResource.money,\n\t\t\tResource.money,\n\t\t\tResource.money,\n\t\t\tResource.money,\n\t\t\tResource.money,\n\t\t],\n\t\textra: { military: 3 },\n\t},\n\t{\n\t\tname: \"arsenal\",\n\t\tage: Age.three,\n\t\tcolor: Color.red,\n\t\tcost: [\n\t\t\tResource.clay,\n\t\t\tResource.clay,\n\t\t\tResource.clay,\n\t\t\tResource.wood,\n\t\t\tResource.wood,\n\t\t],\n\t\textra: { military: 3 },\n\t},\n\t{\n\t\tname: \"siege workshop\",\n\t\tage: Age.three,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.wood, Resource.wood, Resource.wood, Resource.glass],\n\t\textra: { military: 2 },\n\t\tupgradesFrom: Upgrade.target,\n\t},\n\t{\n\t\tname: \"circus\",\n\t\tage: Age.three,\n\t\tcolor: Color.red,\n\t\tcost: [Resource.clay, Resource.clay, Resource.stone, Resource.stone],\n\t\textra: { military: 2 },\n\t\tupgradesFrom: Upgrade.helmet,\n\t},\n\t{\n\t\tname: \"lighthouse\",\n\t\tage: Age.three,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.clay, Resource.clay, Resource.glass],\n\t\textra: {\n\t\t\tpoints: 3,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money += (utils.getMe().cards || []).filter(\n\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.yellow\n\t\t\t\t).length),\n\t\t},\n\t\tmessage: \"$1 / yellow\",\n\t\tupgradesFrom: Upgrade.vase,\n\t},\n\t{\n\t\tname: \"arena\",\n\t\tage: Age.three,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.clay, Resource.stone, Resource.wood],\n\t\textra: {\n\t\t\tpoints: 3,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money +=\n\t\t\t\t\t2 *\n\t\t\t\t\tutils.getMe().wonders.filter((wonder) => wonder.built)\n\t\t\t\t\t\t.length),\n\t\t},\n\t\tmessage: \"$2 / wonder\",\n\t\tupgradesFrom: Upgrade.barrel,\n\t},\n\t{\n\t\tname: \"port\",\n\t\tage: Age.three,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.wood, Resource.glass, Resource.paper],\n\t\textra: {\n\t\t\tpoints: 3,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money +=\n\t\t\t\t\t2 *\n\t\t\t\t\t(utils.getMe().cards || []).filter(\n\t\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.brown\n\t\t\t\t\t).length),\n\t\t},\n\t\tmessage: \"$2 / brown\",\n\t},\n\t{\n\t\tname: \"armory\",\n\t\tage: Age.three,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.stone, Resource.stone, Resource.glass],\n\t\textra: {\n\t\t\tpoints: 3,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money += (utils.getMe().cards || []).filter(\n\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.red\n\t\t\t\t).length),\n\t\t},\n\t\tmessage: \"$1 / red\",\n\t},\n\t{\n\t\tname: \"chamber of commerce\",\n\t\tage: Age.three,\n\t\tcolor: Color.yellow,\n\t\tcost: [Resource.paper, Resource.paper],\n\t\textra: {\n\t\t\tpoints: 3,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money +=\n\t\t\t\t\t3 *\n\t\t\t\t\t(utils.getMe().cards || []).filter(\n\t\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.grey\n\t\t\t\t\t).length),\n\t\t},\n\t\tmessage: \"$3 / grey\",\n\t},\n\t{\n\t\tname: \"observatory\",\n\t\tage: Age.three,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.stone, Resource.paper, Resource.paper],\n\t\textra: { points: 2, science: ScienceEnum.astrolabe },\n\t\tupgradesFrom: Upgrade.lamp,\n\t},\n\t{\n\t\tname: \"university\",\n\t\tage: Age.three,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.clay, Resource.glass, Resource.paper],\n\t\textra: { points: 2, science: ScienceEnum.astrolabe },\n\t\tupgradesFrom: Upgrade.harp,\n\t},\n\t{\n\t\tname: \"study\",\n\t\tage: Age.three,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.wood, Resource.wood, Resource.glass, Resource.paper],\n\t\textra: { points: 3, science: ScienceEnum.tablet },\n\t},\n\t{\n\t\tname: \"academy\",\n\t\tage: Age.three,\n\t\tcolor: Color.green,\n\t\tcost: [Resource.stone, Resource.wood, Resource.glass, Resource.glass],\n\t\textra: { points: 3, science: ScienceEnum.tablet },\n\t},\n\t{\n\t\tname: \"moneylenders guild\",\n\t\tage: Age.guild,\n\t\tcolor: Color.purple,\n\t\tcost: [Resource.stone, Resource.stone, Resource.wood, Resource.wood],\n\t\textra: {\n\t\t\tguild: (player: PlayerType) => Math.floor(player.money / 3),\n\t\t},\n\t\tmessage: \"1 point / $3\",\n\t},\n\t{\n\t\tname: \"merchants guild\",\n\t\tage: Age.guild,\n\t\tcolor: Color.purple,\n\t\tcost: [Resource.clay, Resource.wood, Resource.glass, Resource.paper],\n\t\textra: {\n\t\t\tguild: (player: PlayerType) =>\n\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.yellow\n\t\t\t\t).length,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money += Math.max(\n\t\t\t\t\tstore.gameW.game.players.map(\n\t\t\t\t\t\t(player) =>\n\t\t\t\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t\t\t\t(cardIndex) =>\n\t\t\t\t\t\t\t\t\tcards[cardIndex].color === Color.yellow\n\t\t\t\t\t\t\t).length\n\t\t\t\t\t).length\n\t\t\t\t)),\n\t\t},\n\t\tmessage: \"$1, 1 point / yellow (both)\",\n\t},\n\t{\n\t\tname: \"shipowners guild\",\n\t\tage: Age.guild,\n\t\tcolor: Color.purple,\n\t\tcost: [Resource.clay, Resource.stone, Resource.glass, Resource.paper],\n\t\textra: {\n\t\t\tguild: (player: PlayerType) =>\n\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t(cardIndex) =>\n\t\t\t\t\t\tcards[cardIndex].color === Color.brown ||\n\t\t\t\t\t\tcards[cardIndex].color === Color.grey\n\t\t\t\t).length,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money += Math.max(\n\t\t\t\t\tstore.gameW.game.players.map(\n\t\t\t\t\t\t(player) =>\n\t\t\t\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t\t\t\t(cardIndex) =>\n\t\t\t\t\t\t\t\t\tcards[cardIndex].color === Color.brown ||\n\t\t\t\t\t\t\t\t\tcards[cardIndex].color === Color.grey\n\t\t\t\t\t\t\t).length\n\t\t\t\t\t).length\n\t\t\t\t)),\n\t\t},\n\t\tmessage: \"$1, 1 point / brown/grey (both)\",\n\t},\n\t{\n\t\tname: \"tacticians guild\",\n\t\tage: Age.guild,\n\t\tcolor: Color.purple,\n\t\tcost: [Resource.stone, Resource.stone, Resource.clay, Resource.paper],\n\t\textra: {\n\t\t\tguild: (player: PlayerType) =>\n\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.red\n\t\t\t\t).length,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money += Math.max(\n\t\t\t\t\tstore.gameW.game.players.map(\n\t\t\t\t\t\t(player) =>\n\t\t\t\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t\t\t\t(cardIndex) =>\n\t\t\t\t\t\t\t\t\tcards[cardIndex].color === Color.red\n\t\t\t\t\t\t\t).length\n\t\t\t\t\t).length\n\t\t\t\t)),\n\t\t},\n\t\tmessage: \"$1, 1 point / red (both)\",\n\t},\n\t{\n\t\tname: \"scientists guild\",\n\t\tage: Age.guild,\n\t\tcolor: Color.purple,\n\t\tcost: [Resource.clay, Resource.clay, Resource.wood, Resource.wood],\n\t\textra: {\n\t\t\tguild: (player: PlayerType) =>\n\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.green\n\t\t\t\t).length,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money += Math.max(\n\t\t\t\t\tstore.gameW.game.players.map(\n\t\t\t\t\t\t(player) =>\n\t\t\t\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t\t\t\t(cardIndex) =>\n\t\t\t\t\t\t\t\t\tcards[cardIndex].color === Color.green\n\t\t\t\t\t\t\t).length\n\t\t\t\t\t).length\n\t\t\t\t)),\n\t\t},\n\t\tmessage: \"$1, 1 point / green (both)\",\n\t},\n\t{\n\t\tname: \"magistrates guild\",\n\t\tage: Age.guild,\n\t\tcolor: Color.purple,\n\t\tcost: [Resource.wood, Resource.wood, Resource.clay, Resource.paper],\n\t\textra: {\n\t\t\tguild: (player: PlayerType) =>\n\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t(cardIndex) => cards[cardIndex].color === Color.blue\n\t\t\t\t).length,\n\t\t\tf: () =>\n\t\t\t\t(utils.getMe().money += Math.max(\n\t\t\t\t\tstore.gameW.game.players.map(\n\t\t\t\t\t\t(player) =>\n\t\t\t\t\t\t\t(player.cards || []).filter(\n\t\t\t\t\t\t\t\t(cardIndex) =>\n\t\t\t\t\t\t\t\t\tcards[cardIndex].color === Color.blue\n\t\t\t\t\t\t\t).length\n\t\t\t\t\t).length\n\t\t\t\t)),\n\t\t},\n\t\tmessage: \"$1, 1 point / blue (both)\",\n\t},\n\t{\n\t\tname: \"builders guild\",\n\t\tage: Age.guild,\n\t\tcolor: Color.purple,\n\t\tcost: [\n\t\t\tResource.stone,\n\t\t\tResource.stone,\n\t\t\tResource.clay,\n\t\t\tResource.wood,\n\t\t\tResource.glass,\n\t\t],\n\t\textra: {\n\t\t\tguild: (player: PlayerType) =>\n\t\t\t\t2 * player.wonders.filter((wonder) => wonder.built).length,\n\t\t},\n\t\tmessage: \"2 points / wonder (both)\",\n\t},\n\t{\n\t\tname: \"egyptian grand temple\",\n\t\tage: Age.temple,\n\t\tcolor: Color.purple,\n\t\tcost: [\n\t\t\tResource.clay,\n\t\t\tResource.clay,\n\t\t\tResource.clay,\n\t\t\tResource.glass,\n\t\t\tResource.paper,\n\t\t],\n\t\textra: { godUpgrade: God.egyptian },\n\t},\n\t{\n\t\tname: \"phoenician grand temple\",\n\t\tage: Age.temple,\n\t\tcolor: Color.purple,\n\t\tcost: [\n\t\t\tResource.wood,\n\t\t\tResource.stone,\n\t\t\tResource.glass,\n\t\t\tResource.paper,\n\t\t\tResource.paper,\n\t\t],\n\t\textra: { godUpgrade: God.phoenician },\n\t},\n\t{\n\t\tname: \"meopotamian grand temple\",\n\t\tage: Age.temple,\n\t\tcolor: Color.purple,\n\t\tcost: [\n\t\t\tResource.wood,\n\t\t\tResource.wood,\n\t\t\tResource.wood,\n\t\t\tResource.glass,\n\t\t\tResource.paper,\n\t\t],\n\t\textra: { godUpgrade: God.mesopotamian },\n\t},\n\t{\n\t\tname: \"roman grand temple\",\n\t\tage: Age.temple,\n\t\tcolor: Color.purple,\n\t\tcost: [\n\t\t\tResource.clay,\n\t\t\tResource.stone,\n\t\t\tResource.glass,\n\t\t\tResource.glass,\n\t\t\tResource.paper,\n\t\t],\n\t\textra: { godUpgrade: God.roman },\n\t},\n\t{\n\t\tname: \"greek grand temple\",\n\t\tage: Age.temple,\n\t\tcolor: Color.purple,\n\t\tcost: [\n\t\t\tResource.stone,\n\t\t\tResource.stone,\n\t\t\tResource.stone,\n\t\t\tResource.glass,\n\t\t\tResource.paper,\n\t\t],\n\t\textra: { godUpgrade: God.greek },\n\t},\n];\n\nconst gods: GodType[] = [\n\t{\n\t\tname: \"anubis\",\n\t\tsource: God.egyptian,\n\t\tmessage: \"destroy a built wonder\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.anubis,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"ra\",\n\t\tsource: God.egyptian,\n\t\tmessage: \"steal an unbuilt wonder\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.ra,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"isis\",\n\t\tsource: God.egyptian,\n\t\tmessage: \"trash -> wonder\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.isis,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"aphrodite\",\n\t\tsource: God.greek,\n\t\tmessage: \"9 points\",\n\t\tf: () => null,\n\t\tpoints: () => 9,\n\t},\n\t{\n\t\tname: \"zeus\",\n\t\tsource: God.greek,\n\t\tmessage: \"destroy a structure card\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.zeus,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"hades\",\n\t\tsource: God.greek,\n\t\tmessage: \"build a card from the trash\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.revive,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"enki\",\n\t\tsource: God.mesopotamian,\n\t\tmessage: \"select 1 / 2 science tokens\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.enki,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"nisaba\",\n\t\tsource: God.mesopotamian,\n\t\tmessage: \"copy a science from opponent\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.nisaba,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"ishtar\",\n\t\tsource: God.mesopotamian,\n\t\tmessage: \"gain law science token\",\n\t\tf: () => utils.gainScience(ScienceEnum.law),\n\t},\n\t{\n\t\tname: \"baal\",\n\t\tsource: God.phoenician,\n\t\tmessage: \"steal a brown/grey card\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.baal,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"astarte\",\n\t\tsource: God.phoenician,\n\t\tmessage: \"$7, 1 point per\",\n\t\tf: () => (store.gameW.game.astarte = 7),\n\t\tpoints: () => store.gameW.game.astarte || 0,\n\t},\n\t{\n\t\tname: \"tanit\",\n\t\tsource: God.phoenician,\n\t\tmessage: \"$12\",\n\t\tf: () => (utils.getMe().money += 12),\n\t},\n\t{\n\t\tname: \"neptune\",\n\t\tsource: God.roman,\n\t\tmessage: \"destroy/trigger military tokens\",\n\t\tf: () => {\n\t\t\tconst myTokens = utils.getMe().militaryBonuses;\n\t\t\tconst oppTokens = utils.getOpponent().militaryBonuses;\n\t\t\tif (oppTokens[3]) {\n\t\t\t\tutils.getOpponent().money -= oppTokens[6];\n\t\t\t\tdelete oppTokens[3];\n\t\t\t\tdelete oppTokens[6];\n\t\t\t} else if (oppTokens[6]) {\n\t\t\t\tutils.getOpponent().money -= oppTokens[6];\n\t\t\t\tdelete oppTokens[6];\n\t\t\t\tif (myTokens[3]) {\n\t\t\t\t\tdelete myTokens[3];\n\t\t\t\t} else if (myTokens[6]) {\n\t\t\t\t\tdelete myTokens[6];\n\t\t\t\t}\n\t\t\t} else if (myTokens[3]) {\n\t\t\t\tutils.getOpponent().money -= myTokens[6];\n\t\t\t\tdelete myTokens[3];\n\t\t\t\tdelete myTokens[6];\n\t\t\t} else if (myTokens[6]) {\n\t\t\t\tutils.getOpponent().money -= myTokens[6];\n\t\t\t\tdelete myTokens[6];\n\t\t\t}\n\t\t\tutils.getOpponent().money = Math.max(0, utils.getOpponent().money);\n\t\t},\n\t},\n\t{\n\t\tname: \"minerva\",\n\t\tsource: God.roman,\n\t\tmessage: \"block military movement\",\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.minerva,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t},\n\t{\n\t\tname: \"mars\",\n\t\tsource: God.roman,\n\t\tmessage: \"military 2\",\n\t\tf: () => utils.increaseMilitary(2),\n\t},\n\t{\n\t\tname: \"gate\",\n\t\tmessage: \"cost x2: select 1 from top gods\",\n\t\tf: () => {\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.gate,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t});\n\t\t\tconst m = store.gameW.game.gods[God.mesopotamian];\n\t\t\tif (m && gods[m[0]].name === \"enki\") utils.assignEnki();\n\t\t},\n\t},\n];\n\nconst wonders: WonderType[] = [\n\t{\n\t\tname: \"the temple of artemis\",\n\t\tmessage: \"$12, go again\",\n\t\tcost: [Resource.paper, Resource.paper, Resource.glass, Resource.stone],\n\t\tf: () => (utils.getMe().money += 12),\n\t\tgoAgain: true,\n\t},\n\t{\n\t\tname: \"circus maximus\",\n\t\tmessage: \"3 points military +1 and destroy a grey card\",\n\t\tcost: [Resource.glass, Resource.wood, Resource.stone, Resource.stone],\n\t\tf: () => {\n\t\t\tutils.increaseMilitary(1);\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.destroyGrey,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t});\n\t\t},\n\t\tpoints: 3,\n\t},\n\t{\n\t\tname: \"the statue of zeus\",\n\t\tmessage: \"3 points military +1 and destroy a brown card\",\n\t\tcost: [\n\t\t\tResource.paper,\n\t\t\tResource.paper,\n\t\t\tResource.clay,\n\t\t\tResource.wood,\n\t\t\tResource.stone,\n\t\t],\n\t\tf: () => {\n\t\t\tutils.increaseMilitary(1);\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.destroyBrown,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t});\n\t\t},\n\t\tpoints: 3,\n\t},\n\t{\n\t\tname: \"the hanging gardens\",\n\t\tmessage: \"$6, 3 points, go again\",\n\t\tcost: [Resource.paper, Resource.glass, Resource.wood, Resource.wood],\n\t\tf: () => (utils.getMe().money += 6),\n\t\tgoAgain: true,\n\t\tpoints: 3,\n\t},\n\t{\n\t\tname: \"the great lighthouse\",\n\t\tmessage: `4 points o: ${Resource.wood}/${Resource.clay}/${Resource.stone}`,\n\t\tcost: [Resource.paper, Resource.paper, Resource.stone, Resource.wood],\n\t\tf: () => null,\n\t\tpoints: 4,\n\t\tresourceOptions: [Resource.wood, Resource.clay, Resource.stone],\n\t},\n\t{\n\t\tname: \"piraeus\",\n\t\tmessage: `2 points, go again o: ${Resource.paper}/${Resource.glass}`,\n\t\tcost: [Resource.clay, Resource.stone, Resource.wood, Resource.wood],\n\t\tf: () => null,\n\t\tgoAgain: true,\n\t\tpoints: 2,\n\t\tresourceOptions: [Resource.paper, Resource.glass],\n\t},\n\t{\n\t\tname: \"the sanctuary\",\n\t\tmessage: \"$2 discount on gods, go again\",\n\t\tcost: [Resource.paper, Resource.glass, Resource.stone, Resource.stone],\n\t\tf: () => null,\n\t\tgoAgain: true,\n\t\texpansion: true,\n\t},\n\t{\n\t\tname: \"the mausoleum\",\n\t\tmessage: \"2 points build from discard\",\n\t\tcost: [\n\t\t\tResource.paper,\n\t\t\tResource.glass,\n\t\t\tResource.glass,\n\t\t\tResource.clay,\n\t\t\tResource.clay,\n\t\t],\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.revive,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t}),\n\t\tpoints: 2,\n\t},\n\t{\n\t\tname: \"the appian way\",\n\t\tmessage: \"steal $3, 3 points, go again\",\n\t\tcost: [\n\t\t\tResource.paper,\n\t\t\tResource.clay,\n\t\t\tResource.clay,\n\t\t\tResource.stone,\n\t\t\tResource.stone,\n\t\t],\n\t\tf: () => {\n\t\t\tutils.getMe().money += 3;\n\t\t\tutils.stealMoney(3);\n\t\t},\n\t\tpoints: 3,\n\t\tgoAgain: true,\n\t},\n\t{\n\t\tname: \"the pyramids\",\n\t\tmessage: \"9 points\",\n\t\tcost: [Resource.paper, Resource.stone, Resource.stone, Resource.stone],\n\t\tf: () => null,\n\t\tpoints: 9,\n\t},\n\t{\n\t\tname: \"the sphinx\",\n\t\tmessage: \"6 points, go again\",\n\t\tcost: [Resource.glass, Resource.glass, Resource.clay, Resource.stone],\n\t\tf: () => null,\n\t\tpoints: 6,\n\t\tgoAgain: true,\n\t},\n\t{\n\t\tname: \"the great library\",\n\t\tmessage: \"4 points select 1/3 science tokens\",\n\t\tcost: [Resource.paper, Resource.glass, Resource.wood, Resource.wood],\n\t\tf: () =>\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.library,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t\tlibrary: utils\n\t\t\t\t\t.shuffle(\n\t\t\t\t\t\tstore.gameW.game.sciences\n\t\t\t\t\t\t\t.slice(NUM_SCIENCES)\n\t\t\t\t\t\t\t.filter((obj) => !obj.taken)\n\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t(obj) =>\n\t\t\t\t\t\t\t\t\t(store.gameW.game.enki || []).indexOf(\n\t\t\t\t\t\t\t\t\t\tobj.token\n\t\t\t\t\t\t\t\t\t) === -1\n\t\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t.slice(0, 3)\n\t\t\t\t\t.map((obj) => obj.token),\n\t\t\t}),\n\t\tpoints: 4,\n\t},\n\t{\n\t\tname: \"the colossus\",\n\t\tmessage: \"military +2, 3 points\",\n\t\tcost: [Resource.glass, Resource.clay, Resource.clay, Resource.clay],\n\t\tf: () => utils.increaseMilitary(2),\n\t\tpoints: 3,\n\t},\n\t{\n\t\tname: \"the divine theater\",\n\t\tmessage: \"2 points pick a god\",\n\t\tcost: [\n\t\t\tResource.paper,\n\t\t\tResource.paper,\n\t\t\tResource.glass,\n\t\t\tResource.wood,\n\t\t\tResource.wood,\n\t\t],\n\t\tf: () => {\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: CommercialEnum.theater,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t});\n\t\t\tif (\n\t\t\t\tstore.gameW.game.gods[God.mesopotamian].find(\n\t\t\t\t\t(godIndex) => gods[godIndex].name === \"enki\"\n\t\t\t\t)\n\t\t\t)\n\t\t\t\tutils.assignEnki();\n\t\t},\n\t\tpoints: 2,\n\t\texpansion: true,\n\t},\n];\n\nconst structure: { [age in Age]?: number[][] } = {\n\t[Age.one]: [\n\t\t[4, 4],\n\t\t[3, 3, 3],\n\t\t[2, 2, 2, 2],\n\t\t[1, 1, 1, 1, 1],\n\t\t[0, 0, 0, 0, 0, 0],\n\t],\n\t[Age.two]: [\n\t\t[0, 0, 0, 0, 0, 0],\n\t\t[1, 1, 1, 1, 1],\n\t\t[2, 2, 2, 2],\n\t\t[3, 3, 3],\n\t\t[4, 4],\n\t],\n\t[Age.three]: [\n\t\t[2, 2],\n\t\t[1, 1, 1],\n\t\t[0, 0, 0, 0],\n\t\t[1, 3],\n\t\t[0, 0, 0, 0],\n\t\t[1, 1, 1],\n\t\t[2, 2],\n\t],\n};\n\nconst bank = { cards, structure, wonders, gods };\n\nexport default bank;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport {\n\tAge,\n\tColor,\n\tUpgrade,\n\tCardType,\n\tScienceEnum,\n\tGod,\n} from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\nimport css from \"../../index.module.css\";\n\nclass StructureCard extends React.Component<{\n\tselectCard: (x: number, y: number, offset: number) => void;\n\tcardIndex: number;\n\trevealed: boolean;\n\ttaken: boolean;\n\tx: number;\n\ty: number;\n\toffset: number;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={`${css.structure_card} ${styles.bubble}`}\n\t\t\t\tonClick={() =>\n\t\t\t\t\tthis.props.selectCard(\n\t\t\t\t\t\tthis.props.x,\n\t\t\t\t\t\tthis.props.y,\n\t\t\t\t\t\tthis.props.offset\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: `translate(${this.props.offset * 50}%, 0%)`,\n\t\t\t\t\tvisibility: this.props.taken ? \"hidden\" : \"visible\",\n\t\t\t\t\tzIndex: this.props.y,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{this.renderCard()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderCard() {\n\t\tconst card = bank.cards[this.props.cardIndex];\n\t\tif (!this.props.revealed) {\n\t\t\tif (store.gameW.game.params.godExpansion) {\n\t\t\t\tif (store.gameW.game.age === Age.one) {\n\t\t\t\t\tif (this.props.x % 2 === 0) {\n\t\t\t\t\t\treturn \"god token\";\n\t\t\t\t\t}\n\t\t\t\t} else if (store.gameW.game.age === Age.two) {\n\t\t\t\t\tif (this.props.x % 2 === 0 && this.props.y === 1) {\n\t\t\t\t\t\treturn \"discount token\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (store.gameW.game.age !== card.age) {\n\t\t\t\treturn Age[card.age];\n\t\t\t}\n\t\t\treturn \"?\";\n\t\t}\n\t\treturn (\n\t\t\t<div title={JSON.stringify(card, null, 2)}>\n\t\t\t\t<div style={{ backgroundColor: Color[card.color] }}>_</div>\n\t\t\t\t<div>{card.name}</div>\n\t\t\t\t<div>\n\t\t\t\t\tcost: {card.cost.join(\"\")} ($\n\t\t\t\t\t{utils.getCardCost(\n\t\t\t\t\t\tcard,\n\t\t\t\t\t\tutils.getMe() || utils.getCurrent()\n\t\t\t\t\t)}\n\t\t\t\t\t)\n\t\t\t\t</div>\n\t\t\t\t{card.message && <div>{card.message}</div>}\n\t\t\t\t{this.renderExtra(card)}\n\t\t\t\t{card.upgradesFrom !== undefined && (\n\t\t\t\t\t<div>from: {Upgrade[card.upgradesFrom]}</div>\n\t\t\t\t)}\n\t\t\t\t{card.upgradesTo !== undefined && (\n\t\t\t\t\t<div>to: {Upgrade[card.upgradesTo]}</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderExtra(card: CardType) {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{card.extra.resource && (\n\t\t\t\t\t<div>({card.extra.resource!.join(\"\")})</div>\n\t\t\t\t)}\n\t\t\t\t{card.extra.resourceOptions && (\n\t\t\t\t\t<div>({card.extra.resourceOptions!.join(\"/\")})</div>\n\t\t\t\t)}\n\t\t\t\t{card.extra.discount && (\n\t\t\t\t\t<div>d: ({card.extra.discount!.join(\"\")})</div>\n\t\t\t\t)}\n\t\t\t\t{card.extra.points && <div>{card.extra.points} points</div>}\n\t\t\t\t{card.extra.military && (\n\t\t\t\t\t<div>military: {card.extra.military}</div>\n\t\t\t\t)}\n\t\t\t\t{card.extra.science !== undefined && (\n\t\t\t\t\t<div>symbol: {ScienceEnum[card.extra.science]}</div>\n\t\t\t\t)}\n\t\t\t\t{card.extra.godUpgrade !== undefined && (\n\t\t\t\t\t<div>{God[card.extra.godUpgrade]}</div>\n\t\t\t\t)}\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default StructureCard;\n","import React from \"react\";\n\nimport { store } from \"../../utils/utils\";\nimport StructureCard from \"./StructureCard\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\nimport css from \"../../index.module.css\";\n\nclass Structure extends React.Component<{\n\tselectCard: (x: number, y: number, offset: number) => void;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Structure</h2>\n\t\t\t\t{store.gameW.game.structure &&\n\t\t\t\t\tstore.gameW.game.structure.map((row, y) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={y}\n\t\t\t\t\t\t\tclassName={`${css.structure_row} ${\n\t\t\t\t\t\t\t\ty === 0 && css.structure_first_row\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{Object.entries(row).map(([offset, card], x) => (\n\t\t\t\t\t\t\t\t<StructureCard\n\t\t\t\t\t\t\t\t\tkey={x}\n\t\t\t\t\t\t\t\t\tselectCard={this.props.selectCard}\n\t\t\t\t\t\t\t\t\ty={y}\n\t\t\t\t\t\t\t\t\tx={x}\n\t\t\t\t\t\t\t\t\toffset={offset}\n\t\t\t\t\t\t\t\t\t{...card}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Structure;\n","import React from \"react\";\nimport { TokenType, God } from \"../../utils/types\";\n\nimport utils, { store } from \"../../utils/utils\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Tokens extends React.Component<{\n\ttokens: TokenType[];\n\tusedTokens?: { [tokenIndex: number]: boolean };\n\tdiscount: (tokenIndex: number) => void;\n\tplayerIndex: number;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={`${styles.flex} ${styles.bubble}`}>\n\t\t\t\t<div>Tokens:</div>\n\t\t\t\t{this.props.tokens.map((token, tokenIndex) => (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={tokenIndex}\n\t\t\t\t\t\tclassName={`${styles.bubble} ${\n\t\t\t\t\t\t\t(this.props.usedTokens || {})[tokenIndex] &&\n\t\t\t\t\t\t\tstyles.grey\n\t\t\t\t\t\t}`}\n\t\t\t\t\t\tonClick={(e: React.MouseEvent) => {\n\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\tif (store.gameW.game.commercials) return;\n\t\t\t\t\t\t\tif (token.isGod) return;\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tthis.props.discount(tokenIndex);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{token.isGod\n\t\t\t\t\t\t\t? God[token.value]\n\t\t\t\t\t\t\t: this.props.playerIndex === utils.myIndex()\n\t\t\t\t\t\t\t? token.value\n\t\t\t\t\t\t\t: \"$\"}\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Tokens;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { WonderType, PlayerType } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\nimport css from \"../../index.module.css\";\n\nclass Wonders extends React.Component<{\n\tplayer: PlayerType;\n\tselect: (index: number) => void;\n\tselected?: number;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={`${styles.bubble} ${css.nowrap}`}>\n\t\t\t\t{this.props.player.wonders.map((_, index) =>\n\t\t\t\t\tthis.renderWonder(index)\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderWonder(index: number) {\n\t\tconst playerWonder = this.props.player.wonders[index];\n\t\tconst wonder = bank.wonders[playerWonder.wonderIndex];\n\t\tconst contents = playerWonder.built\n\t\t\t? this.renderBuilt(wonder)\n\t\t\t: this.renderUnbuilt(wonder, index);\n\t\treturn (\n\t\t\t<div key={index} title={JSON.stringify(wonder, null, 2)}>\n\t\t\t\t{contents}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderBuilt(wonder: WonderType) {\n\t\treturn <div className={css.built_wonder}>{wonder.name}</div>;\n\t}\n\n\trenderUnbuilt(wonder: WonderType, index: number) {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={\n\t\t\t\t\tindex === this.props.selected ? styles.grey : undefined\n\t\t\t\t}\n\t\t\t\tonClick={(e: React.MouseEvent) => this.selectSelf(index, e)}\n\t\t\t>\n\t\t\t\t{wonder.name} - {wonder.cost.join(\"\")} ($\n\t\t\t\t{utils.getWonderCost(wonder, this.props.player)})\n\t\t\t</div>\n\t\t);\n\t}\n\n\tselectSelf(index: number, e: React.MouseEvent) {\n\t\te.stopPropagation();\n\t\tthis.props.select(index);\n\t}\n}\n\nexport default Wonders;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport { ScienceToken } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Sciences extends React.Component<{ sciences: ScienceToken[] }> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t{this.props.sciences.map((science) => (\n\t\t\t\t\t<div key={science} title={science}>\n\t\t\t\t\t\t{utils.enumName(science, ScienceToken)}\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Sciences;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { CardType, Color, ScienceEnum, Upgrade } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Cards extends React.Component<{ cards: number[] }> {\n\trender() {\n\t\tconst cardsByColor = utils.arrToDict(\n\t\t\tthis.props.cards.map((cardIndex) => bank.cards[cardIndex]),\n\t\t\t(card) => card.color.toString()\n\t\t);\n\t\treturn Object.entries(cardsByColor).map(([color, cards]) => {\n\t\t\treturn (\n\t\t\t\t<div key={color} className={styles.bubble}>\n\t\t\t\t\t<div style={{ backgroundColor: Color[parseInt(color)] }}>\n\t\t\t\t\t\t_\n\t\t\t\t\t</div>\n\t\t\t\t\t{this.renderColorCards(parseInt(color), cards!)}\n\t\t\t\t</div>\n\t\t\t);\n\t\t});\n\t}\n\n\trenderColorCards(color: Color, cards: CardType[]) {\n\t\tvar f: (card: CardType) => string = () => \"\";\n\t\tswitch (color) {\n\t\t\tcase Color.brown:\n\t\t\tcase Color.grey:\n\t\t\t\tf = (card: CardType) => card.extra.resource!.join(\"\");\n\t\t\t\tbreak;\n\t\t\tcase Color.yellow:\n\t\t\t\tf = (card: CardType) =>\n\t\t\t\t\t[\n\t\t\t\t\t\tcard.extra.discount &&\n\t\t\t\t\t\t\t`d: ${card.extra.discount.join(\"\")}`,\n\t\t\t\t\t\tcard.extra.resourceOptions &&\n\t\t\t\t\t\t\t`o: ${card.extra.resourceOptions.join(\"/\")}`,\n\t\t\t\t\t]\n\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t.join(\" - \");\n\t\t\t\tbreak;\n\t\t\tcase Color.red:\n\t\t\t\tf = (card: CardType) => card.extra.military!.toLocaleString();\n\t\t\t\tbreak;\n\t\t\tcase Color.blue:\n\t\t\t\tf = (card: CardType) => card.extra.points!.toLocaleString();\n\t\t\t\tbreak;\n\t\t\tcase Color.green:\n\t\t\t\tf = (card: CardType) =>\n\t\t\t\t\t[ScienceEnum[card.extra.science!], card.extra.points]\n\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t.join(\" + \");\n\t\t\t\tbreak;\n\t\t}\n\t\treturn cards.map((card) => (\n\t\t\t<pre key={card.name} title={JSON.stringify(card, null, 2)}>\n\t\t\t\t{[\n\t\t\t\t\tcard.name,\n\t\t\t\t\tf(card),\n\t\t\t\t\tcard.message,\n\t\t\t\t\tcard.upgradesTo !== undefined && Upgrade[card.upgradesTo],\n\t\t\t\t]\n\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t.join(\" - \")}\n\t\t\t</pre>\n\t\t));\n\t}\n}\n\nexport default Cards;\n","import React from \"react\";\nimport { GodType } from \"../../utils/types\";\n\nimport utils, { store } from \"../../utils/utils\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass God extends React.Component<{ god: GodType }> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble} onClick={this.f.bind(this)}>\n\t\t\t\t{this.text()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\ttext() {\n\t\tconst name = this.props.god.name;\n\t\tif (name === \"astarte\")\n\t\t\treturn `${name}: ${store.gameW.game.astarte || 0}`;\n\t\treturn name;\n\t}\n\n\tf(e: React.MouseEvent) {\n\t\tif (this.props.god.name !== \"astarte\") return;\n\t\tif (!utils.isMyTurn()) return;\n\t\tif (!store.gameW.game.astarte) return;\n\t\tstore.gameW.game.astarte--;\n\t\tutils.getMe().money++;\n\t\tstore.update(\"used Astarte\");\n\t\te.stopPropagation();\n\t}\n}\n\nexport default God;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { PlayerType } from \"../../utils/types\";\n\nimport Tokens from \"./Tokens\";\nimport Wonders from \"./Wonders\";\nimport Sciences from \"./Sciences\";\nimport Cards from \"./Cards\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\nimport God from \"./God\";\n\nclass Player extends React.Component<{\n\tplayer: PlayerType;\n\tselected?: number;\n\tselectWonder: (index: number) => void;\n\tusedTokens?: { [tokenIndex: number]: boolean };\n\tdiscount: (tokenIndex: number) => void;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={`${styles.bubble} ${\n\t\t\t\t\t\tthis.props.selected === -1 && styles.grey\n\t\t\t\t\t}`}\n\t\t\t\t\tonClick={() => this.props.selectWonder(-1)}\n\t\t\t\t>\n\t\t\t\t\t<h2>\n\t\t\t\t\t\t{this.props.player.userName} - $\n\t\t\t\t\t\t{this.props.player.money} -{\" \"}\n\t\t\t\t\t\t{utils.getScore(this.props.player)}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t\t{this.props.player.wonders && (\n\t\t\t\t\t\t\t<Wonders\n\t\t\t\t\t\t\t\tplayer={this.props.player}\n\t\t\t\t\t\t\t\tselect={this.props.selectWonder}\n\t\t\t\t\t\t\t\tselected={this.props.selected}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{this.props.player.cards && (\n\t\t\t\t\t\t\t<Cards cards={this.props.player.cards} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t{this.props.player.scienceTokens && (\n\t\t\t\t\t\t<Sciences sciences={this.props.player.scienceTokens} />\n\t\t\t\t\t)}\n\t\t\t\t\t{this.props.player.tokens && (\n\t\t\t\t\t\t<Tokens\n\t\t\t\t\t\t\ttokens={this.props.player.tokens}\n\t\t\t\t\t\t\tusedTokens={this.props.usedTokens}\n\t\t\t\t\t\t\tdiscount={this.props.discount}\n\t\t\t\t\t\t\tplayerIndex={this.props.player.index}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{(this.props.player.gods || [])\n\t\t\t\t\t\t\t.map((godIndex) => bank.gods[godIndex])\n\t\t\t\t\t\t\t.map((god, index) => (\n\t\t\t\t\t\t\t\t<God god={god} key={index} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Player;\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\nimport { CommercialEnum, PlayerType } from \"../utils/types\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport css from \"../index.module.css\";\n\nconst NUM_POSITIONS = 9;\n\nclass Military extends React.Component<{ players: PlayerType[] }> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Military</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{Array.from(new Array(NUM_POSITIONS * 2 + 1)).map(\n\t\t\t\t\t\t(_, index) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\tclassName={`${css.military} ${styles.bubble}`}\n\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\tthis.minerva(index - NUM_POSITIONS)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t{this.getFill(\n\t\t\t\t\t\t\t\t\t\tstore.gameW.game.military,\n\t\t\t\t\t\t\t\t\t\tindex - NUM_POSITIONS\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t{utils.getMilitaryPoints(\n\t\t\t\t\t\t\t\t\t\tMath.abs(index - NUM_POSITIONS)\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tminerva(index: number) {\n\t\tif (!utils.isMyCommercial(CommercialEnum.minerva)) return;\n\t\tstore.gameW.game.minerva = index;\n\t\tutils.endCommercial(`placed Minerva`);\n\t}\n\n\tgetFill(militaryDiff: number, index: number) {\n\t\tif (index === militaryDiff) return \"x\";\n\t\tconst stars =\n\t\t\tstore.gameW.game.players[index > 0 ? 0 : 1].militaryBonuses[\n\t\t\t\tMath.abs(index)\n\t\t\t];\n\t\tif (stars === 0)\n\t\t\treturn index * (utils.myIndex() - 0.5) > 0 ? \"LOSE\" : \"WIN\";\n\t\tconst s = \"*\".repeat(stars);\n\t\tconst m = index === store.gameW.game.minerva ? \" M\" : \"\";\n\t\treturn s + m;\n\t}\n}\n\nexport default Military;\n","import React from \"react\";\n\nimport { store } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Board extends React.Component<{ selected: boolean; select: () => void }> {\n\trender() {\n\t\tconst classes = [styles.bubble];\n\t\tif (this.props.selected) classes.push(styles.grey);\n\t\treturn (\n\t\t\t<div className={classes.join(\" \")} onClick={this.props.select}>\n\t\t\t\t<h2>Trash: {store.gameW.game.trash?.length || 0}</h2>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Board;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { Color } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Isis extends React.Component<{}, { trashIndex: number }> {\n\trender() {\n\t\tif (!utils.isMyTurn()) return null;\n\t\tconst wonders = utils.getMe().wonders.filter((wonder) => !wonder.built);\n\t\tif (!wonders.length) {\n\t\t\tutils.endCommercial(\"no wonders to build\");\n\t\t\treturn null;\n\t\t}\n\t\tif (!store.gameW.game.trash) {\n\t\t\tutils.endCommercial(\"no cards in trash\");\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<div>\n\t\t\t\t\t<h2>Build Wonder</h2>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{wonders\n\t\t\t\t\t\t\t.map((pWonder) => ({\n\t\t\t\t\t\t\t\tpWonder,\n\t\t\t\t\t\t\t\twonder: bank.wonders[pWonder.wonderIndex],\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t.map((obj) => (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\t\t\tkey={obj.pWonder.wonderIndex}\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\t\tif (!this.state)\n\t\t\t\t\t\t\t\t\t\t\treturn alert(\n\t\t\t\t\t\t\t\t\t\t\t\t\"pick a card from trash first\"\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tstore.gameW.game.trash!.splice(\n\t\t\t\t\t\t\t\t\t\t\tthis.state.trashIndex,\n\t\t\t\t\t\t\t\t\t\t\t1\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tobj.pWonder.built = true;\n\t\t\t\t\t\t\t\t\t\tbank.wonders[\n\t\t\t\t\t\t\t\t\t\t\tobj.pWonder.wonderIndex\n\t\t\t\t\t\t\t\t\t\t].f();\n\t\t\t\t\t\t\t\t\t\tif (obj.wonder.goAgain)\n\t\t\t\t\t\t\t\t\t\t\tutils.incrementPlayerTurn();\n\t\t\t\t\t\t\t\t\t\tutils.endCommercial(\n\t\t\t\t\t\t\t\t\t\t\t`built ${obj.wonder.name}`\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ttitle={JSON.stringify(obj.wonder, null, 2)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{obj.wonder.name}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h2>Trash Cards</h2>\n\t\t\t\t\t\t{store.gameW.game\n\t\t\t\t\t\t\t.trash!.map((trashIndex) => ({\n\t\t\t\t\t\t\t\ttrashIndex,\n\t\t\t\t\t\t\t\tcard: bank.cards[trashIndex],\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t.map((obj) => (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={obj.trashIndex}\n\t\t\t\t\t\t\t\t\ttitle={JSON.stringify(obj.card, null, 2)}\n\t\t\t\t\t\t\t\t\tclassName={`${styles.bubble} ${\n\t\t\t\t\t\t\t\t\t\tthis.state?.trashIndex ===\n\t\t\t\t\t\t\t\t\t\tobj.trashIndex\n\t\t\t\t\t\t\t\t\t\t\t? styles.grey\n\t\t\t\t\t\t\t\t\t\t\t: \"\"\n\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\t\t\ttrashIndex:\n\t\t\t\t\t\t\t\t\t\t\t\tobj.trashIndex ===\n\t\t\t\t\t\t\t\t\t\t\t\tthis.state?.trashIndex\n\t\t\t\t\t\t\t\t\t\t\t\t\t? -1\n\t\t\t\t\t\t\t\t\t\t\t\t\t: obj.trashIndex,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tbackgroundColor:\n\t\t\t\t\t\t\t\t\t\t\t\tColor[obj.card.color],\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t_\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{obj.card.name}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Isis;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { Age } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass ChooseWonder extends React.Component {\n\trender() {\n\t\tconst total = store.gameW.game.wondersToChoose?.length;\n\t\tconst remaining = total > 4 ? total - 4 : total;\n\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Wonders</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{Object.keys(Array.from(new Array(remaining))).map(\n\t\t\t\t\t\tthis.renderWonder.bind(this)\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderWonder(indexS: string) {\n\t\tconst index = parseInt(indexS);\n\t\tconst wonder = bank.wonders[store.gameW.game.wondersToChoose[index]];\n\t\treturn (\n\t\t\t<div\n\t\t\t\tkey={index}\n\t\t\t\tclassName={styles.bubble}\n\t\t\t\ttitle={JSON.stringify(wonder, null, 2)}\n\t\t\t\tonClick={() => this.chooseWonder(index)}\n\t\t\t>\n\t\t\t\t<p>{wonder.name}</p>\n\t\t\t\t<p>{wonder.message}</p>\n\t\t\t\t<div>cost: {wonder.cost.join(\"\")}</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tchooseWonder(index: number) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst game = store.gameW.game;\n\t\tconst wondersToChoose = game.wondersToChoose;\n\t\tconst wonderIndex = wondersToChoose.splice(index, 1)[0];\n\t\tif (!utils.getMe().wonders) utils.getMe().wonders = [];\n\t\tutils.getMe().wonders.push({ built: false, wonderIndex });\n\t\tconst remaining = wondersToChoose.length;\n\n\t\tif (!remaining) {\n\t\t\tgame.age = Age.one;\n\t\t\tutils.deal(game);\n\t\t} else {\n\t\t\tconst playerIndex =\n\t\t\t\tMath.abs(remaining - 4) === 2\n\t\t\t\t\t? utils.currentIndex()\n\t\t\t\t\t: 1 - utils.currentIndex();\n\t\t\tutils.addCommercial({\n\t\t\t\tcommercial: game.commercials![0].commercial,\n\t\t\t\tplayerIndex,\n\t\t\t});\n\t\t}\n\t\tutils.endCommercial(`selected ${bank.wonders[wonderIndex].name}`);\n\t}\n}\n\nexport default ChooseWonder;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { Color, PlayerType } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass DestroyCard extends React.Component<{ color: Color }> {\n\trender() {\n\t\tconst victim = utils.getPlayer(1 - utils.currentIndex());\n\t\tconst cards = (victim.cards || [])\n\t\t\t.map((cardIndex, handIndex) => ({\n\t\t\t\thandIndex,\n\t\t\t\tcardIndex,\n\t\t\t\tcard: bank.cards[cardIndex],\n\t\t\t}))\n\t\t\t.filter((obj) => obj.card.color === this.props.color);\n\t\tif (!cards.length) {\n\t\t\tutils.endCommercial(\n\t\t\t\t`could not destroy a ${Color[this.props.color]} card`\n\t\t\t);\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>\n\t\t\t\t\t{victim.userName}'s {Color[this.props.color]} Cards\n\t\t\t\t</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{cards.map((obj) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={obj.cardIndex}\n\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\tthis.destroyCard(obj.handIndex, victim)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{obj.card.name}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tdestroyCard(handIndex: number, victim: PlayerType) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst cardIndex = victim.cards!.splice(handIndex, 1)[0];\n\t\tif (!store.gameW.game.trash) store.gameW.game.trash = [];\n\t\tstore.gameW.game.trash.push(cardIndex);\n\t\tutils.endCommercial(`destroyed ${bank.cards[cardIndex].name}`);\n\t}\n}\n\nexport default DestroyCard;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\nimport { Color } from \"../../utils/types\";\n\nclass Revive extends React.Component {\n\trender() {\n\t\tif (!utils.isMyTurn()) return null;\n\t\tconst cards = store.gameW.game.trash || [];\n\t\tif (!cards) {\n\t\t\tutils.endCommercial(\"could not revive a card\");\n\t\t\treturn;\n\t\t}\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Discarded Cards</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{cards\n\t\t\t\t\t\t.map((cardIndex) => bank.cards[cardIndex])\n\t\t\t\t\t\t.map((card, index) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\ttitle={JSON.stringify(card, null, 2)}\n\t\t\t\t\t\t\t\tonClick={() => this.reviveCard(index)}\n\t\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: Color[card.color],\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t_\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{card.name}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treviveCard(trashIndex: number) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst cardIndex = store.gameW.game.trash!.splice(trashIndex, 1)[0];\n\t\tconst me = utils.getMe();\n\t\tif (!me.cards) me.cards = [];\n\t\tme.cards.push(cardIndex);\n\t\tconst card = bank.cards[cardIndex];\n\t\tutils.handleCardGain(card, false);\n\t\tutils.endCommercial(`revived ${card.name}`);\n\t}\n}\n\nexport default Revive;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport { ScienceToken } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Library extends React.Component<{}> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Library</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{store.gameW.game.commercials![0].library!.map(\n\t\t\t\t\t\t(scienceName: ScienceToken) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\tutils.buildScienceToken(scienceName)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\t\tkey={scienceName}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{utils.enumName(scienceName, ScienceToken)} -{\" \"}\n\t\t\t\t\t\t\t\t{scienceName}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Library;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass DestroyWonder extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Destroy Wonder</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{utils\n\t\t\t\t\t\t.getCurrent()\n\t\t\t\t\t\t.wonders.map((wonder, index) => ({\n\t\t\t\t\t\t\twonder,\n\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\t.filter((obj) => !obj.wonder.built)\n\t\t\t\t\t\t.map((obj) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={obj.index}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\tutils.getMe().wonders.splice(obj.index, 1);\n\t\t\t\t\t\t\t\t\tutils.endCommercial(\n\t\t\t\t\t\t\t\t\t\t`destroyed ${\n\t\t\t\t\t\t\t\t\t\t\tbank.wonders[obj.wonder.wonderIndex]\n\t\t\t\t\t\t\t\t\t\t\t\t.name\n\t\t\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{bank.wonders[obj.wonder.wonderIndex].name}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default DestroyWonder;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nconst GODS_TO_DRAW = 2;\n\nclass PickGod extends React.Component<{\n\treset: () => void;\n\tselectedPantheon?: number;\n}> {\n\trender() {\n\t\tif (!utils.isMyTurn()) return null;\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{store.gameW.game.gods[store.gameW.game.godTokens[0]]\n\t\t\t\t\t\t.slice(0, GODS_TO_DRAW)\n\t\t\t\t\t\t.map((godIndex, tokenIndex) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={tokenIndex}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tthis.props.selectedPantheon ===\n\t\t\t\t\t\t\t\t\t\tundefined\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\treturn alert(\n\t\t\t\t\t\t\t\t\t\t\t\"need to select a target first\"\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tconst value = store.gameW.game.godTokens.shift()!;\n\t\t\t\t\t\t\t\t\tconst selected = store.gameW.game.gods[\n\t\t\t\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t\t\t].splice(tokenIndex, 1)[0];\n\t\t\t\t\t\t\t\t\tstore.gameW.game.pantheon[\n\t\t\t\t\t\t\t\t\t\tthis.props.selectedPantheon\n\t\t\t\t\t\t\t\t\t] = selected;\n\t\t\t\t\t\t\t\t\tconst me = utils.getMe();\n\t\t\t\t\t\t\t\t\tif (!me.tokens) me.tokens = [];\n\t\t\t\t\t\t\t\t\tme.tokens.push({\n\t\t\t\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\t\t\tisGod: true,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tutils.endCommercial(\"placed a god\");\n\t\t\t\t\t\t\t\t\tthis.props.reset();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\t\ttitle={JSON.stringify(\n\t\t\t\t\t\t\t\t\tbank.gods[godIndex],\n\t\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\t\t2\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<p>{bank.gods[godIndex].name}</p>\n\t\t\t\t\t\t\t\t<p>{bank.gods[godIndex].message}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default PickGod;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Anubis extends React.Component {\n\trender() {\n\t\tconst wondersToUnbuild = utils\n\t\t\t.getMe()\n\t\t\t.wonders.concat(utils.getOpponent().wonders)\n\t\t\t.filter((wonder) => wonder.built);\n\t\tif (!wondersToUnbuild.length) {\n\t\t\tutils.endCommercial(\"couldnt destroy a wonder\");\n\t\t\treturn;\n\t\t}\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Unbuild Wonder</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{wondersToUnbuild\n\t\t\t\t\t\t.map((wonderObj) => ({\n\t\t\t\t\t\t\twonderObj,\n\t\t\t\t\t\t\twonder: bank.wonders[wonderObj.wonderIndex],\n\t\t\t\t\t\t}))\n\t\t\t\t\t\t.map((obj) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={obj.wonderObj.wonderIndex}\n\t\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\tobj.wonderObj.built = false;\n\t\t\t\t\t\t\t\t\tutils.endCommercial(\n\t\t\t\t\t\t\t\t\t\t`unbuilt ${obj.wonder.name}`\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{obj.wonder.name}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Anubis;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Ra extends React.Component {\n\trender() {\n\t\tconst wondersToSteal = utils\n\t\t\t.getPlayer(1 - utils.currentIndex())\n\t\t\t.wonders.map((wonder, index) => ({ wonder, index }))\n\t\t\t.filter((obj) => !obj.wonder.built);\n\t\tif (!wondersToSteal.length) {\n\t\t\tutils.endCommercial(\"could not steal a wonder\");\n\t\t\treturn;\n\t\t}\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Steal Wonder</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{wondersToSteal.map((obj) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={obj.index}\n\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\tutils\n\t\t\t\t\t\t\t\t\t.getOpponent()\n\t\t\t\t\t\t\t\t\t.wonders.splice(obj.index, 1);\n\t\t\t\t\t\t\t\tutils.getMe().wonders.push(obj.wonder);\n\t\t\t\t\t\t\t\tutils.endCommercial(\n\t\t\t\t\t\t\t\t\t`stole ${\n\t\t\t\t\t\t\t\t\t\tbank.wonders[obj.wonder.wonderIndex]\n\t\t\t\t\t\t\t\t\t\t\t.name\n\t\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{bank.wonders[obj.wonder.wonderIndex].name}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Ra;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { Color, ScienceEnum } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Nisaba extends React.Component {\n\trender() {\n\t\tconst sciences = (\n\t\t\tutils.getPlayer(1 - utils.currentIndex()).cards || []\n\t\t).filter((cardIndex) => bank.cards[cardIndex].color === Color.green);\n\t\tif (!sciences.length) {\n\t\t\tif (utils.isMyTurn()) utils.endCommercial(\"no sciences to copy\");\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Copy Science</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{sciences\n\t\t\t\t\t\t.map((index) => ({ index, card: bank.cards[index] }))\n\t\t\t\t\t\t.map((obj) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={obj.index}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\tconst science = obj.card.extra.science!;\n\t\t\t\t\t\t\t\t\tutils.gainScience(science);\n\t\t\t\t\t\t\t\t\tutils.endCommercial(\n\t\t\t\t\t\t\t\t\t\t`copied ${ScienceEnum[science]}`\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ScienceEnum[obj.card.extra.science!]}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Nisaba;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport { ScienceToken } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\nimport store from \"../../../../../shared/store\";\n\nclass Enki extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Choose a Science Token</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{store.gameW.game.enki!.map((scienceName: ScienceToken) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={scienceName}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tutils.buildScienceToken(scienceName);\n\t\t\t\t\t\t\t\tdelete store.gameW.game.enki;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{utils.enumName(scienceName, ScienceToken)} -{\" \"}\n\t\t\t\t\t\t\t{scienceName}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Enki;\n","import React from \"react\";\n\nimport utils from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { Color } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Baal extends React.Component {\n\trender() {\n\t\tconst cardsToSteal = (\n\t\t\tutils.getPlayer(1 - utils.currentIndex()).cards || []\n\t\t)\n\t\t\t.map((cardIndex, handIndex) => ({\n\t\t\t\thandIndex,\n\t\t\t\tcard: bank.cards[cardIndex],\n\t\t\t}))\n\t\t\t.filter(\n\t\t\t\t(obj) =>\n\t\t\t\t\tobj.card.color === Color.brown ||\n\t\t\t\t\tobj.card.color === Color.grey\n\t\t\t);\n\t\tif (!cardsToSteal.length) {\n\t\t\tutils.endCommercial(\"no cards to steal\");\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Steal a brown/grey card</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{cardsToSteal.map((obj) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\tconst me = utils.getMe();\n\t\t\t\t\t\t\t\tif (!me.cards) me.cards = [];\n\t\t\t\t\t\t\t\tconst cardIndex = utils\n\t\t\t\t\t\t\t\t\t.getOpponent()\n\t\t\t\t\t\t\t\t\t.cards!.splice(obj.handIndex, 1)[0];\n\t\t\t\t\t\t\t\tme.cards.push(cardIndex);\n\t\t\t\t\t\t\t\tutils.endCommercial(`stole ${obj.card.name}`);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{obj.card.name}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Baal;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { ScienceToken } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Theater extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Pick a god</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{Object.values(store.gameW.game.gods)\n\t\t\t\t\t\t.flatMap((gods) => gods)\n\t\t\t\t\t\t.map((godIndex) => ({\n\t\t\t\t\t\t\tgodIndex,\n\t\t\t\t\t\t\tgod: bank.gods[godIndex],\n\t\t\t\t\t\t}))\n\t\t\t\t\t\t.map((obj) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={obj.godIndex}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\tconst gods =\n\t\t\t\t\t\t\t\t\t\tstore.gameW.game.gods[obj.god.source!];\n\t\t\t\t\t\t\t\t\tconst index = gods.indexOf(obj.godIndex);\n\t\t\t\t\t\t\t\t\tconst me = utils.getMe();\n\t\t\t\t\t\t\t\t\tconst godIndex = gods.splice(index, 1)[0];\n\t\t\t\t\t\t\t\t\tbank.gods[godIndex].f();\n\t\t\t\t\t\t\t\t\tif (!me.gods) me.gods = [];\n\t\t\t\t\t\t\t\t\tme.gods.push(godIndex);\n\t\t\t\t\t\t\t\t\tutils.endCommercial(\n\t\t\t\t\t\t\t\t\t\t`built ${obj.god.name}`\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\t\ttitle={JSON.stringify(obj.god, null, 2)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{obj.god.name}\n\t\t\t\t\t\t\t\t{obj.god.name === \"enki\" &&\n\t\t\t\t\t\t\t\t\t` - ${store.gameW.game\n\t\t\t\t\t\t\t\t\t\t.enki!.map((token) =>\n\t\t\t\t\t\t\t\t\t\t\tutils.enumName(token, ScienceToken)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t.join(\" \")}`}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Theater;\n","import React from \"react\";\n\nimport utils, { store } from \"../../utils/utils\";\nimport bank from \"../../utils/bank\";\nimport { God, ScienceToken } from \"../../utils/types\";\n\nimport styles from \"../../../../../shared/styles.module.css\";\n\nclass Gate extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Pick a top god</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{Object.values(store.gameW.game.gods)\n\t\t\t\t\t\t.map((gods) => gods[0])\n\t\t\t\t\t\t.filter((godIndex) => godIndex !== undefined)\n\t\t\t\t\t\t.map((godIndex) => ({\n\t\t\t\t\t\t\tgodIndex,\n\t\t\t\t\t\t\tgod: bank.gods[godIndex],\n\t\t\t\t\t\t}))\n\t\t\t\t\t\t.map((obj) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={obj.godIndex}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\tconst me = utils.getMe();\n\t\t\t\t\t\t\t\t\tif (!me.gods) me.gods = [];\n\t\t\t\t\t\t\t\t\tconst godIndex = store.gameW.game.gods[\n\t\t\t\t\t\t\t\t\t\tobj.god.source!\n\t\t\t\t\t\t\t\t\t]!.shift()!;\n\t\t\t\t\t\t\t\t\tme.gods.push(godIndex);\n\t\t\t\t\t\t\t\t\tconst god = bank.gods[godIndex];\n\n\t\t\t\t\t\t\t\t\tconst m =\n\t\t\t\t\t\t\t\t\t\tstore.gameW.game.gods[God.mesopotamian];\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tm &&\n\t\t\t\t\t\t\t\t\t\tgod.source !== God.mesopotamian &&\n\t\t\t\t\t\t\t\t\t\tbank.gods[m[0]].name === \"enki\"\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\tdelete store.gameW.game.enki;\n\t\t\t\t\t\t\t\t\tgod.f();\n\t\t\t\t\t\t\t\t\tutils.endCommercial(`built ${god.name}`);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\t\t\t\ttitle={JSON.stringify(obj.god, null, 2)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{obj.god.name}\n\t\t\t\t\t\t\t\t{obj.god.name === \"enki\" &&\n\t\t\t\t\t\t\t\t\t` - ${store.gameW.game\n\t\t\t\t\t\t\t\t\t\t.enki!.map((token) =>\n\t\t\t\t\t\t\t\t\t\t\tutils.enumName(token, ScienceToken)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t.join(\" \")}`}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Gate;\n","import React from \"react\";\n\nimport { CommercialEnum, Color } from \"../../utils/types\";\nimport { store } from \"../../utils/utils\";\n\nimport Isis from \"./Isis\";\nimport ChooseWonder from \"./ChooseWonder\";\nimport DestroyCard from \"./DestroyCard\";\nimport Revive from \"./Revive\";\nimport Library from \"./Library\";\nimport DestroyWonder from \"./DestroyWonder\";\nimport PickGod from \"./PickGod\";\nimport Anubis from \"./Anubis\";\nimport Ra from \"./Ra\";\nimport Nisaba from \"./Nisaba\";\nimport Enki from \"./Enki\";\nimport Baal from \"./Baal\";\nimport Theater from \"./Theater\";\nimport Gate from \"./Gate\";\n\nclass Commercial extends React.Component<{\n\tselectedPantheon?: number;\n\treset: () => void;\n}> {\n\trender(): any {\n\t\tswitch (store.gameW.game.commercials![0].commercial) {\n\t\t\tcase CommercialEnum.chooseWonder:\n\t\t\t\treturn <ChooseWonder />;\n\t\t\tcase CommercialEnum.destroyGrey:\n\t\t\t\treturn <DestroyCard color={Color.grey} />;\n\t\t\tcase CommercialEnum.destroyBrown:\n\t\t\t\treturn <DestroyCard color={Color.brown} />;\n\t\t\tcase CommercialEnum.revive:\n\t\t\t\treturn <Revive />;\n\t\t\tcase CommercialEnum.library:\n\t\t\t\treturn <Library />;\n\t\t\tcase CommercialEnum.destroyWonder:\n\t\t\t\treturn <DestroyWonder />;\n\t\t\tcase CommercialEnum.pickGod:\n\t\t\t\treturn (\n\t\t\t\t\t<PickGod\n\t\t\t\t\t\treset={this.props.reset}\n\t\t\t\t\t\tselectedPantheon={this.props.selectedPantheon}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\tcase CommercialEnum.anubis:\n\t\t\t\treturn <Anubis />;\n\t\t\tcase CommercialEnum.ra:\n\t\t\t\treturn <Ra />;\n\t\t\tcase CommercialEnum.isis:\n\t\t\t\treturn <Isis />;\n\t\t\tcase CommercialEnum.nisaba:\n\t\t\t\treturn <Nisaba />;\n\t\t\tcase CommercialEnum.enki:\n\t\t\t\treturn <Enki />;\n\t\t\tcase CommercialEnum.baal:\n\t\t\t\treturn <Baal />;\n\t\t\tcase CommercialEnum.theater:\n\t\t\t\treturn <Theater />;\n\t\t\tcase CommercialEnum.gate:\n\t\t\t\treturn <Gate />;\n\t\t}\n\t\treturn null;\n\t}\n}\n\nexport default Commercial;\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\nimport bank from \"../utils/bank\";\nimport { Age, God, ScienceToken } from \"../utils/types\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Pantheon extends React.Component<{\n\tselectPantheon: (index: number) => void;\n\tselectedPantheon?: number;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Pantheon</h2>\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t{store.gameW.game.pantheon.map(this.renderGod.bind(this))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderGod(godIndex: number, pantheonIndex: number) {\n\t\tconst cost =\n\t\t\t3 + (utils.myIndex() === 0 ? 5 - pantheonIndex : pantheonIndex);\n\t\tconst classes = [styles.bubble];\n\t\tif (pantheonIndex === this.props.selectedPantheon)\n\t\t\tclasses.push(styles.grey);\n\t\treturn (\n\t\t\t<div\n\t\t\t\tkey={pantheonIndex}\n\t\t\t\tclassName={classes.join(\" \")}\n\t\t\t\tonClick={() => this.props.selectPantheon(pantheonIndex)}\n\t\t\t>\n\t\t\t\t<div>{this.godContent(godIndex)}</div>\n\t\t\t\t<div>${cost}</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgodContent(godIndex: number) {\n\t\tif (godIndex === -1) return null;\n\t\tconst god = bank.gods[godIndex];\n\t\tif (store.gameW.game.age === Age.one) return God[god.source!];\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div>{god.name}</div>\n\t\t\t\t<div>{god.message}</div>\n\t\t\t\t{god.name === \"enki\" && (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{store.gameW.game.enki!.map((token) => (\n\t\t\t\t\t\t\t<span title={token} className={styles.bubble}>\n\t\t\t\t\t\t\t\t{utils.enumName(token, ScienceToken)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Pantheon;\n","import Shared from \"../../../../shared/shared\";\nimport store_, { StoreType } from \"../../../../shared/store\";\n\nimport { NUM_SCIENCES } from \"../main/Science\";\nimport { SelectedEnum } from \"../main/Main\";\nimport bank from \"./bank\";\nimport {\n\tGameType,\n\tPlayerType,\n\tAge,\n\tResource,\n\tCardType,\n\tScienceToken,\n\tColor,\n\tWonderType,\n\tCommercialType,\n\tScienceEnum,\n\tCommercialEnum,\n} from \"./types\";\n\nconst BASE_COST = 2;\nconst CARDS_PER_AGE = 20;\nconst NUM_PURPLES = 3;\nconst SCIENCE_TO_WIN = 6;\nconst BASE_TRASH = 2;\n\nclass Utils extends Shared<GameType, PlayerType> {\n\ttokenToPoints: {\n\t\t[token in ScienceToken]?: (player: PlayerType) => number;\n\t} = {\n\t\t[ScienceToken.agriculture]: () => 4,\n\t\t[ScienceToken.mathematics]: (player: PlayerType) =>\n\t\t\t3 * (player.scienceTokens || []).length,\n\t\t[ScienceToken.mysticism]: (player: PlayerType) =>\n\t\t\t2 * (player.tokens || []).length,\n\t\t[ScienceToken.philosophy]: () => 7,\n\t};\n\n\tgetMilitaryPoints(militaryDiff: number): number {\n\t\tif (militaryDiff <= 0) return 0;\n\t\tif (militaryDiff <= 2) return 2;\n\t\tif (militaryDiff <= 5) return 5;\n\t\treturn 10;\n\t}\n\n\tcurrentIndex(game_: GameType | undefined = undefined): number {\n\t\tconst game: GameType = game_ || store.gameW.game!;\n\t\tif (game && game.commercials) return game.commercials[0].playerIndex;\n\t\treturn super.currentIndex(game_);\n\t}\n\n\tendCommercial(message: string) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tstore.gameW.game.commercials!.shift();\n\t\tstore.update(message);\n\t}\n\n\tgetOpponent(game_: GameType | undefined = undefined) {\n\t\treturn this.getPlayer(1 - this.myIndex(game_));\n\t}\n\n\tdeal(game: GameType) {\n\t\tconst indices = utils.shuffle(\n\t\t\tbank.cards\n\t\t\t\t.map((card, index) => ({ card, index }))\n\t\t\t\t.filter((ic) => ic.card.age === game.age)\n\t\t\t\t.map((ic) => ic.index)\n\t\t);\n\t\tconst cardsToUse = indices.splice(0, CARDS_PER_AGE);\n\t\tif (game.age === Age.two && game.params.godExpansion)\n\t\t\tutils.assignGate(game);\n\t\tif (game.age === Age.three) {\n\t\t\tcardsToUse.splice(0, 3);\n\t\t\tconst matchAge = game.params.godExpansion ? Age.temple : Age.guild;\n\t\t\tconst purples = bank.cards\n\t\t\t\t.map((card, index) => ({ card, index }))\n\t\t\t\t.filter((ic) => ic.card.age === matchAge)\n\t\t\t\t.map((ic) => ic.index);\n\t\t\tcardsToUse.push(...purples.splice(0, NUM_PURPLES));\n\t\t\tutils.shuffle(cardsToUse);\n\t\t}\n\t\tgame.structure = bank.structure[game.age]!.map(\n\t\t\t(mapRow: number[], rowIndex: number) =>\n\t\t\t\tmapRow.map((offset) => ({\n\t\t\t\t\toffset,\n\t\t\t\t\tcardIndex: cardsToUse.pop()!,\n\t\t\t\t\trevealed: rowIndex % 2 === 0,\n\t\t\t\t\ttaken: false,\n\t\t\t\t}))\n\t\t);\n\t\tvar wentFirst;\n\t\tconst me = utils.getMe();\n\t\tconst militaryDiff = utils.getMilitary(me);\n\t\tif (militaryDiff > 0) {\n\t\t\twentFirst = utils.getOpponent().index;\n\t\t} else if (militaryDiff < 0) {\n\t\t\twentFirst = me.index;\n\t\t} else {\n\t\t\twentFirst = 1 - game.wentFirst;\n\t\t}\n\t\tgame.currentPlayer = game.wentFirst = wentFirst;\n\t}\n\n\tassignGate(game: GameType) {\n\t\tfor (let index = 0; index < game.pantheon.length; index++) {\n\t\t\tif (game.pantheon[index] === -1) {\n\t\t\t\tgame.pantheon[index] = bank.gods\n\t\t\t\t\t.map((god, godIndex) => ({ god, godIndex }))\n\t\t\t\t\t.find((obj) => obj.god.source === undefined)!.godIndex;\n\t\t\t} else if (bank.gods[game.pantheon[index]]?.name === \"enki\") {\n\t\t\t\tutils.assignEnki();\n\t\t\t}\n\t\t}\n\t}\n\n\tassignEnki() {\n\t\tstore.gameW.game.enki = utils\n\t\t\t.shuffle(\n\t\t\t\tstore.gameW.game.sciences\n\t\t\t\t\t.slice(NUM_SCIENCES)\n\t\t\t\t\t.filter((obj) => !obj.taken)\n\t\t\t)\n\t\t\t.slice(0, 2)\n\t\t\t.map((obj) => obj.token);\n\t}\n\n\tgetCostCost(rawCosts: Resource[], player: PlayerType): number {\n\t\tconst cards = player.cards || [];\n\t\tconst costs = utils.countResources(rawCosts);\n\t\tconst myResources = utils.countResources(\n\t\t\tcards.flatMap(\n\t\t\t\t(cardIndex) => bank.cards[cardIndex].extra.resource || []\n\t\t\t)\n\t\t);\n\t\tconst oppResources = utils.countResources(\n\t\t\t(utils.getPlayer(1 - player.index).cards || []).flatMap(\n\t\t\t\t(cardIndex) => bank.cards[cardIndex].extra.resource || []\n\t\t\t)\n\t\t);\n\t\tconst discounts = cards.flatMap(\n\t\t\t(cardIndex) => bank.cards[cardIndex].extra.discount || []\n\t\t);\n\n\t\tvar price = costs[Resource.money] || 0;\n\t\tdelete costs[Resource.money];\n\n\t\tconst paid: {\n\t\t\t[r in Resource]?: { pricePer: number; needed: number };\n\t\t} = {};\n\t\tObject.keys(costs).forEach((r) => {\n\t\t\tconst resource: Resource = r as Resource;\n\t\t\tconst needed = costs[resource]! - (myResources[resource] || 0);\n\t\t\tif (needed <= 0) return;\n\t\t\tconst pricePer = discounts.includes(resource)\n\t\t\t\t? 1\n\t\t\t\t: BASE_COST + (oppResources[resource] || 0);\n\t\t\tpaid[resource] = { pricePer, needed };\n\t\t\tprice += needed * pricePer;\n\t\t});\n\n\t\tcards\n\t\t\t.map((cardIndex) => bank.cards[cardIndex].extra.resourceOptions)\n\t\t\t.concat(this.getWonderOptions(player))\n\t\t\t.filter(Boolean)\n\t\t\t.forEach((options) => {\n\t\t\t\tvar pricePer = 0;\n\t\t\t\tvar resource: Resource | null = null;\n\t\t\t\tObject.entries(paid).forEach(([r_, o]) => {\n\t\t\t\t\tconst r: Resource = r_ as Resource;\n\t\t\t\t\tif (o!.needed === 0 || !options?.includes(r)) return;\n\t\t\t\t\tif (o!.pricePer > pricePer) {\n\t\t\t\t\t\tpricePer = o!.pricePer;\n\t\t\t\t\t\tresource = r;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (resource === null) return;\n\t\t\t\tconst picked: { pricePer: number; needed: number } =\n\t\t\t\t\tpaid[resource];\n\t\t\t\tpicked.needed--;\n\t\t\t\tprice -= pricePer;\n\t\t\t});\n\t\treturn price;\n\t}\n\n\tgetWonderOptions(player: PlayerType): Resource[][] {\n\t\treturn (player.wonders || [])\n\t\t\t.filter((wonder) => wonder.built)\n\t\t\t.map((wonder) => bank.wonders[wonder.wonderIndex])\n\t\t\t.map((wonder) => wonder.resourceOptions)\n\t\t\t.filter(Boolean) as Resource[][];\n\t}\n\n\tgetCardCost(card: CardType, player: PlayerType): number {\n\t\tif (\n\t\t\t(player.cards || []).find(\n\t\t\t\t(cardIndex) =>\n\t\t\t\t\tcard.upgradesFrom !== undefined &&\n\t\t\t\t\tbank.cards[cardIndex].upgradesTo === card.upgradesFrom\n\t\t\t)\n\t\t)\n\t\t\treturn 0;\n\t\tif (\n\t\t\t(player.scienceTokens || []).includes(ScienceToken.masonry) &&\n\t\t\tcard.color === Color.blue\n\t\t)\n\t\t\treturn 0;\n\t\tif (\n\t\t\tcard.age === Age.temple &&\n\t\t\t(player.tokens || []).find(\n\t\t\t\t(token) => token.isGod && token.value === card.extra!.godUpgrade\n\t\t\t)\n\t\t)\n\t\t\treturn 0;\n\t\tconst price = utils.getCostCost(card.cost, player);\n\t\tif (\n\t\t\tcard.upgradesFrom !== undefined &&\n\t\t\t(player.scienceTokens || []).includes(ScienceToken.engineering) &&\n\t\t\tprice > 0\n\t\t)\n\t\t\treturn 1;\n\t\treturn price;\n\t}\n\n\tcountResources(pool: Resource[]): { [r in Resource]?: number } {\n\t\tconst resources: { [r in Resource]?: number } = {};\n\t\tpool.forEach((resource) => {\n\t\t\tresources[resource] = (resources[resource] || 0) + 1;\n\t\t});\n\t\treturn resources;\n\t}\n\n\tgetMilitary(player: PlayerType) {\n\t\tconst militaryDiff = store.gameW.game.military;\n\t\treturn player.index === 0 ? militaryDiff : -militaryDiff;\n\t}\n\n\tgetScore(player: PlayerType): number {\n\t\tconst cardPoints = (player.cards || [])\n\t\t\t.map((cardIndex) => bank.cards[cardIndex].extra.points || 0)\n\t\t\t.reduce((a, b) => a + b, 0);\n\t\tconst moneyPoints = Math.floor(player.money / 3);\n\t\tconst guildPoints = (player.cards || [])\n\t\t\t.map((cardIndex) => bank.cards[cardIndex].extra.guild)\n\t\t\t.filter(Boolean)\n\t\t\t.map((g) => Math.max(...store.gameW.game.players.map(g!)))\n\t\t\t.reduce((a, b) => a + b, 0);\n\t\tconst militaryPoints = utils.getMilitaryPoints(\n\t\t\tutils.getMilitary(player)\n\t\t);\n\t\tconst sciencePoints = (player.scienceTokens || [])\n\t\t\t.map((token) => utils.tokenToPoints[token])\n\t\t\t.filter(Boolean)\n\t\t\t.map((f) => f!(player))\n\t\t\t.reduce((a: number, b: number) => a + b, 0)!;\n\t\tconst wonderPoints = (player.wonders || [])\n\t\t\t.filter((wonder) => wonder.built)\n\t\t\t.map((wonder) => bank.wonders[wonder.wonderIndex].points || 0)\n\t\t\t.reduce((a, b) => a + b, 0);\n\t\tconst godPoints = (player.gods || [])\n\t\t\t.map((godIndex) => bank.gods[godIndex])\n\t\t\t.filter((god) => god.points)\n\t\t\t.map((god) => god.points!())\n\t\t\t.reduce((a, b) => a + b, 0);\n\t\tconst numTemples = (player.cards || []).filter(\n\t\t\t(cardIndex) => bank.cards[cardIndex].age === Age.temple\n\t\t).length;\n\t\tconst templePoints =\n\t\t\tnumTemples === 0\n\t\t\t\t? 0\n\t\t\t\t: numTemples === 1\n\t\t\t\t? 5\n\t\t\t\t: numTemples === 2\n\t\t\t\t? 12\n\t\t\t\t: 21;\n\t\treturn (\n\t\t\tcardPoints +\n\t\t\tmoneyPoints +\n\t\t\tguildPoints +\n\t\t\tmilitaryPoints +\n\t\t\tsciencePoints +\n\t\t\twonderPoints +\n\t\t\tgodPoints +\n\t\t\ttemplePoints\n\t\t);\n\t}\n\n\tstealMoney(amount: number) {\n\t\tutils.getOpponent().money = Math.max(\n\t\t\t0,\n\t\t\tutils.getOpponent().money - amount\n\t\t);\n\t}\n\n\tgetWonderCost(wonder: WonderType, player: PlayerType): number {\n\t\tif ((player.scienceTokens || []).includes(ScienceToken.architecture))\n\t\t\treturn 0;\n\t\treturn utils.getCostCost(wonder.cost, player);\n\t}\n\n\tincreaseMilitary(military: number) {\n\t\tconst me = utils.getMe();\n\t\tconst sciences = me.scienceTokens || [];\n\t\tif (sciences.includes(ScienceToken.polioretics))\n\t\t\tutils.stealMoney(military);\n\n\t\tconst direction = utils.myIndex() === 0 ? 1 : -1;\n\t\tconst game = store.gameW.game;\n\t\tfor (let i = 0; i < military; i++) {\n\t\t\tgame.military += direction;\n\t\t\tif (game.military === game.minerva) {\n\t\t\t\tgame.military -= direction;\n\t\t\t\tdelete game.minerva;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst diff = Math.abs(game.military);\n\t\t\tconst bonus = me.militaryBonuses[diff];\n\t\t\tif (bonus !== undefined) {\n\t\t\t\tif (bonus === 0) {\n\t\t\t\t\tstore.gameW.info.alert = `${me.userName} wins`;\n\t\t\t\t} else {\n\t\t\t\t\tdelete me.militaryBonuses[diff];\n\t\t\t\t}\n\t\t\t\tutils.stealMoney(bonus);\n\t\t\t}\n\t\t}\n\t}\n\n\taddCommercial(commercial: CommercialType) {\n\t\tif (!store.gameW.game.commercials) store.gameW.game.commercials = [];\n\t\tstore.gameW.game.commercials.push(commercial);\n\t}\n\n\tenumName<T>(val: string, e: T): keyof T {\n\t\treturn Object.entries(e).find(([k, v]) => v === val)![0] as keyof T;\n\t}\n\n\tgainScience(science: ScienceEnum) {\n\t\tconst me = utils.getMe();\n\t\tif (!me.scienceIcons) me.scienceIcons = {};\n\t\tif (!me.scienceIcons[science]) me.scienceIcons[science] = 0;\n\t\tif (++me.scienceIcons[science]! === 2) {\n\t\t\tif (!store.gameW.game.commercials)\n\t\t\t\tstore.gameW.game.commercials = [];\n\t\t\tstore.gameW.game.commercials.push({\n\t\t\t\tcommercial: CommercialEnum.science,\n\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t});\n\t\t} else if (Object.keys(me.scienceIcons).length === SCIENCE_TO_WIN) {\n\t\t\tstore.gameW.info.alert = `${me.userName} wins`;\n\t\t}\n\t}\n\n\tisMyCommercial(commercial: CommercialEnum): boolean {\n\t\tif (!store.gameW.game.commercials) return false;\n\t\treturn (\n\t\t\tutils.isMyTurn() &&\n\t\t\tstore.gameW.game.commercials[0]?.commercial === commercial\n\t\t);\n\t}\n\n\tbuyGod(\n\t\tselectedPantheon: number,\n\t\tusedTokens: { [tokenIndex: number]: boolean } | undefined\n\t) {\n\t\tconst godIndex = store.gameW.game.pantheon[selectedPantheon];\n\t\tconst god = bank.gods[godIndex];\n\t\tconst me = utils.getMe();\n\t\tvar cost =\n\t\t\t3 +\n\t\t\t(utils.myIndex() === 0 ? 5 - selectedPantheon : selectedPantheon);\n\t\tif (god.source === undefined) cost *= 2;\n\t\tif (\n\t\t\t(utils.getMe().wonders || []).find(\n\t\t\t\t(obj) =>\n\t\t\t\t\tobj.built &&\n\t\t\t\t\tbank.wonders[obj.wonderIndex].name === \"the sanctuary\"\n\t\t\t)\n\t\t)\n\t\t\tcost -= 2;\n\t\tObject.keys(usedTokens || {})\n\t\t\t.map((i) => parseInt(i))\n\t\t\t.sort((a, b) => b - a)\n\t\t\t.map((index) => me.tokens!.splice(index, 1)[0].value)\n\t\t\t.forEach((discount) => {\n\t\t\t\tcost = Math.max(0, cost - discount);\n\t\t\t});\n\t\tif (me.money < cost) return alert(\"cannot afford\");\n\t\tme.money -= cost;\n\t\tif (!me.gods) me.gods = [];\n\t\tme.gods.push(godIndex);\n\t\tgod.f();\n\t\tstore.gameW.game.pantheon[selectedPantheon] = -1;\n\t\tutils.incrementPlayerTurn();\n\t\tstore.update(`purchased ${god.name}`);\n\t}\n\n\ttakeToken(row: number, col: number) {\n\t\tconst game = store.gameW.game;\n\t\tconst me = utils.getMe();\n\t\tif (!me.tokens) me.tokens = [];\n\t\tif (game.age === Age.one) {\n\t\t\tif (col % 2 === 0) {\n\t\t\t\tutils.addCommercial({\n\t\t\t\t\tcommercial: CommercialEnum.pickGod,\n\t\t\t\t\tplayerIndex: utils.myIndex(),\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (game.age === Age.two) {\n\t\t\tif (col % 2 === 0 && row === 1) {\n\t\t\t\tme.tokens.push({ isGod: false, value: game.discounts.pop()! });\n\t\t\t}\n\t\t}\n\t}\n\n\tcanTakeCard(y: number, x: number, offset: number): boolean {\n\t\tconst rowBelow = store.gameW.game.structure[y + 1];\n\t\tif (!rowBelow) return true;\n\t\tconst gridX = x * 2 + offset;\n\t\tconst cardsBelow = rowBelow.filter(\n\t\t\t(card, index) =>\n\t\t\t\t!card.taken && Math.abs(card.offset + index * 2 - gridX) === 1\n\t\t);\n\t\treturn cardsBelow.length === 0;\n\t}\n\n\thandleCardGain(card: CardType, isPurchase: boolean) {\n\t\tconst me = utils.getMe();\n\t\tif (card.extra.f) card.extra.f();\n\t\tconst sciences = me.scienceTokens || [];\n\t\tif (\n\t\t\tisPurchase &&\n\t\t\tcard.upgradesFrom !== undefined &&\n\t\t\t(me.scienceTokens || []).includes(ScienceToken.urbanism)\n\t\t) {\n\t\t\tif (\n\t\t\t\tme.cards!.filter(\n\t\t\t\t\t(cardIndex) =>\n\t\t\t\t\t\tbank.cards[cardIndex].upgradesTo === card.upgradesFrom\n\t\t\t\t).length\n\t\t\t)\n\t\t\t\tme.money += 4;\n\t\t}\n\t\tif (card.extra.military) {\n\t\t\tvar military = card.extra.military;\n\t\t\tif (sciences.includes(ScienceToken.strategy)) military++;\n\t\t\tutils.increaseMilitary(military);\n\t\t}\n\t\tif (card.extra.science !== undefined) {\n\t\t\tutils.gainScience(card.extra.science);\n\t\t}\n\t}\n\n\tselectCard(\n\t\tx: number,\n\t\ty: number,\n\t\tselectedTarget: SelectedEnum | undefined\n\t): string | void {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst commercial = (store.gameW.game.commercials || [])[0]?.commercial;\n\t\tconst structureCard = store.gameW.game.structure[y][x];\n\t\tif (commercial === CommercialEnum.zeus) {\n\t\t\tstructureCard.taken = true;\n\t\t\tif (!store.gameW.game.trash) store.gameW.game.trash = [];\n\t\t\tstore.gameW.game.trash.push(structureCard.cardIndex);\n\t\t\tutils.endCommercial(\"destroyed a card\");\n\t\t\treturn;\n\t\t}\n\t\tif (commercial) return alert(commercial);\n\t\tif (selectedTarget === undefined)\n\t\t\treturn alert(\"need to select a target first\");\n\t\tif (!utils.canTakeCard(y, x, structureCard.offset))\n\t\t\treturn alert(\"cannot take that card\");\n\t\tconst card = bank.cards[structureCard.cardIndex];\n\t\tif (selectedTarget === SelectedEnum.build) {\n\t\t\tconst cost = utils.getCardCost(card, utils.getMe());\n\t\t\tif (cost > utils.getMe().money)\n\t\t\t\treturn alert(\"cannot afford that card\");\n\t\t\tutils.getMe().money -= cost;\n\t\t\tif (\n\t\t\t\t(utils.getOpponent().scienceTokens || []).includes(\n\t\t\t\t\tScienceToken.economy\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tif (\n\t\t\t\t\t!(\n\t\t\t\t\t\t(utils.getMe().scienceTokens || []).includes(\n\t\t\t\t\t\t\tScienceToken.urbanism\n\t\t\t\t\t\t) && card.upgradesFrom !== undefined\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tconst resourceCost = Math.max(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tcost -\n\t\t\t\t\t\t\tcard.cost.filter((c) => c === Resource.money).length\n\t\t\t\t\t);\n\t\t\t\t\tutils.getOpponent().money += resourceCost;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (selectedTarget >= 0) {\n\t\t\tconst cost = utils.getWonderCost(\n\t\t\t\tbank.wonders[\n\t\t\t\t\tutils.getMe().wonders[selectedTarget!].wonderIndex\n\t\t\t\t],\n\t\t\t\tutils.getMe()\n\t\t\t);\n\t\t\tif (cost > utils.getMe().money)\n\t\t\t\treturn alert(\"cannot afford that wonder\");\n\t\t\tutils.getMe().money -= cost;\n\t\t\tif (\n\t\t\t\t(utils.getOpponent().scienceTokens || []).includes(\n\t\t\t\t\tScienceToken.economy\n\t\t\t\t)\n\t\t\t)\n\t\t\t\tutils.getOpponent().money += cost;\n\t\t}\n\t\tstructureCard.taken = true;\n\t\tconst rowAboveY = y - 1;\n\t\tconst rowAbove = store.gameW.game.structure[rowAboveY];\n\t\tif (rowAbove)\n\t\t\trowAbove.forEach((aboveCard, index) => {\n\t\t\t\tif (\n\t\t\t\t\t!aboveCard.revealed &&\n\t\t\t\t\tutils.canTakeCard(rowAboveY, index, aboveCard.offset)\n\t\t\t\t) {\n\t\t\t\t\tif (store.gameW.game.params.godExpansion)\n\t\t\t\t\t\tutils.takeToken(rowAboveY, index);\n\t\t\t\t\taboveCard.revealed = true;\n\t\t\t\t}\n\t\t\t});\n\t\tconst me = utils.getMe();\n\t\tvar message;\n\t\tif (selectedTarget === SelectedEnum.trash) {\n\t\t\tmessage = `trashed ${card.name}`;\n\t\t\tif (!store.gameW.game.trash) store.gameW.game.trash = [];\n\t\t\tstore.gameW.game.trash.push(structureCard.cardIndex);\n\t\t\tme.money +=\n\t\t\t\tBASE_TRASH +\n\t\t\t\t(me.cards || [])\n\t\t\t\t\t.map((cardIndex) => bank.cards[cardIndex])\n\t\t\t\t\t.filter((card) => card.color === Color.yellow).length;\n\t\t} else if (selectedTarget === SelectedEnum.build) {\n\t\t\tmessage = `built ${card.name}`;\n\t\t\tif (!me.cards) me.cards = [];\n\t\t\tme.cards.push(structureCard.cardIndex);\n\t\t\tutils.handleCardGain(card, true);\n\t\t} else {\n\t\t\tconst w = utils.getMe().wonders[selectedTarget!];\n\t\t\tw.built = true;\n\t\t\tconst wonder = bank.wonders[w.wonderIndex];\n\t\t\twonder.f();\n\t\t\tif (\n\t\t\t\twonder.goAgain ||\n\t\t\t\t(me.scienceTokens || []).includes(ScienceToken.theology)\n\t\t\t)\n\t\t\t\tutils.incrementPlayerTurn();\n\t\t\tmessage = `built ${wonder.name} using ${card.name}`;\n\t\t\tif (\n\t\t\t\tutils.getMe().wonders.filter((wonder) => !wonder.built).length +\n\t\t\t\t\tutils\n\t\t\t\t\t\t.getOpponent()\n\t\t\t\t\t\t.wonders.filter((wonder) => !wonder.built).length ===\n\t\t\t\t1\n\t\t\t) {\n\t\t\t\tvar index;\n\t\t\t\tif (\n\t\t\t\t\tutils.getMe().wonders.filter((wonder) => !wonder.built)\n\t\t\t\t\t\t.length\n\t\t\t\t) {\n\t\t\t\t\tindex = me.index;\n\t\t\t\t} else {\n\t\t\t\t\tindex = 1 - me.index;\n\t\t\t\t}\n\t\t\t\tutils.addCommercial({\n\t\t\t\t\tcommercial: CommercialEnum.destroyWonder,\n\t\t\t\t\tplayerIndex: index,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tutils.incrementPlayerTurn();\n\t\tif (\n\t\t\t!store.gameW.game.structure.flat().filter((sc) => !sc.taken).length\n\t\t) {\n\t\t\tswitch (store.gameW.game.age) {\n\t\t\t\tcase Age.one:\n\t\t\t\t\tstore.gameW.game.age = Age.two;\n\t\t\t\t\tutils.deal(store.gameW.game);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Age.two:\n\t\t\t\t\tstore.gameW.game.age = Age.three;\n\t\t\t\t\tutils.deal(store.gameW.game);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Age.three:\n\t\t\t\t\tstore.gameW.info.alert = \"game over\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn message;\n\t}\n\n\tbuildScienceToken(scienceName: ScienceToken) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst me = utils.getMe();\n\t\tif (!me.scienceTokens) me.scienceTokens = [];\n\t\tme.scienceTokens.push(scienceName);\n\t\tstore.gameW.game.sciences.find(\n\t\t\t(obj) => obj.token === scienceName\n\t\t)!.taken = true;\n\t\tswitch (scienceName) {\n\t\t\tcase ScienceToken.agriculture:\n\t\t\tcase ScienceToken.urbanism:\n\t\t\t\tutils.getMe().money += 6;\n\t\t\t\treturn;\n\t\t\tcase ScienceToken.law:\n\t\t\t\tutils.gainScience(ScienceEnum.law);\n\t\t\t\treturn;\n\t\t}\n\t\tutils.endCommercial(\n\t\t\t`built ${utils.enumName(scienceName, ScienceToken)}`\n\t\t);\n\t}\n}\n\nexport const store: StoreType<GameType> = store_;\nconst utils = new Utils();\nexport default utils;\n","import utils, { store } from \"./utils\";\nimport { Params, GameType, ScienceToken, CommercialEnum, God } from \"./types\";\nimport bank from \"./bank\";\n\nconst NUM_WONDERS = 8;\n\nfunction NewGame(params: Params): PromiseLike<GameType> {\n\t// @ts-ignore game being constructed\n\tconst game: GameType = {};\n\tgame.params = params;\n\treturn Promise.resolve(game)\n\t\t.then(setBoard)\n\t\t.then(setPlayers)\n\t\t.then(prepareToChooseWonders)\n\t\t.then(maybePrepareExpansion);\n}\n\nfunction setBoard(game: GameType): GameType {\n\tgame.military = 0;\n\tgame.trash = [];\n\tgame.sciences = utils\n\t\t.shuffle(Object.values(ScienceToken))\n\t\t.filter(\n\t\t\t(token) =>\n\t\t\t\tgame.params.godExpansion ||\n\t\t\t\t(token !== ScienceToken.mysticism &&\n\t\t\t\t\ttoken !== ScienceToken.polioretics &&\n\t\t\t\t\ttoken !== ScienceToken.engineering)\n\t\t)\n\t\t.map((token) => ({ token }));\n\treturn game;\n}\n\nfunction setPlayers(game: GameType): GameType {\n\tgame.players = Object.entries(store.lobby)\n\t\t.sort((a, b) => (b[0] === store.me.userId ? 1 : -1))\n\t\t.map(([userId, userName], index) => ({\n\t\t\tuserId,\n\t\t\tuserName,\n\t\t\twonders: [],\n\t\t\tmoney: 7,\n\t\t\tmilitary: 0,\n\t\t\tindex,\n\t\t\tmilitaryBonuses: { 3: 2, 6: 5, 9: 0 },\n\t\t}));\n\tif (game.players.length !== 2) throw new Error(\"need 2 players\");\n\tgame.wentFirst = 1 - utils.myIndex(game);\n\treturn game;\n}\n\nfunction prepareToChooseWonders(game: GameType): GameType {\n\tgame.commercials = [\n\t\t{\n\t\t\tcommercial: CommercialEnum.chooseWonder,\n\t\t\tplayerIndex: utils.myIndex(game),\n\t\t},\n\t];\n\tgame.wondersToChoose = utils\n\t\t.shuffle(\n\t\t\tbank.wonders\n\t\t\t\t.map((wonder, index) => ({ wonder, index }))\n\t\t\t\t.filter(\n\t\t\t\t\t(obj) => game.params.godExpansion || !obj.wonder.expansion\n\t\t\t\t)\n\t\t\t\t.map((obj) => obj.index)\n\t\t)\n\t\t.slice(0, NUM_WONDERS);\n\treturn game;\n}\n\nfunction maybePrepareExpansion(game: GameType): GameType {\n\tif (game.params.godExpansion) {\n\t\tgame.discounts = utils.shuffle([2, 3, 4]);\n\t\tgame.godTokens = utils.shuffle(\n\t\t\tObject.keys(God)\n\t\t\t\t.concat(Object.keys(God))\n\t\t\t\t.map((i) => parseInt(i))\n\t\t\t\t.filter((i) => !isNaN(i))\n\t\t);\n\t\tconst gods: { [g in God]?: number[] } = {};\n\t\tObject.values(God).forEach(\n\t\t\t(god: string | God) =>\n\t\t\t\t(gods[god as God] = bank.gods\n\t\t\t\t\t.map((g, index) => ({ g, index }))\n\t\t\t\t\t.filter((obj) => obj.g.source === god)\n\t\t\t\t\t.map((obj) => obj.index))\n\t\t);\n\t\tgame.gods = gods as { [g in God]: number[] };\n\t\tgame.pantheon = Array.from(new Array(6)).map(() => -1);\n\t}\n\treturn game;\n}\n\nexport default NewGame;\n","import { LobbyType } from \"../../../../shared/store\";\n\nimport utils, { store } from \"./utils\";\n\nexport type GameType = {\n\tparams: Params;\n\tcurrentPlayer: number;\n\tplayers: PlayerType[];\n\tdeck: Card[];\n\tplayed?: Card;\n\taside: Card;\n\ttwo_p_aside?: Card[];\n\tjester?: number;\n\tcardinal?: { p1: number; p2: number };\n\tsycophant?: number;\n\tbishop?: number;\n\ttiedPlayers?: number[];\n};\n\nexport type Params = {\n\tlobby: LobbyType;\n};\n\nexport type PlayerType = {\n\tuserId: string;\n\tuserName: string;\n\thand?: Card[];\n\tplayed?: Card[];\n\tscore: number;\n};\n\nexport enum Card {\n\tguard,\n\tpriest,\n\tbaron,\n\thandmaid,\n\tprince,\n\tking,\n\tcountess,\n\tprincess,\n\n\tbishop,\n\tqueen,\n\tconstable,\n\tcount,\n\tsycophant,\n\tbaroness,\n\tcardinal,\n\tguardX,\n\tjester,\n\tassassin,\n}\n\nexport const COUNTS = {\n\t[Card.guard]: 5,\n\t[Card.priest]: 2,\n\t[Card.baron]: 2,\n\t[Card.handmaid]: 2,\n\t[Card.prince]: 2,\n\t[Card.king]: 1,\n\t[Card.countess]: 1,\n\t[Card.princess]: 1,\n\n\t[Card.bishop]: -1,\n\t[Card.queen]: -1,\n\t[Card.constable]: -1,\n\t[Card.count]: -2,\n\t[Card.sycophant]: -2,\n\t[Card.baroness]: -2,\n\t[Card.cardinal]: -2,\n\t[Card.guardX]: -3,\n\t[Card.jester]: -1,\n\t[Card.assassin]: -1,\n};\n\nexport const Ranks = {\n\t[Card.guard]: 1,\n\t[Card.priest]: 2,\n\t[Card.baron]: 3,\n\t[Card.handmaid]: 4,\n\t[Card.prince]: 5,\n\t[Card.king]: 6,\n\t[Card.countess]: 7,\n\t[Card.princess]: 8,\n\n\t[Card.bishop]: 9,\n\t[Card.queen]: 7,\n\t[Card.constable]: 6,\n\t[Card.count]: 5,\n\t[Card.sycophant]: 4,\n\t[Card.baroness]: 3,\n\t[Card.cardinal]: 2,\n\t[Card.guardX]: 1,\n\t[Card.jester]: 0,\n\t[Card.assassin]: 0,\n};\n\nfunction NewGame(params: Params): PromiseLike<GameType> {\n\t// @ts-ignore game being constructed\n\tconst game: GameType = {};\n\tgame.params = params;\n\treturn Promise.resolve(game).then(setPlayers).then(deal);\n}\n\nfunction setPlayers(game: GameType): GameType {\n\tgame.players = Object.entries(store.lobby)\n\t\t.sort((a, b) => (b[0] === store.me.userId ? 1 : -1))\n\t\t.map(([userId, userName]) => ({\n\t\t\tuserId,\n\t\t\tuserName,\n\t\t\tscore: 0,\n\t\t}));\n\tif (game.players.length < 2 || game.players.length > 8)\n\t\tthrow new Error(\"need 2-8 players\");\n\tgame.currentPlayer = utils.myIndex(game);\n\treturn game;\n}\n\nexport function deal(game: GameType): GameType {\n\tgame.deck = [];\n\tObject.entries(COUNTS).forEach(([v, count]) => {\n\t\tif (count < 0) {\n\t\t\tif (game.players.length < 5) return;\n\t\t\tcount = -count;\n\t\t}\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tgame.deck.push(parseInt(v));\n\t\t}\n\t});\n\tgame.aside = utils.shuffle(game.deck).pop()!;\n\tgame.players.forEach((p) => {\n\t\tp.hand = [game.deck.pop()!];\n\t\tdelete p.played;\n\t});\n\tif (game.players.length === 2)\n\t\tgame.two_p_aside = Array.from(new Array(3)).map(() => game.deck.pop()!);\n\tutils.getCurrent(game).hand!.push(game.deck.pop()!);\n\treturn game;\n}\n\nexport default NewGame;\n","import React, { RefObject } from \"react\";\n\nimport SharedSidebar from \"../../../../shared/components/sidebar/SharedSidebar\";\nimport NewGame from \"../utils/NewGame\";\nimport { Params } from \"../utils/types\";\nimport utils, { store } from \"../utils/utils\";\n\nclass Sidebar extends SharedSidebar<Params> {\n\texpansionRef: RefObject<HTMLInputElement> = React.createRef();\n\tname = \"7 Wonders Duel\";\n\tNewGame = NewGame;\n\tisMyTurn = utils.isMyTurn.bind(utils);\n\n\trenderStartNewGame() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div>\n\t\t\t\t\t<label>\n\t\t\t\t\t\tGod Expansion:{\" \"}\n\t\t\t\t\t\t<input type={\"checkbox\"} ref={this.expansionRef} />\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<button onClick={this.startNewGame.bind(this)}>New Game</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetParams() {\n\t\treturn {\n\t\t\tgodExpansion: this.expansionRef.current!.checked,\n\t\t\tlobby: store.lobby,\n\t\t};\n\t}\n\n\tmaybeSyncParams() {\n\t\tsuper.maybeSyncParams();\n\t\tif (store.gameW.info.isNewGame) {\n\t\t\tthis.expansionRef.current!.checked =\n\t\t\t\tstore.gameW.game.params.godExpansion;\n\t\t}\n\t}\n}\n\nexport default Sidebar;\n","import React from \"react\";\n\nimport utils, { store } from \"./utils/utils\";\nimport Main from \"./main/Main\";\nimport Sidebar from \"./sidebar/Sidebar\";\n\nimport styles from \"../../../shared/styles.module.css\";\n\nclass _7wd extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={`${utils.isMyTurn() && styles.my_turn}`}>\n\t\t\t\t<div className={styles.main}>\n\t\t\t\t\t<Sidebar />\n\t\t\t\t\t<div className={styles.content}>\n\t\t\t\t\t\t<div>{store.gameW.game && <Main />}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default _7wd;\n","import Shared from \"../../../../shared/shared\";\nimport store_, { StoreType } from \"../../../../shared/store\";\n\nimport { GameType, PlayerType, Ranks, Card } from \"./NewGame\";\n\nexport const store: StoreType<GameType> = store_;\n\nexport const WINNER = -1;\n\nclass Utils extends Shared<GameType, PlayerType> {\n\tadvanceTurn() {\n\t\tdelete store.gameW.game.sycophant;\n\t\tconst card = (store.gameW.game.deck || []).pop();\n\t\tif (card !== undefined) {\n\t\t\tfor (let i = 1; i < store_.gameW.game.players.length; i++) {\n\t\t\t\tutils.incrementPlayerTurn();\n\t\t\t\tif (utils.getCurrent().hand) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tstore.gameW.game.players.filter((p) => p.hand).length >\n\t\t\t\t\t\t1\n\t\t\t\t\t) {\n\t\t\t\t\t\tutils.getCurrent().hand!.push(card);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstore.gameW.game.played = WINNER;\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tutils.setWinner();\n\t}\n\n\tsetWinner() {\n\t\tconst orderedPlayers = Array.from(store.gameW.game.players)\n\t\t\t.map((player, index) => ({\n\t\t\t\tplayer,\n\t\t\t\tindex,\n\t\t\t\tvalue: getValue(player),\n\t\t\t}))\n\t\t\t.sort((a, b) => b.value - a.value);\n\t\tif (\n\t\t\torderedPlayers[0].player.hand![0] === Card.bishop &&\n\t\t\torderedPlayers\n\t\t\t\t.map((o) => o.player.hand)\n\t\t\t\t.filter(Boolean)\n\t\t\t\t.find((h) => h![0] === Card.princess)\n\t\t)\n\t\t\torderedPlayers.shift();\n\t\tif (orderedPlayers[0].value === orderedPlayers[1]?.value) {\n\t\t\tstore.gameW.game.tiedPlayers = orderedPlayers\n\t\t\t\t.filter((o) => o.value === orderedPlayers[0].value)\n\t\t\t\t.map((o) => o.index);\n\t\t} else {\n\t\t\tstore.gameW.game.currentPlayer = orderedPlayers[0]!.index;\n\t\t}\n\t\tstore.gameW.game.played = WINNER;\n\t}\n\n\tcardString(card: Card): string {\n\t\treturn `${Card[card]} (${Ranks[card]})`;\n\t}\n\n\tdiscard(player: PlayerType, knockedOut: boolean) {\n\t\tconst card = player.hand![0];\n\t\tif (!player.played) player.played = [];\n\t\tif (knockedOut || card === Card.princess) {\n\t\t\tdelete player.hand;\n\t\t\tplayer.score += player.played.filter(\n\t\t\t\t(c) => c === Card.constable\n\t\t\t).length;\n\t\t} else {\n\t\t\tconst draw = store.gameW.game.deck\n\t\t\t\t? store.gameW.game.deck.pop()!\n\t\t\t\t: store.gameW.game.aside;\n\t\t\tplayer.hand = [draw];\n\t\t}\n\t\tplayer.played.unshift(card);\n\t}\n}\n\nfunction getValue(player: PlayerType): number {\n\tif (!player.hand) return -1;\n\treturn (\n\t\tRanks[player.hand[0]] +\n\t\t(player.played || []).filter((c) => c === Card.count).length +\n\t\t(player.played || []).map((c) => Ranks[c]).reduce((a, b) => a + b, 0) /\n\t\t\t1000\n\t);\n}\n\nconst utils = new Utils();\n\nexport default utils;\n","import React from \"react\";\n\nimport utils, { store, WINNER } from \"../utils/utils\";\nimport { Card, deal, Ranks } from \"../utils/NewGame\";\n\nimport Cardinal from \"./Cardinal\";\nimport Baroness from \"./Baroness\";\n\nimport Bishop from \"./Bishop\";\nimport BishopDiscard from \"./BishopDiscard\";\nimport Guard from \"./Guard\";\nimport Winner from \"./Winner\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport ActionComponent from \"./ActionComponent\";\n\nvar actioning = false;\n\nenum ComponentsE {\n\tbishop,\n\tbishopDiscard,\n\tguard,\n\twinner,\n}\n\nconst ComponentsM: { [c in ComponentsE]: typeof ActionComponent } = {\n\t[ComponentsE.bishop]: Bishop,\n\t[ComponentsE.bishopDiscard]: BishopDiscard,\n\t[ComponentsE.guard]: Guard,\n\t[ComponentsE.winner]: Winner,\n};\n\nclass Action extends React.Component<{}, { c?: ComponentsE; index?: number }> {\n\tconstructor(props: {}) {\n\t\tsuper(props);\n\t\tthis.state = {};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.action();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.action();\n\t}\n\n\taction() {\n\t\twindow.requestAnimationFrame(this.actionHelper.bind(this));\n\t}\n\n\tactionHelper() {\n\t\tif (\n\t\t\t!utils.isMyTurn() ||\n\t\t\tstore.gameW.game.played === undefined ||\n\t\t\tthis.state.c !== undefined ||\n\t\t\tactioning\n\t\t)\n\t\t\treturn;\n\t\tactioning = true;\n\t\tswitch (store.gameW.game.played) {\n\t\t\tcase WINNER:\n\t\t\t\tconst jester = store.gameW.game.jester;\n\t\t\t\tdelete store.gameW.game.jester;\n\t\t\t\tif (store.gameW.game.tiedPlayers) {\n\t\t\t\t\tconst tiedPlayers = store.gameW.game.tiedPlayers;\n\t\t\t\t\tdelete store.gameW.game.tiedPlayers;\n\t\t\t\t\tdeal(store.gameW.game);\n\t\t\t\t\tstore.update(\n\t\t\t\t\t\t`no one wins because of a tie between ${tiedPlayers\n\t\t\t\t\t\t\t.map((i) => store.gameW.game.players[i].userName)\n\t\t\t\t\t\t\t.join(\",\")}`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (jester === utils.myIndex()) {\n\t\t\t\t\tconst p = store.gameW.game.players.find(\n\t\t\t\t\t\t(p) => (p.played || []).indexOf(Card.jester) !== -1\n\t\t\t\t\t)!;\n\t\t\t\t\tp.score++;\n\t\t\t\t\tstore.update(`wins, [${p.userName}] scores a jester`);\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState({ c: ComponentsE.winner });\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase Card.cardinal:\n\t\t\t// @ts-ignore fallthrough\n\t\t\tcase Card.baroness:\n\t\t\t\tbreak;\n\t\t\tcase Card.bishop:\n\t\t\t\tif (store.gameW.game.bishop !== undefined) {\n\t\t\t\t\tthis.setState({ c: ComponentsE.bishopDiscard });\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t// @ts-ignore fallthrough\n\t\t\tdefault:\n\t\t\t\tconst targets = this.getTargets();\n\t\t\t\tif (targets.length === 0) {\n\t\t\t\t\tthis.finish(\"no targets\");\n\t\t\t\t} else if (targets.length === 1) {\n\t\t\t\t\tthis.execute(targets[0]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\tactioning = false;\n\t}\n\n\tgetTargets() {\n\t\treturn store.gameW.game.players\n\t\t\t.map((player, index) => ({ player, index }))\n\t\t\t.filter((o) => o.player.hand)\n\t\t\t.filter((o) => (o.player.played || [])[0] !== Card.handmaid)\n\t\t\t.filter(\n\t\t\t\t(o) =>\n\t\t\t\t\tstore.gameW.game.sycophant === undefined ||\n\t\t\t\t\to.index === store.gameW.game.sycophant ||\n\t\t\t\t\tstore.gameW.game.played === Card.cardinal ||\n\t\t\t\t\tstore.gameW.game.played === Card.baroness\n\t\t\t)\n\t\t\t.filter(\n\t\t\t\t(o) =>\n\t\t\t\t\tstore.gameW.game.played === Card.prince ||\n\t\t\t\t\tstore.gameW.game.played === Card.sycophant ||\n\t\t\t\t\tstore.gameW.game.played === Card.cardinal ||\n\t\t\t\t\to.player.userId !== utils.getCurrent().userId\n\t\t\t)\n\t\t\t.map((o) => o.index);\n\t}\n\n\texecute(index: number) {\n\t\tconst player = store.gameW.game.players[index];\n\t\tswitch (store.gameW.game.played) {\n\t\t\tcase Card.guardX:\n\t\t\t// @ts-ignore fallthrough\n\t\t\tcase Card.guard:\n\t\t\t\tconst card = player.hand![0];\n\t\t\t\tif (card === Card.assassin) {\n\t\t\t\t\tutils.discard(player, false);\n\t\t\t\t\tutils.discard(utils.getMe(), true);\n\t\t\t\t\tthis.finish(`was assassinated by ${player.userName}`);\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState({ c: ComponentsE.guard, index });\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase Card.priest:\n\t\t\t\talert(utils.cardString(player.hand![0]));\n\t\t\t\tthis.finish(`looked at [${player.userName}]'s hand`);\n\t\t\t\tbreak;\n\t\t\tcase Card.baron:\n\t\t\t\tconst diff =\n\t\t\t\t\tRanks[player.hand![0]] - Ranks[utils.getMe().hand![0]];\n\t\t\t\tif (diff === 0) {\n\t\t\t\t\tthis.finish(`baron tied [${player.userName}]`);\n\t\t\t\t} else {\n\t\t\t\t\tconst loser = diff > 0 ? utils.getMe() : player;\n\t\t\t\t\tconst cardString = utils.cardString(loser.hand![0]);\n\t\t\t\t\tutils.discard(loser, true);\n\t\t\t\t\tthis.finish(`baron [${player.userName}] (${cardString})`);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase Card.prince:\n\t\t\t\tconst msg = `made [${\n\t\t\t\t\tplayer.userName\n\t\t\t\t}] discard ${utils.cardString(player.hand![0])}`;\n\t\t\t\tutils.discard(player, false);\n\t\t\t\tthis.finish(msg);\n\t\t\t\tbreak;\n\t\t\tcase Card.king:\n\t\t\t\tconst me = utils.getMe();\n\t\t\t\t[me.hand, player.hand] = [player.hand, me.hand];\n\t\t\t\tthis.finish(`swapped with [${player.userName}]`);\n\t\t\t\tbreak;\n\t\t\tcase Card.jester:\n\t\t\t\tstore.gameW.game.jester = index;\n\t\t\t\tthis.finish(`selected ${player.userName} to win`);\n\t\t\t\tbreak;\n\t\t\tcase Card.sycophant:\n\t\t\t\t// need to set sycophant before finishing::advancingTurn\n\t\t\t\t// because advancingTurn resets sycophant\n\t\t\t\tthis.finish();\n\t\t\t\tstore.gameW.game.sycophant = index;\n\t\t\t\tstore.update(`sycophanted ${player.userName}`);\n\t\t\t\tbreak;\n\t\t\tcase Card.queen:\n\t\t\t\tconst diffQ =\n\t\t\t\t\tRanks[player.hand![0]] - Ranks[utils.getMe().hand![0]];\n\t\t\t\tif (diffQ === 0) {\n\t\t\t\t\tthis.finish(`queen tied [${player.userName}]`);\n\t\t\t\t} else {\n\t\t\t\t\tconst loser = diffQ < 0 ? utils.getMe() : player;\n\t\t\t\t\tconst cardString = utils.cardString(loser.hand![0]);\n\t\t\t\t\tutils.discard(loser, true);\n\t\t\t\t\tthis.finish(`queen [${player.userName}] (${cardString})`);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase Card.bishop:\n\t\t\t\tthis.setState({ c: ComponentsE.bishop, index });\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfinish(msg?: string) {\n\t\tdelete store.gameW.game.played;\n\t\tutils.advanceTurn();\n\t\tif (msg !== undefined) store.update(msg);\n\t}\n\n\treset() {\n\t\tthis.setState({ c: undefined, index: undefined });\n\t}\n\n\trender() {\n\t\tif (!utils.isMyTurn() || store.gameW.game.played === undefined)\n\t\t\treturn null;\n\t\tif (this.state.c !== undefined) {\n\t\t\tconst c = ComponentsM[this.state.c];\n\t\t\tconst cc = { c };\n\t\t\treturn (\n\t\t\t\t<cc.c\n\t\t\t\t\tindex={this.state.index!}\n\t\t\t\t\tplayer={store.gameW.game.players[this.state.index!]}\n\t\t\t\t\tfinish={this.finish.bind(this)}\n\t\t\t\t\treset={this.reset.bind(this)}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tif (store.gameW.game.bishop !== undefined) return null;\n\t\tconst targets = this.getTargets();\n\t\tif (store.gameW.game.played === Card.cardinal)\n\t\t\treturn (\n\t\t\t\t<Cardinal targets={targets} finish={this.finish.bind(this)} />\n\t\t\t);\n\t\tif (store.gameW.game.played === Card.baroness)\n\t\t\treturn (\n\t\t\t\t<Baroness targets={targets} finish={this.finish.bind(this)} />\n\t\t\t);\n\t\tif (targets.length <= 1) return null;\n\t\treturn targets\n\t\t\t.map((index) => ({\n\t\t\t\tindex,\n\t\t\t\tplayer: store.gameW.game.players[index],\n\t\t\t}))\n\t\t\t.map((o, index) => (\n\t\t\t\t<div\n\t\t\t\t\tkey={index}\n\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\tonClick={() => this.execute(o.index)}\n\t\t\t\t>\n\t\t\t\t\t{o.player.userName}\n\t\t\t\t</div>\n\t\t\t));\n\t}\n}\n\nexport default Action;\n","import React from \"react\";\n\nimport { Card, COUNTS } from \"./utils/NewGame\";\nimport utils from \"./utils/utils\";\n\nimport styles from \"../../../shared/styles.module.css\";\n\nconst RULES = {\n\t[Card.guard]:\n\t\t\"Choose a player and number (other than 1). If that player has that card, they are out of the round.\",\n\t[Card.priest]: \"Look at a player's hand.\",\n\t[Card.baron]:\n\t\t\"Secretly compare hands with another player. The player with the LOWER number is knocked out\",\n\t[Card.handmaid]:\n\t\t\"You are immune to the effects of other players cards until the start of your next turn.\",\n\t[Card.prince]:\n\t\t\"Choose a player (including yourself) to discard their hand and draw a new card.\",\n\t[Card.king]: \"Trade hands with another player.\",\n\t[Card.countess]:\n\t\t\"(No effect) - you must discard if you also have the King or Prince.\",\n\t[Card.princess]: \"If discarded, you lose.\",\n\t[Card.bishop]:\n\t\t\"Choose a player and number. If player has that card, you win a token. Also, if you were correct, that player may discard their card and draw a new one. Bishop loses to the Princess at round end.\",\n\t[Card.queen]:\n\t\t\"Secretly compare hands with another player. The player with the HIGHER number is knocked out\",\n\t[Card.constable]:\n\t\t\"If knocked out with this in the discard pile, you win a token.\",\n\t[Card.count]:\n\t\t\"At round end, increases proximity to Princess by 1 for each Count in your discard pile.\",\n\t[Card.sycophant]:\n\t\t\"When you discard the Sycophant, choose a player (including yourself). Then, as long as the next card played has an effect that chooses one or more players, it has to at least choose the player you chose with the Sycophant.\",\n\t[Card.baroness]: \"Look at the hands of 2 other players.\",\n\t[Card.cardinal]:\n\t\t\"When you discard the Cardinal, choose exactly 2 players (you may include yourself), who will switch hands. Then, once the hands are switched, you may look at one of them.\",\n\t[Card.guardX]: \"Expansion guard is the same as the normal guard.\",\n\t[Card.jester]:\n\t\t\"Choose another player. If that player wins the round, you win a token.\",\n\t[Card.assassin]:\n\t\t\"If attacked by a guard (regardless if successful), the guard is eliminiated, and you draw a new card, discarding the assassin.\",\n};\n\nexport const FLAVOR = {\n\t[Card.guard]: `\n1: Guard Odette\nCharged with seeing to the security of the royal family, Odette follows her orders with persistence and diligence even though her mentor is said to have drowned while fleeing arrest for complicity in the Queens treason.\n\nWhen you discard the Guard, choose a player and name a number (other than 1). If that player has that number in their hand, that player is knocked out of the round. If all other players still in the round cannot be chosen (eg. due to Handmaid or Sycophant), this card is discarded without effect.`,\n\t[Card.priest]: `\n2: Priest Tomas\nOpen, honest, and uplifting, Father Tomas always seeks out the opportunity to do good. With the arrest of the Queen, he is often seen about the palace, acting as confessor, counselor, and friend.\n\nWhen you discard the Priest, you can look at another players hand. Do not reveal the hand to any other players.`,\n\t[Card.baron]: `\n3: Baron Talus\nThe scion of an esteemed house that has long been a close ally of the royal family, Baron Talus has a quiet and gentle demeanor that conceals a man used to being obeyed. His suggestions are often treated as if they came from the King himself.\n\nWhen you discard the Baron, choose another player still in the round. You and that player secretly compare your hands. The player with the lower number is knocked out of the round. In case of a tie, nothing happens.`,\n\t[Card.handmaid]: `\n4: Handmaid Susannah\nFew would trust a mere Handmaid with a letter of importance. Fewer still understand Susannahs cleverness, or her skilled ability at playing the foolish Handmaid. That the Queens confidante and loyal servant escaped any attention after the Queens arrest is a testament to her clever mind.\n\nWhen you discard the Handmaid, you are immune to the effects of other players cards until the start of your next turn. If all players other than the player whose turn it is are protected by the Handmaid, the player must choose himor herself for a cards effects, if possible.`,\n\t[Card.prince]: `\n5: Prince Arnaud\nAs a social gadfly, Prince Arnaud was not as distressed over his mothers arrest as one would suppose. Since many women clamor for his attention, he hopes to help his sister find the same banal happiness by playing matchmaker.\n\nWhen you discard Prince Arnaud, choose one player still in the round (including yourself). That player discards his or her hand (but doesnt apply its effect, unless it is the Princess, see page 8) and draws a new one. If the deck is empty and the player cannot draw a card, that player draws the card that was removed at the start of the round. If all other players are protected by the Handmaid, you must choose yourself.`,\n\t[Card.king]: `\n6: King Arnaud IV\nThe undisputed ruler of Tempest for the moment. Because of his role in the arrest of Queen Marianna, he does not rate as highly with Princess Annette as a father should. He hopes to work himself back into her graces.\n\nWhen you discard King Arnaud IV, trade the card in your hand with the card held by another player of your choice. You cannot trade with a player who is out of the round.`,\n\t[Card.countess]: `\n7: Countess Wilhelmina\nAlways on the prowl for a handsome man or juicy gossip, Wilhelminas age and noble blood make her one of Princess Annettes friends. While she has great influence over the Princess, she makes herself scarce whenever the King or Prince are around. Unlike other cards, which take effect when discarded, the text on the Countess applies while she is in your hand. In fact, the only time it doesnt apply is when you discard her.\n\nIf you ever have the Countess and either the King or Prince in your hand, you must discard the Countess. You do not have to reveal the other card in your hand. Of course, you can also discard the Countess even if you do not have a royal family member in your hand. The Countess likes to play mind games....`,\n\t[Card.princess]: `\n8: Princess Annette\nHampered only by the navet of youth, Princess Annette is elegant, charming, and beautiful. Obviously, you want the princess to carry your letter. However, she is self-conscious about matters of the heart, and if confronted, will toss your letter in the fire and deny looking at any correspondence.\n\nIf you discard the Princessno matter how or whyshe has tossed your letter into the fire. You are immediately knocked out of the round. If the Princess was discarded by a card effect, any remaining effects of that card do not apply (you do not draw a card from the Prince, for example). Effects tied to being knocked out the round still apply (eg. Constable, Jester), however.`,\n\t[Card.bishop]: `\n9: Bishop Vinizio\nMeasured and calculating, Bishop Vinizio may come across as a schemer or opportunist. The truth, though, is that he cares deeply for the welfare of his congregants, and will go to great lengths to protect and help them.\n\nDiscarding the Bishop allows you to name a number and a player. If the player has that number in their hand, you get a Token of Affection. If this would give you enough Tokens to win the game, then you win immediately and the game ends. If you gained a Token of Affection from this effect, then the player whose card you effectively revealed with the Bishop may discard their card (but doesnt apply its effects, unless it is the Princess, see page 8) and draw a new one. At the end of a round, despite his impressive 9, the Princess still beats the Bishop when comparing the values of cards in players hands. He is considered to have a value of 9 for all other game effects, however`,\n\t[Card.queen]: `\n7: Dowager Queen Tummia\nMother to King Arnaud, the dowager Queen Mother Tummia was devastated by the arrest of her daughter-in-law, Queen Marianna. She now focuses her attention on her granddaughter, Princess Annette, in whom she sees much of the deposed Queen.\n\nWhen you discard the Dowager Queen, choose another player still in the round. You and that player secretly compare your hands. The player with the higher number is knocked out of the round. In case of a tie, nothing happens.`,\n\t[Card.constable]: `\n6: Constable Viktor\nBecause the security of the royal court ultimately rests in the hands of Constable Viktor, it was his decision to arrest the Queen for high treason. Now, as the weight of his duty bears down on him, he is determined to see no harm befall the young Princess.\n\nThe Constable is a somewhat unusual card, insofar as its effect applies not when discarded, like most cards, but when you are knocked out of the round with it in your discard pile. Should this happen, show the Constable, then claim a Token of Affection. If this would give you enough Tokens to win the game, then you win immediately and the game ends.`,\n\t[Card.count]: `\n5: Count Guntram\nAn ambitious man, the wily Count Guntram is careful to offer his support to whomever he believes is most likely to benefit his own interests in court. Once he has made his choice, though, his loyalty is certain, as he continues to work behind the scenes on his chosen patrons behalf.\n\nWhen the round ends, if it is necessary to check the number in the players hands to determine a winner, the Count will increase that number by 1. Note that this stacks, so if you have both copies of the Count in your discard pile, the number will increase by 2. In this case, the cards with a number of 7the Countess and the Dowager Queenwould beat the Princess. If increasing the number of the card in your hand with the Count would result in a tie for highest number in a players hand, then resolve ties normally, by adding the numbers of the cards in the discard pile of each tied player and comparing the totals.`,\n\t[Card.sycophant]: `\n4: Sycophant Morris\nThe Sycophant is a true opportunist. Obsequious to the point of groveling, he will do almost anything to gain favor from more powerful and influential courtiers, then seek to use that favor to further his own standing in court.\n\nWhen you discard the Sycophant, choose a player (including yourself). Then, as long as the next card played has an effect that chooses one or more players, it has to at least choose the player you chose with the Sycophant.`,\n\t[Card.baroness]: `\n3: Baroness Fiona\nWhile Baroness Fiona is seemingly content to remain in the political shadow of her husband, Baron Talus, this is really a ruse. Fiona has a keen mind for courtly intrigue, and will take firm, albeit discrete action as she sees fit, regardless of whether it aligns with her husbands interests.\n\nWhen you discard the Baroness, you can look at the hands of either 1 or 2 other players. Do not reveal them to any other players.`,\n\t[Card.cardinal]: `\n2: Cardinal Vesper\nA devout and notoriously uncompromising man, Cardinal Vesper would see the Princess married to an appropriate suitorand as soon as possible, at that. The girls happiness is certainly a consideration, but stabilizing the royal family and its succession in the wake of the Queens alleged treason is what matters most.\n\nWhen you discard the Cardinal, choose exactly 2 players (you may include yourself), who will switch hands. Then, once the hands are switched, you may look at one of them without revealing it to any other players. If less than 2 players still in the round can be chosen, (eg. due to Handmaid or Sycophant), this card is discarded without effect.`,\n\t[Card.guardX]: `\n1: Guard Dougaul\nDour and uncompromising, Dougaul is every bit as committed to the security and well-being of the royal family as Odette, his fellow Guard. He has an abiding, almost fatherly fondness for the young Princess, though, and will cast a wary and searching eye on any suitor seeking her favor.\n\nWhen you discard the Guard, choose a player and name a number (other than 1). If that player has that number in their hand, that player is knocked out of the round. If all other players still in the round cannot be chosen (eg. due to Handmaid or Sycophant), this card is discarded without effect.`,\n\t[Card.jester]: `\n0: Jester Darius\nAlthough often seen in court, Jester Darius is a mere entertainer. This might seem to suggest his influence is negligible, but like many of low station who work in the royal court, Darius is largely invisible to the powerful courtiers around him. As a result, he sees and hears much more than most realize, giving him a potent sort of influence of his own.\n\nWhen you discard the Jester, choose another playerideally, the one you believe is most likely to win the round. Its helpful to place the Jester token provided in the game near the player you chose, so everyone remembers your choice. If youre correct, and your chosen player does win the round, you gain a Token of Affection. If this would give you enough Tokens to win the game, then you win immediately and the game ends.`,\n\t[Card.assassin]: `\n0: Assassin\nA shadowy and elusive figure of menace, the Assassin will work for whomever can meet his price. He is particularly adept at circumventing the Guards who protect the court, allowing him to pursue his secretive activities undisturbedwhether thats delivering a suitors letter of affection to the cloistered Princess, or conducting more sinister business...\n\nThis is a card whose effect only applies while it is in your hand. If another player chooses you when playing a Guard, then regardless of what number that player named (even 0!), when you reveal the Assassin (to all players), the Guards player is eliminated from the round, while you are not. Of course, all other players will now know that you have the Assassin in your hand. It would be both improper and dangerous to keep consorting with such an unsavory character, so after youve resolved the Assassins effect, you must discard him and draw a new card. If the deck is empty and you cannot draw a card, then draw the card that was removed at the start of the round.`,\n};\n\nclass Rules extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>\n\t\t\t\t\t<a href=\"http://alderac.com/wp-content/uploads/2017/11/Love-Letter-Premium_Rulebook.pdf\">\n\t\t\t\t\t\tRules\n\t\t\t\t\t</a>\n\t\t\t\t</h2>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<ol>\n\t\t\t\t\t\t<li>Draw a card.</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tPick one of your two cards to play. Its effect is\n\t\t\t\t\t\t\tactivated.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>Your remaining card stays in your hand.</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tThe last player remaining in the round is the\n\t\t\t\t\t\t\twinner, and earns a token of affection.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tIf multiple players are still in the round when the\n\t\t\t\t\t\t\tdeck runs out, the player with the higher rank card\n\t\t\t\t\t\t\tin their hand wins the round.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tIf there is a tie, the player with the highest sum\n\t\t\t\t\t\t\tof ranks in their discard pile is the winner of the\n\t\t\t\t\t\t\tround.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tIf there is STILL a tie, nobody wins a token of\n\t\t\t\t\t\t\taffection.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tWhen the round is over, a new round begins, and\n\t\t\t\t\t\t\teveryone draws a new starting card.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tYou need a bunch of tokens of affection to win the\n\t\t\t\t\t\t\tgame.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tEach round, secretly remove one card from the deck.\n\t\t\t\t\t\t\tIt is replaced at the end of the round.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tIn a 2-4 player game, only use the first 8 types of\n\t\t\t\t\t\t\tcard.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tIn a 2 player game, remove and reveal 3 cards from\n\t\t\t\t\t\t\tthe deck to expedite rounds.\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ol>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t{Object.values(Card).map(\n\t\t\t\t\t\t(c) =>\n\t\t\t\t\t\t\ttypeof c === \"number\" && (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={c}\n\t\t\t\t\t\t\t\t\ttitle={FLAVOR[c].replace(/^\\s+|\\s+$/g, \"\")}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{utils.cardString(c)}: {Math.abs(COUNTS[c])}\n\t\t\t\t\t\t\t\t\t<p>{RULES[c]}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Rules;\n","import React from \"react\";\n\nimport { Card } from \"../utils/NewGame\";\nimport utils, { store } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport { FLAVOR } from \"../Rules\";\n\nclass HandCard extends React.Component<{ index: number }> {\n\trender() {\n\t\tconst card = this.getCard();\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={styles.bubble}\n\t\t\t\tonClick={this.play.bind(this)}\n\t\t\t\ttitle={FLAVOR[card]}\n\t\t\t>\n\t\t\t\t{utils.cardString(card)}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetCard() {\n\t\treturn utils.getMe().hand![this.props.index];\n\t}\n\n\tplay() {\n\t\tif (!utils.isMyTurn()) return;\n\t\tif (store.gameW.game.played !== undefined) return;\n\t\tconst me = utils.getMe();\n\t\tif (me.hand![1 - this.props.index] === Card.countess) {\n\t\t\tswitch (me.hand![this.props.index]) {\n\t\t\t\tcase Card.prince:\n\t\t\t\t// @ts-ignore fallthrough\n\t\t\t\tcase Card.king:\n\t\t\t\t\talert(`need to play ${Card[Card.countess]}`);\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tconst played = me.hand!.splice(this.props.index, 1)[0];\n\t\tif (!me.played) me.played = [];\n\t\tme.played.unshift(played);\n\t\tswitch (played) {\n\t\t\tcase Card.princess:\n\t\t\t\tutils.discard(me, true);\n\t\t\t// @ts-ignore fallthrough\n\t\t\tcase Card.handmaid:\n\t\t\t// @ts-ignore fallthrough\n\t\t\tcase Card.assassin:\n\t\t\t// @ts-ignore fallthrough\n\t\t\tcase Card.count:\n\t\t\t// @ts-ignore fallthrough\n\t\t\tcase Card.constable:\n\t\t\t// @ts-ignore fallthrough\n\t\t\tcase Card.countess:\n\t\t\t\tutils.advanceTurn();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tstore.gameW.game.played = played;\n\t\t}\n\t\tstore.update(`played ${utils.cardString(played)}`);\n\t}\n}\n\nexport default HandCard;\n","import React from \"react\";\n\nimport utils from \"../utils/utils\";\n\nimport HandCard from \"./HandCard\";\n\nclass Me extends React.Component {\n\trender() {\n\t\tconst me = utils.getMe();\n\t\tif (!me || !me.hand) return null;\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<h2>Hand: {me.hand.map(this.card)}</h2>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tcard(_: any, index: number) {\n\t\treturn <HandCard index={index} key={index} />;\n\t}\n}\n\nexport default Me;\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Cardinal extends React.Component<\n\t{\n\t\ttargets: number[];\n\t\tfinish: (m: string) => void;\n\t},\n\t{ targetIndex: number }\n> {\n\tcomponentDidMount() {\n\t\tthis.action();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.action();\n\t}\n\n\taction() {\n\t\twindow.requestAnimationFrame(this.actionHelper.bind(this));\n\t}\n\n\tactionHelper() {\n\t\tif (!utils.isMyTurn()) return;\n\t\tif (store.gameW.game.cardinal) return;\n\t\tif (this.props.targets.length < 2) {\n\t\t\tthis.props.finish(\"not enough targets\");\n\t\t} else if (this.props.targets.length === 2) {\n\t\t\tthis.execute(this.props.targets[0], this.props.targets[1]);\n\t\t}\n\t}\n\n\texecute(p1: number, p2: number) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst players = store.gameW.game.players;\n\t\tstore.gameW.game.cardinal = { p1, p2 };\n\t\t[players[p1].hand, players[p2].hand] = [\n\t\t\tplayers[p2].hand,\n\t\t\tplayers[p1].hand,\n\t\t];\n\t\tstore.update(\n\t\t\t`swapped ${players[p1].userName} and ${players[p2].userName}`\n\t\t);\n\t}\n\n\trender() {\n\t\tif (!utils.isMyTurn()) return null;\n\t\tif (store.gameW.game.cardinal) {\n\t\t\treturn this.renderView();\n\t\t} else {\n\t\t\tif (this.props.targets.length <= 2) return null;\n\t\t\treturn this.renderChoose();\n\t\t}\n\t}\n\n\trenderView() {\n\t\tconst cardinal = store.gameW.game.cardinal!;\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Peek at a swapped player's new hand</h2>\n\t\t\t\t<div className={styles.bubble} onClick={() => this.view(-1)}>\n\t\t\t\t\tNone\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\tonClick={() => this.view(cardinal.p1)}\n\t\t\t\t>\n\t\t\t\t\t{store.gameW.game.players[cardinal.p1].userName}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={styles.bubble}\n\t\t\t\t\tonClick={() => this.view(cardinal.p2)}\n\t\t\t\t>\n\t\t\t\t\t{store.gameW.game.players[cardinal.p2].userName}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tview(index: number) {\n\t\tdelete store.gameW.game.cardinal;\n\t\tif (index < 0) {\n\t\t\tthis.props.finish(`declined to peek`);\n\t\t} else {\n\t\t\tconst p = store.gameW.game.players[index];\n\t\t\talert(utils.cardString(p.hand![0]));\n\t\t\tthis.props.finish(`peeked at [${p.userName}]'s hand`);\n\t\t}\n\t}\n\n\trenderChoose() {\n\t\treturn this.props.targets\n\t\t\t.map((index) => ({\n\t\t\t\tindex,\n\t\t\t\tplayer: store.gameW.game.players[index]!,\n\t\t\t}))\n\t\t\t.map((o) => (\n\t\t\t\t<div\n\t\t\t\t\tkey={o.index}\n\t\t\t\t\tonClick={() => this.choose(o.index)}\n\t\t\t\t\tclassName={`${styles.bubble} ${\n\t\t\t\t\t\tthis.state &&\n\t\t\t\t\t\tthis.state.targetIndex === o.index &&\n\t\t\t\t\t\tstyles.grey\n\t\t\t\t\t}`}\n\t\t\t\t>\n\t\t\t\t\t{o.player.userName}\n\t\t\t\t</div>\n\t\t\t));\n\t}\n\n\tchoose(targetIndex: number) {\n\t\tif (this.state) {\n\t\t\tconst prev = this.state.targetIndex;\n\t\t\tif (prev !== -1) {\n\t\t\t\tif (prev !== targetIndex) {\n\t\t\t\t\tthis.execute(prev, targetIndex);\n\t\t\t\t}\n\t\t\t\ttargetIndex = -1;\n\t\t\t}\n\t\t}\n\t\tthis.setState({ targetIndex });\n\t}\n}\n\nexport default Cardinal;\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Baroness extends React.Component<\n\t{\n\t\ttargets: number[];\n\t\tfinish: (m: string) => void;\n\t},\n\t{ targetIndex: number }\n> {\n\tcomponentDidMount() {\n\t\tthis.action();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.action();\n\t}\n\n\taction() {\n\t\twindow.requestAnimationFrame(this.actionHelper.bind(this));\n\t}\n\n\tactionHelper() {\n\t\tif (this.props.targets.length === 0) {\n\t\t\tthis.props.finish(\"not enough targets\");\n\t\t} else if (this.props.targets.length <= 2) {\n\t\t\tthis.execute(this.props.targets[0], this.props.targets[1]);\n\t\t}\n\t}\n\n\texecute(p1: number, p2?: number) {\n\t\tconst players = store.gameW.game.players;\n\t\tconst targets = p2 === undefined ? [p1] : [p1, p2];\n\t\tconst a = targets\n\t\t\t.map((i) => players[i])\n\t\t\t.map((p) => `${p.userName}: ${utils.cardString(p.hand![0])}`)\n\t\t\t.join(\"\\n\");\n\t\talert(a);\n\t\tconst msg = `viewed ${targets\n\t\t\t.map((i) => players[i].userName)\n\t\t\t.join(\" and \")}`;\n\t\tthis.props.finish(msg);\n\t}\n\n\trender() {\n\t\treturn this.props.targets\n\t\t\t.map((index) => ({\n\t\t\t\tindex,\n\t\t\t\tplayer: store.gameW.game.players[index]!,\n\t\t\t}))\n\t\t\t.map((o) => (\n\t\t\t\t<div\n\t\t\t\t\tkey={o.index}\n\t\t\t\t\tonClick={() => this.choose(o.index)}\n\t\t\t\t\tclassName={`${styles.bubble} ${\n\t\t\t\t\t\tthis.state &&\n\t\t\t\t\t\tthis.state.targetIndex === o.index &&\n\t\t\t\t\t\tstyles.grey\n\t\t\t\t\t}`}\n\t\t\t\t>\n\t\t\t\t\t{o.player.userName}\n\t\t\t\t</div>\n\t\t\t));\n\t}\n\n\tchoose(targetIndex: number) {\n\t\tif (this.state) {\n\t\t\tconst prev = this.state.targetIndex;\n\t\t\tif (prev !== -1) {\n\t\t\t\tif (prev !== targetIndex) {\n\t\t\t\t\tthis.execute(prev, targetIndex);\n\t\t\t\t}\n\t\t\t\ttargetIndex = -1;\n\t\t\t}\n\t\t}\n\t\tthis.setState({ targetIndex });\n\t}\n}\n\nexport default Baroness;\n","import React from \"react\";\nimport { PlayerType } from \"../utils/NewGame\";\n\ntype ActionComponentProps = {\n\tfinish: (m: string) => void;\n\treset: () => void;\n\tplayer: PlayerType;\n\tindex: number;\n};\n\nexport default abstract class ActionComponent extends React.Component<\n\tActionComponentProps\n> {\n\texecuted = false;\n\tcomponentDidMount() {\n\t\tthis.executed = false;\n\t}\n}\n","import React from \"react\";\n\nimport ActionComponent from \"./ActionComponent\";\nimport utils, { store } from \"../utils/utils\";\nimport { Ranks } from \"../utils/NewGame\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Bishop extends ActionComponent {\n\tinputRef: React.RefObject<HTMLInputElement> = React.createRef();\n\trender() {\n\t\treturn (\n\t\t\t<form className={styles.bubble} onSubmit={this.execute.bind(this)}>\n\t\t\t\tChoose a rank for {this.props.player.userName}: <br />\n\t\t\t\t<input ref={this.inputRef} />\n\t\t\t</form>\n\t\t);\n\t}\n\n\texecute(e: React.FormEvent<HTMLFormElement>) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.executeHelper();\n\t\treturn false;\n\t}\n\n\texecuteHelper() {\n\t\tconst choice = this.inputRef.current!.value;\n\t\tif (this.executed) return;\n\t\tthis.executed = true;\n\t\tthis.props.reset();\n\t\tconst correct = choice === Ranks[this.props.player.hand![0]].toString();\n\t\tconst msgB = `guessed ${choice} for [${this.props.player.userName}] - ${\n\t\t\tcorrect ? \"correct\" : \"incorrect\"\n\t\t}`;\n\t\tif (correct) {\n\t\t\tutils.getMe().score++;\n\t\t\tstore.gameW.game.bishop = utils.myIndex();\n\t\t\tstore.gameW.game.currentPlayer = this.props.index;\n\t\t\tstore.update(msgB);\n\t\t} else {\n\t\t\tthis.props.finish(msgB);\n\t\t}\n\t}\n}\n\nexport default Bishop;\n","import React from \"react\";\n\nimport ActionComponent from \"./ActionComponent\";\nimport utils, { store } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass BishopDiscard extends ActionComponent {\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<div>\n\t\t\t\t\tYou were correctly guessed by the bishop. Would you like to\n\t\t\t\t\tdiscard your hand?\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<button onClick={() => this.execute(true)}>Yes</button>\n\t\t\t\t\t<button onClick={() => this.execute(false)}>No</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\texecute(toDiscard: boolean) {\n\t\tif (this.executed) return;\n\t\tthis.executed = true;\n\t\tthis.props.reset();\n\t\tconst cardB = utils.getMe().hand![0];\n\t\tif (toDiscard) utils.discard(utils.getMe(), false);\n\t\tstore.gameW.game.currentPlayer = store.gameW.game.bishop!;\n\t\tdelete store.gameW.game.bishop;\n\t\tthis.props.finish(\n\t\t\ttoDiscard\n\t\t\t\t? `discarded ${utils.cardString(cardB)}`\n\t\t\t\t: \"did not discard\"\n\t\t);\n\t}\n}\n\nexport default BishopDiscard;\n","import React from \"react\";\n\nimport ActionComponent from \"./ActionComponent\";\nimport utils from \"../utils/utils\";\nimport { Ranks } from \"../utils/NewGame\";\n\nimport styles from \"../../../../shared/styles.module.css\";\n\nclass Guard extends ActionComponent {\n\tinputRef: React.RefObject<HTMLInputElement> = React.createRef();\n\trender() {\n\t\treturn (\n\t\t\t<form className={styles.bubble} onSubmit={this.execute.bind(this)}>\n\t\t\t\tChoose a rank for {this.props.player.userName}: <br />\n\t\t\t\t<input ref={this.inputRef} />\n\t\t\t</form>\n\t\t);\n\t}\n\n\texecute(e: React.FormEvent<HTMLFormElement>) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.executeHelper();\n\t\treturn false;\n\t}\n\n\texecuteHelper() {\n\t\tconst choice = this.inputRef.current!.value;\n\t\tif (choice === \"1\") {\n\t\t\talert(\"Cannot choose 1\");\n\t\t\treturn;\n\t\t}\n\t\tif (this.executed) return;\n\t\tthis.executed = true;\n\t\tthis.props.reset();\n\t\tconst correct = choice === Ranks[this.props.player.hand![0]].toString();\n\t\tif (correct) utils.discard(this.props.player, true);\n\t\tthis.props.finish(\n\t\t\t`guessed ${choice} for [${this.props.player.userName}] - ${\n\t\t\t\tcorrect ? \"correct\" : \"incorrect\"\n\t\t\t}`\n\t\t);\n\t}\n}\n\nexport default Guard;\n","import React from \"react\";\n\nimport ActionComponent from \"./ActionComponent\";\nimport utils, { store } from \"../utils/utils\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport { deal } from \"../utils/NewGame\";\n\nclass Winner extends ActionComponent {\n\tinputRef: React.RefObject<HTMLInputElement> = React.createRef();\n\trender() {\n\t\treturn (\n\t\t\t<form className={styles.bubble} onSubmit={this.execute.bind(this)}>\n\t\t\t\tWhat do you do on your date?\n\t\t\t\t<br />\n\t\t\t\t<input ref={this.inputRef} />\n\t\t\t</form>\n\t\t);\n\t}\n\n\texecute(e: React.FormEvent<HTMLFormElement>) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.executeHelper();\n\t\treturn false;\n\t}\n\n\texecuteHelper() {\n\t\tconst rawMsg = this.inputRef.current!.value;\n\t\tif (this.executed) return;\n\t\tthis.executed = true;\n\t\tthis.props.reset();\n\t\tdelete store.gameW.game.played;\n\t\tconst ranks = store.gameW.game.players\n\t\t\t.filter((p) => p.hand)\n\t\t\t.map((p) => `${p.userName}: ${utils.cardString(p.hand![0])}`)\n\t\t\t.join(\", \");\n\t\tconst msg = `{${ranks}} ${rawMsg || \"has a boring date\"}`;\n\t\tdeal(store.gameW.game);\n\t\tstore.gameW.info.alert = msg;\n\t\tutils.getMe().score++;\n\t\tstore.update(msg);\n\t}\n}\n\nexport default Winner;\n","export enum Token {\n\tgreen,\n\tblue,\n\tred,\n\twhite,\n\tblack,\n\tgold,\n}\n\nexport enum Level {\n\tone,\n\ttwo,\n\tthree,\n}\n\nexport type Card = {\n\tlevel: Level;\n\tcolor: Token;\n\tpoints: number;\n\tprice: { [t in Token]?: number };\n};\n\nexport type TokensGroup = { [t in Token]?: number };\n\nconst cards = [\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 1,\n\t\t\t[Token.blue]: 1,\n\t\t\t[Token.green]: 1,\n\t\t\t[Token.red]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 1,\n\t\t\t[Token.blue]: 2,\n\t\t\t[Token.green]: 1,\n\t\t\t[Token.red]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 2, [Token.blue]: 2, [Token.red]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 0,\n\t\tprice: { [Token.green]: 1, [Token.red]: 3, [Token.black]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 0,\n\t\tprice: { [Token.green]: 2, [Token.red]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 2, [Token.green]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 0,\n\t\tprice: { [Token.green]: 3 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.black,\n\t\tpoints: 1,\n\t\tprice: { [Token.blue]: 4 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 1,\n\t\t\t[Token.green]: 1,\n\t\t\t[Token.red]: 1,\n\t\t\t[Token.black]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 1,\n\t\t\t[Token.green]: 1,\n\t\t\t[Token.red]: 2,\n\t\t\t[Token.black]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 1, [Token.green]: 2, [Token.red]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 0,\n\t\tprice: { [Token.blue]: 1, [Token.green]: 3, [Token.red]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 1, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 0,\n\t\tprice: { [Token.green]: 2, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 0,\n\t\tprice: { [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.blue,\n\t\tpoints: 1,\n\t\tprice: { [Token.red]: 4 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.blue]: 1,\n\t\t\t[Token.green]: 1,\n\t\t\t[Token.red]: 1,\n\t\t\t[Token.black]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.blue]: 1,\n\t\t\t[Token.green]: 2,\n\t\t\t[Token.red]: 1,\n\t\t\t[Token.black]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 0,\n\t\tprice: { [Token.blue]: 2, [Token.green]: 2, [Token.black]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 3, [Token.blue]: 1, [Token.black]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 0,\n\t\tprice: { [Token.red]: 2, [Token.black]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 0,\n\t\tprice: { [Token.blue]: 2, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 0,\n\t\tprice: { [Token.blue]: 3 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.white,\n\t\tpoints: 1,\n\t\tprice: { [Token.green]: 4 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 1,\n\t\t\t[Token.blue]: 1,\n\t\t\t[Token.red]: 1,\n\t\t\t[Token.black]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 1,\n\t\t\t[Token.blue]: 1,\n\t\t\t[Token.red]: 1,\n\t\t\t[Token.black]: 2,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 0,\n\t\tprice: { [Token.blue]: 1, [Token.red]: 2, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 1, [Token.blue]: 3, [Token.green]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 2, [Token.blue]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 0,\n\t\tprice: { [Token.blue]: 2, [Token.red]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 0,\n\t\tprice: { [Token.red]: 3 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.green,\n\t\tpoints: 1,\n\t\tprice: { [Token.black]: 4 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 1,\n\t\t\t[Token.blue]: 1,\n\t\t\t[Token.green]: 1,\n\t\t\t[Token.black]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 0,\n\t\tprice: {\n\t\t\t[Token.white]: 2,\n\t\t\t[Token.blue]: 1,\n\t\t\t[Token.green]: 1,\n\t\t\t[Token.black]: 1,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 2, [Token.green]: 1, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 1, [Token.red]: 1, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 0,\n\t\tprice: { [Token.blue]: 2, [Token.green]: 1 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 2, [Token.red]: 2 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 0,\n\t\tprice: { [Token.white]: 3 },\n\t},\n\t{\n\t\tlevel: Level.one,\n\t\tcolor: Token.red,\n\t\tpoints: 1,\n\t\tprice: { [Token.white]: 4 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.black,\n\t\tpoints: 1,\n\t\tprice: { [Token.white]: 3, [Token.blue]: 2, [Token.green]: 2 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.black,\n\t\tpoints: 1,\n\t\tprice: { [Token.white]: 3, [Token.green]: 3, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.black,\n\t\tpoints: 2,\n\t\tprice: { [Token.blue]: 1, [Token.green]: 4, [Token.red]: 2 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.black,\n\t\tpoints: 2,\n\t\tprice: { [Token.green]: 5, [Token.red]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.black,\n\t\tpoints: 2,\n\t\tprice: { [Token.white]: 5 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.black,\n\t\tpoints: 3,\n\t\tprice: { [Token.black]: 6 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.blue,\n\t\tpoints: 1,\n\t\tprice: { [Token.blue]: 2, [Token.green]: 2, [Token.red]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.blue,\n\t\tpoints: 1,\n\t\tprice: { [Token.blue]: 2, [Token.green]: 3, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.blue,\n\t\tpoints: 2,\n\t\tprice: { [Token.white]: 5, [Token.blue]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.blue,\n\t\tpoints: 2,\n\t\tprice: { [Token.white]: 2, [Token.red]: 1, [Token.black]: 4 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.blue,\n\t\tpoints: 2,\n\t\tprice: { [Token.blue]: 5 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.blue,\n\t\tpoints: 3,\n\t\tprice: { [Token.blue]: 6 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.white,\n\t\tpoints: 1,\n\t\tprice: { [Token.green]: 3, [Token.red]: 2, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.white,\n\t\tpoints: 1,\n\t\tprice: { [Token.white]: 2, [Token.blue]: 3, [Token.red]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.white,\n\t\tpoints: 2,\n\t\tprice: { [Token.green]: 1, [Token.red]: 4, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.white,\n\t\tpoints: 2,\n\t\tprice: { [Token.red]: 5, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.white,\n\t\tpoints: 2,\n\t\tprice: { [Token.red]: 5 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.white,\n\t\tpoints: 3,\n\t\tprice: { [Token.white]: 6 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.green,\n\t\tpoints: 1,\n\t\tprice: { [Token.white]: 3, [Token.green]: 2, [Token.red]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.green,\n\t\tpoints: 1,\n\t\tprice: { [Token.white]: 2, [Token.blue]: 3, [Token.black]: 2 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.green,\n\t\tpoints: 2,\n\t\tprice: { [Token.white]: 4, [Token.blue]: 2, [Token.black]: 1 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.green,\n\t\tpoints: 2,\n\t\tprice: { [Token.blue]: 5, [Token.green]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.green,\n\t\tpoints: 2,\n\t\tprice: { [Token.green]: 5 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.green,\n\t\tpoints: 3,\n\t\tprice: { [Token.green]: 6 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.red,\n\t\tpoints: 1,\n\t\tprice: { [Token.white]: 2, [Token.red]: 2, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.red,\n\t\tpoints: 1,\n\t\tprice: { [Token.blue]: 3, [Token.red]: 2, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.red,\n\t\tpoints: 2,\n\t\tprice: { [Token.white]: 1, [Token.blue]: 4, [Token.green]: 2 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.red,\n\t\tpoints: 2,\n\t\tprice: { [Token.white]: 3, [Token.black]: 5 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.red,\n\t\tpoints: 2,\n\t\tprice: { [Token.black]: 5 },\n\t},\n\t{\n\t\tlevel: Level.two,\n\t\tcolor: Token.red,\n\t\tpoints: 3,\n\t\tprice: { [Token.red]: 6 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.black,\n\t\tpoints: 3,\n\t\tprice: {\n\t\t\t[Token.white]: 3,\n\t\t\t[Token.blue]: 3,\n\t\t\t[Token.green]: 5,\n\t\t\t[Token.red]: 3,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.black,\n\t\tpoints: 4,\n\t\tprice: { [Token.red]: 7 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.black,\n\t\tpoints: 4,\n\t\tprice: { [Token.green]: 3, [Token.red]: 6, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.black,\n\t\tpoints: 5,\n\t\tprice: { [Token.red]: 7, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.blue,\n\t\tpoints: 3,\n\t\tprice: {\n\t\t\t[Token.white]: 3,\n\t\t\t[Token.green]: 3,\n\t\t\t[Token.red]: 3,\n\t\t\t[Token.black]: 5,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.blue,\n\t\tpoints: 4,\n\t\tprice: { [Token.white]: 7 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.blue,\n\t\tpoints: 4,\n\t\tprice: { [Token.white]: 6, [Token.blue]: 3, [Token.black]: 3 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.blue,\n\t\tpoints: 5,\n\t\tprice: { [Token.white]: 7, [Token.blue]: 3 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.white,\n\t\tpoints: 3,\n\t\tprice: {\n\t\t\t[Token.blue]: 3,\n\t\t\t[Token.green]: 3,\n\t\t\t[Token.red]: 5,\n\t\t\t[Token.black]: 3,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.white,\n\t\tpoints: 4,\n\t\tprice: { [Token.black]: 7 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.white,\n\t\tpoints: 4,\n\t\tprice: { [Token.white]: 3, [Token.red]: 3, [Token.black]: 6 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.white,\n\t\tpoints: 5,\n\t\tprice: { [Token.white]: 3, [Token.black]: 7 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.green,\n\t\tpoints: 3,\n\t\tprice: {\n\t\t\t[Token.white]: 5,\n\t\t\t[Token.blue]: 3,\n\t\t\t[Token.red]: 3,\n\t\t\t[Token.black]: 3,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.green,\n\t\tpoints: 4,\n\t\tprice: { [Token.blue]: 7 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.green,\n\t\tpoints: 4,\n\t\tprice: { [Token.white]: 3, [Token.blue]: 6, [Token.green]: 3 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.green,\n\t\tpoints: 5,\n\t\tprice: { [Token.blue]: 7, [Token.green]: 3 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.red,\n\t\tpoints: 3,\n\t\tprice: {\n\t\t\t[Token.white]: 3,\n\t\t\t[Token.blue]: 5,\n\t\t\t[Token.green]: 3,\n\t\t\t[Token.black]: 3,\n\t\t},\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.red,\n\t\tpoints: 4,\n\t\tprice: { [Token.green]: 7 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.red,\n\t\tpoints: 4,\n\t\tprice: { [Token.blue]: 3, [Token.green]: 6, [Token.red]: 3 },\n\t},\n\t{\n\t\tlevel: Level.three,\n\t\tcolor: Token.red,\n\t\tpoints: 5,\n\t\tprice: { [Token.green]: 7, [Token.red]: 3 },\n\t},\n];\n\nconst nobles = [\n\t{ [Token.green]: 4, [Token.blue]: 4 },\n\t{ [Token.green]: 4, [Token.red]: 4 },\n\t{ [Token.green]: 4, [Token.white]: 4 },\n\t{ [Token.green]: 4, [Token.black]: 4 },\n\t{ [Token.blue]: 4, [Token.red]: 4 },\n\t{ [Token.blue]: 4, [Token.white]: 4 },\n\t{ [Token.blue]: 4, [Token.black]: 4 },\n\t{ [Token.red]: 4, [Token.white]: 4 },\n\t{ [Token.red]: 4, [Token.black]: 4 },\n\t{ [Token.white]: 4, [Token.black]: 4 },\n\t{ [Token.green]: 3, [Token.blue]: 3, [Token.red]: 3 },\n\t{ [Token.green]: 3, [Token.blue]: 3, [Token.white]: 3 },\n\t{ [Token.green]: 3, [Token.blue]: 3, [Token.black]: 3 },\n\t{ [Token.green]: 3, [Token.red]: 3, [Token.white]: 3 },\n\t{ [Token.green]: 3, [Token.red]: 3, [Token.black]: 3 },\n\t{ [Token.green]: 3, [Token.white]: 3, [Token.black]: 3 },\n\t{ [Token.blue]: 3, [Token.red]: 3, [Token.white]: 3 },\n\t{ [Token.blue]: 3, [Token.red]: 3, [Token.black]: 3 },\n\t{ [Token.blue]: 3, [Token.white]: 3, [Token.black]: 3 },\n\t{ [Token.red]: 3, [Token.white]: 3, [Token.black]: 3 },\n];\n\nexport default { nobles, cards };\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\n\nclass TwoPlayerAside extends React.Component {\n\trender() {\n\t\tif (!store.gameW.game.two_p_aside) return null;\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<h2>Aside for two players:</h2>\n\t\t\t\t<div>\n\t\t\t\t\t{store.gameW.game.two_p_aside\n\t\t\t\t\t\t.map(utils.cardString)\n\t\t\t\t\t\t.join(\" \")}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default TwoPlayerAside;\n","import React from \"react\";\nimport utils, { store } from \"../utils/utils\";\n\nimport Me from \"./Me\";\nimport Action from \"./Action\";\nimport TwoPlayerAside from \"./TwoPlayerAside\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport css from \"../index.module.css\";\n\nclass Main extends React.Component {\n\trender() {\n\t\tconst info = store.gameW.info;\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>\n\t\t\t\t\t[{info.playerName}] {info.message}\n\t\t\t\t</h2>\n\t\t\t\t<Action />\n\t\t\t\t<Me />\n\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t<h2>Suitors:</h2>\n\t\t\t\t\t{store.gameW.game.players.map((p, index) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\tclassName={`${styles.bubble} ${\n\t\t\t\t\t\t\t\tp.hand === undefined && styles.grey\n\t\t\t\t\t\t\t} ${\n\t\t\t\t\t\t\t\tstore.gameW.game.currentPlayer === index &&\n\t\t\t\t\t\t\t\tcss.blue\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\tp.played\n\t\t\t\t\t\t\t\t\t? p.played.map(utils.cardString).join(\"\\n\")\n\t\t\t\t\t\t\t\t\t: \"NONE\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{store.gameW.game.jester === index ? \"(J) \" : \"\"}\n\t\t\t\t\t\t\t{p.userName} - ({p.score})\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t\t<h2>Deck: {store.gameW.game.deck?.length || 0}</h2>\n\t\t\t\t<TwoPlayerAside />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Main;\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\nimport NewGame, { Params } from \"../utils/NewGame\";\n\nimport SharedSidebar from \"../../../../shared/components/sidebar/SharedSidebar\";\n\nclass Sidebar extends SharedSidebar<Params> {\n\tname = \"Love Letter\";\n\tNewGame = NewGame;\n\tisMyTurn = utils.isMyTurn.bind(utils);\n\n\trenderStartNewGame() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<button onClick={this.startNewGame.bind(this)}>New Game</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetParams(): Params {\n\t\treturn { lobby: store.lobby };\n\t}\n}\n\nexport default Sidebar;\n","import React from \"react\";\n\nimport utils, { store } from \"./utils/utils\";\nimport Main from \"./main/Main\";\nimport Sidebar from \"./sidebar/Sidebar\";\nimport Rules from \"./Rules\";\n\nimport styles from \"../../../shared/styles.module.css\";\n\nclass LoveLetter extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={`${utils.isMyTurn() && styles.my_turn}`}>\n\t\t\t\t<div className={styles.main}>\n\t\t\t\t\t<Sidebar />\n\t\t\t\t\t<div className={styles.content}>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div>{store.gameW.game && <Main />}</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Rules />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default LoveLetter;\n","import Shared from \"../../../../shared/shared\";\nimport store_, { StoreType } from \"../../../../shared/store\";\n\nimport { GameType, PlayerType } from \"./NewGame\";\nimport { Token, Card } from \"./bank\";\n\nconst store: StoreType<GameType> = store_;\n\nexport const MAX_HAND_TOKENS = 10;\n\nclass Utils extends Shared<GameType, PlayerType> {\n\tfinishTurn(message: string) {\n\t\tif (!store.gameW.game.tooManyTokens) utils.incrementPlayerTurn();\n\t\tif (store.gameW.game.over && store.gameW.game.currentPlayer === 0)\n\t\t\tstore.gameW.info.alert = \"game over\";\n\t\tstore.update(message);\n\t}\n\n\tgainToken(token: Token, num: number = 1) {\n\t\tstore.gameW.game.tokens[token] -= num;\n\t\tconst me = utils.getMe();\n\t\tif (!me.tokens) me.tokens = [];\n\t\tme.tokens.push(...Array.from(new Array(num)).map((_) => token));\n\t\tif (me.tokens.length > MAX_HAND_TOKENS)\n\t\t\tstore.gameW.game.tooManyTokens = true;\n\t}\n\n\tcardString(card: Card): string {\n\t\treturn `${Token[card.color]} - (${card.points}): ${Object.entries(\n\t\t\tcard.price\n\t\t)\n\t\t\t.map(([t, n]) => `${Token[parseInt(t)]} x${n}`)\n\t\t\t.join(\" / \")}`;\n\t}\n\n\tgetScore(player: PlayerType): number {\n\t\treturn (\n\t\t\t(player.cards || [])\n\t\t\t\t.map((c) => c.points)\n\t\t\t\t.reduce((a, b) => a + b, 0) +\n\t\t\tplayer.nobles * 3\n\t\t);\n\t}\n}\n\nconst utils = new Utils();\n\nexport default utils;\n\nexport { store };\n","import React from \"react\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport utils, { store, MAX_HAND_TOKENS } from \"../utils/utils\";\nimport { Token } from \"../utils/bank\";\n\nclass Me extends React.Component<{\n\tselectedTokens: { [n: number]: boolean };\n\tselectToken: (index: number) => void;\n\tbuyHandCard: (index: number) => void;\n}> {\n\trender() {\n\t\tconst me = utils.getMe();\n\t\tif (!me) return null;\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2>Tokens</h2>\n\t\t\t\t\t{this.mustDiscard() && <h2>Must Discard</h2>}\n\t\t\t\t\t{(me.tokens || []).map((t, index) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\tonClick={() => this.selectToken(index)}\n\t\t\t\t\t\t\tclassName={`${\n\t\t\t\t\t\t\t\tthis.props.selectedTokens[index] && styles.grey\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{Token[t]}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2>Hand</h2>\n\t\t\t\t\t{(me.hand || []).map((c, index) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\tonClick={() => this.props.buyHandCard(index)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{utils.cardString(c)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n\n\tselectToken(index: number) {\n\t\tif (this.mustDiscard()) {\n\t\t\tconst tokens = utils.getMe().tokens!;\n\t\t\tconst token = tokens.splice(index, 1)[0]!;\n\t\t\tif (tokens.length < MAX_HAND_TOKENS) {\n\t\t\t\tdelete store.gameW.game.tooManyTokens;\n\t\t\t\tutils.incrementPlayerTurn();\n\t\t\t}\n\t\t\tstore.update(`discarded ${Token[token]}`);\n\t\t\treturn;\n\t\t}\n\t\tthis.props.selectToken(index);\n\t}\n\n\tmustDiscard() {\n\t\treturn utils.isMyTurn() && store.gameW.game.tooManyTokens;\n\t}\n}\n\nexport default Me;\n","import React from \"react\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport utils, { store } from \"../utils/utils\";\nimport { Token, TokensGroup } from \"../utils/bank\";\n\nclass Players extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2>Players</h2>\n\t\t\t\t\t<div className={styles.flex}>\n\t\t\t\t\t\t{store.gameW.game.players.map((p, index) => (\n\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t\t\t\t\t<h5\n\t\t\t\t\t\t\t\t\t\ttitle={this.tokensString(\n\t\t\t\t\t\t\t\t\t\t\tp.tokens || []\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{p.userName} - {utils.getScore(p)}{\" \"}\n\t\t\t\t\t\t\t\t\t\tpoints\n\t\t\t\t\t\t\t\t\t\t{\" / \"}\n\t\t\t\t\t\t\t\t\t\t{(p.hand || []).length} hand /{\" \"}\n\t\t\t\t\t\t\t\t\t\t{p.nobles} nobles\n\t\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t\t{(p.cards || []).map((c, index) => (\n\t\t\t\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t\t\t\t{utils.cardString(c)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\ttokensString(tokens: Token[]) {\n\t\tconst count: TokensGroup = {};\n\t\ttokens.forEach((t) => (count[t] = 1 + (count[t] || 0)));\n\t\treturn Object.keys(count)\n\t\t\t.map((t) => parseInt(t))\n\t\t\t.map((t: Token) => `${Token[t]} x${count[t]}`)\n\t\t\t.join(\" / \");\n\t}\n}\n\nexport default Players;\n","import React from \"react\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport utils, { store } from \"../utils/utils\";\nimport { Level, Token } from \"../utils/bank\";\n\nconst NUM_BUYABLE = 4;\n\nclass Cards extends React.Component<{\n\tgoldSelected: boolean;\n\tbuyCard: (level: Level, index: number) => void;\n\tselectGold: () => void;\n}> {\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2>Board</h2>\n\t\t\t\t\t{utils.enumArray(Level).map((l: Level) => {\n\t\t\t\t\t\tconst deck = store.gameW.game.cards[l];\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tdeck && (\n\t\t\t\t\t\t\t\t<div key={l}>\n\t\t\t\t\t\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t\t\t\t\t\t<h5\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn()) return;\n\t\t\t\t\t\t\t\t\t\t\t\tthis.reserve(\n\t\t\t\t\t\t\t\t\t\t\t\t\tl,\n\t\t\t\t\t\t\t\t\t\t\t\t\tNUM_BUYABLE,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"face down card\"\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tLevel {Level[l]}:{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t{deck.length - NUM_BUYABLE}\n\t\t\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t\t\t{Array.from(new Array(NUM_BUYABLE))\n\t\t\t\t\t\t\t\t\t\t\t.map((_, index) => deck[index])\n\t\t\t\t\t\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t\t\t\t\t\t.map((card, index) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!utils.isMyTurn())\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.props\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.goldSelected\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.reserve(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tl,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"card\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.props.buyCard(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tl,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{utils.cardString(card)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treserve(level: Level, index: number, msg: string) {\n\t\tconst me = utils.getMe();\n\t\tif (!me.hand) me.hand = [];\n\t\tconst MAX_HAND_SIZE = 3;\n\t\tif (me.hand.length === MAX_HAND_SIZE) {\n\t\t\talert(`Already have ${MAX_HAND_SIZE} cards`);\n\t\t\treturn;\n\t\t}\n\t\tthis.props.selectGold();\n\t\tutils.gainToken(Token.gold);\n\t\tconst card = store.gameW.game.cards[level]!.splice(index, 1)[0];\n\t\tif (!card) return;\n\t\tme.hand.push(card);\n\t\tutils.finishTurn(`reserved a ${msg}`);\n\t}\n}\n\nexport default Cards;\n","import React from \"react\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport { store } from \"../utils/utils\";\nimport { Token } from \"../utils/bank\";\n\nclass Nobles extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t<h2>Nobles</h2>\n\t\t\t\t\t{(store.gameW.game.nobles || []).map((n, index) => (\n\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t{Object.entries(n)\n\t\t\t\t\t\t\t\t.map(([token, count]) => ({\n\t\t\t\t\t\t\t\t\ttoken: parseInt(token),\n\t\t\t\t\t\t\t\t\tcount,\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t\t\t({ token, count }) =>\n\t\t\t\t\t\t\t\t\t\t`${Token[token]}: ${count}`\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.join(\" \")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Nobles;\n","import React from \"react\";\n\nimport styles from \"../../../../shared/styles.module.css\";\nimport utils, { store } from \"../utils/utils\";\nimport { Token } from \"../utils/bank\";\n\ntype PropsType = {\n\tgoldSelected: boolean;\n\tselectGold: (force: boolean) => void;\n};\n\nclass Tokens extends React.Component<PropsType, { [t in Token]?: boolean }> {\n\tconstructor(props: PropsType) {\n\t\tsuper(props);\n\t\tthis.state = {};\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={styles.bubble}>\n\t\t\t\t<h2>Bank</h2>\n\t\t\t\t<div>\n\t\t\t\t\t{Object.keys(store.gameW.game.tokens)\n\t\t\t\t\t\t.map((t) => parseInt(t))\n\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t(token) =>\n\t\t\t\t\t\t\t\ttoken !== Token.gold && (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tonClick={() => this.select(token)}\n\t\t\t\t\t\t\t\t\t\tkey={token}\n\t\t\t\t\t\t\t\t\t\tclassName={`${\n\t\t\t\t\t\t\t\t\t\t\tthis.isSelected(token) &&\n\t\t\t\t\t\t\t\t\t\t\tstyles.grey\n\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{this.renderToken(token)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)}\n\t\t\t\t\t<button onClick={this.take.bind(this)}>Take</button>\n\t\t\t\t\t<div\n\t\t\t\t\t\tonClick={() => this.selectGold(true)}\n\t\t\t\t\t\tclassName={`${this.props.goldSelected && styles.grey}`}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.renderToken(Token.gold)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderToken(token: Token) {\n\t\treturn `${Token[token!]}: ${store.gameW.game.tokens[token]}`;\n\t}\n\n\tselect(token: Token) {\n\t\tthis.selectGold(false);\n\t\tconst MAX_TOKENS = 3;\n\t\tif (!this.isSelected(token)) {\n\t\t\tif (\n\t\t\t\tObject.values(this.state).filter(Boolean).length === MAX_TOKENS\n\t\t\t) {\n\t\t\t\talert(`Can only select ${MAX_TOKENS} tokens`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis.setState({ [token]: !this.isSelected(token) });\n\t}\n\n\tselectGold(allowSelect: boolean) {\n\t\tthis.props.selectGold(allowSelect);\n\t\tif (allowSelect) this.clearSelect();\n\t}\n\n\tclearSelect() {\n\t\tconst s: { [n: number]: boolean } = {};\n\t\tObject.keys(this.state)\n\t\t\t.map((t) => parseInt(t))\n\t\t\t.forEach((t) => (s[t] = false));\n\t\tthis.setState(s);\n\t}\n\n\tisSelected(token: Token) {\n\t\tif (token === Token.gold) return this.props.goldSelected;\n\t\treturn this.state[token];\n\t}\n\n\ttake() {\n\t\tif (!utils.isMyTurn()) return;\n\t\tif (this.props.goldSelected) {\n\t\t\talert(\"To take a gold, reserve a card.\");\n\t\t\treturn;\n\t\t}\n\t\tconst toTake: Token[] = Object.entries(this.state)\n\t\t\t.map(([token, selected]) => ({\n\t\t\t\ttoken: parseInt(token),\n\t\t\t\tselected,\n\t\t\t}))\n\t\t\t.filter((obj) => obj.selected)\n\t\t\t.map((obj) => obj.token);\n\t\tvar num: number;\n\t\tvar min: number;\n\t\tif (toTake.length === 1) {\n\t\t\tconst MIN_TO_TAKE_2 = 6;\n\t\t\tnum = 2;\n\t\t\tmin = MIN_TO_TAKE_2;\n\t\t} else if (toTake.length === 3) {\n\t\t\tnum = 1;\n\t\t\tmin = 1;\n\t\t} else {\n\t\t\talert(\"Need to select either 1 or 3 token types.\");\n\t\t\treturn;\n\t\t}\n\t\tvar allowed = true;\n\t\ttoTake.forEach(\n\t\t\t(t) => (allowed = allowed && store.gameW.game.tokens[t]! >= min)\n\t\t);\n\t\tif (!allowed) {\n\t\t\talert(\"Not allowed\");\n\t\t\treturn;\n\t\t}\n\t\ttoTake.forEach((t) => utils.gainToken(t, num));\n\t\tutils.getMe().tokens!.sort();\n\t\tthis.clearSelect();\n\t\tutils.finishTurn(`took ${toTake.map((t) => Token[t]).join(\", \")}`);\n\t}\n}\n\nexport default Tokens;\n","import React from \"react\";\n\nimport Me from \"./Me\";\nimport Players from \"./Players\";\nimport Cards from \"./Cards\";\nimport Nobles from \"./Nobles\";\nimport Tokens from \"./Tokens\";\nimport { Level, Token, Card } from \"../utils/bank\";\nimport utils, { store } from \"../utils/utils\";\n\nclass Main extends React.Component<\n\t{},\n\t{ goldSelected: boolean; selectedTokens: { [n: number]: boolean } }\n> {\n\tconstructor(props: {}) {\n\t\tsuper(props);\n\t\tthis.state = { goldSelected: false, selectedTokens: {} };\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Tokens\n\t\t\t\t\tgoldSelected={this.state.goldSelected}\n\t\t\t\t\tselectGold={this.selectGold.bind(this)}\n\t\t\t\t/>\n\t\t\t\t<Me\n\t\t\t\t\tselectedTokens={this.state.selectedTokens}\n\t\t\t\t\tselectToken={this.selectToken.bind(this)}\n\t\t\t\t\tbuyHandCard={this.buyHandCard.bind(this)}\n\t\t\t\t/>\n\t\t\t\t<Cards\n\t\t\t\t\tselectGold={this.selectGold.bind(this)}\n\t\t\t\t\tgoldSelected={this.state.goldSelected}\n\t\t\t\t\tbuyCard={this.buyCard.bind(this)}\n\t\t\t\t/>\n\t\t\t\t<Players />\n\t\t\t\t<Nobles />\n\t\t\t</>\n\t\t);\n\t}\n\n\tselectToken(index: number) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst selectedTokens = Object.assign(this.state.selectedTokens, {\n\t\t\t[index]: !this.state.selectedTokens[index],\n\t\t});\n\t\tthis.setState({ selectedTokens });\n\t}\n\n\tbuyCard(level: Level, index: number) {\n\t\tconst card = store.gameW.game.cards[level]![index];\n\t\tif (!this.buyCardHelper(card)) return;\n\t\tstore.gameW.game.cards[level]!.splice(index, 1);\n\t\tutils.finishTurn(`bought a card`);\n\t}\n\n\tbuyHandCard(index: number) {\n\t\tif (!utils.isMyTurn()) return;\n\t\tconst me = utils.getMe();\n\t\tconst card = me.hand![index];\n\t\tif (!this.buyCardHelper(card)) return;\n\t\tme.hand!.splice(index, 1);\n\t\tutils.finishTurn(`bought a card from hand`);\n\t}\n\n\tbuyCardHelper(card: Card): boolean {\n\t\tconst price = Object.assign({}, card.price);\n\t\tconst me = utils.getMe();\n\t\t(me.cards || []).forEach((c) => price[c.color] && price[c.color]!--);\n\t\tvar goldToPay = 0;\n\t\tObject.entries(this.state.selectedTokens)\n\t\t\t.map(([index, selected]) => ({\n\t\t\t\tindex: parseInt(index),\n\t\t\t\tselected,\n\t\t\t}))\n\t\t\t.filter((obj) => obj.selected)\n\t\t\t.map((obj) => obj.index)\n\t\t\t.map((index) => me.tokens![index])\n\t\t\t.forEach((t) => {\n\t\t\t\tif (t === Token.gold) {\n\t\t\t\t\tgoldToPay++;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprice[t]!--;\n\t\t\t});\n\t\tvar outstanding = 0;\n\t\tObject.keys(price)\n\t\t\t.map((t) => parseInt(t))\n\t\t\t.forEach((t: Token) => {\n\t\t\t\tlet bill: number = price[t]!;\n\t\t\t\tif (bill < 0) outstanding = NaN;\n\t\t\t\toutstanding += bill;\n\t\t\t});\n\t\tif (outstanding !== goldToPay) {\n\t\t\talert(\"Incorrect payment\");\n\t\t\treturn false;\n\t\t}\n\t\tObject.entries(this.state.selectedTokens)\n\t\t\t.map(([index, selected]) => ({\n\t\t\t\tindex: parseInt(index),\n\t\t\t\tselected,\n\t\t\t}))\n\t\t\t.filter((obj) => obj.selected)\n\t\t\t.map((obj) => obj.index)\n\t\t\t.sort()\n\t\t\t.forEach(\n\t\t\t\t(index, time) =>\n\t\t\t\t\tstore.gameW.game.tokens[\n\t\t\t\t\t\tme.tokens!.splice(index - time, 1)[0]!\n\t\t\t\t\t]++\n\t\t\t);\n\t\tif (!me.cards) me.cards = [];\n\t\tme.cards.push(card);\n\t\tme.cards.sort((a, b) => this.handValue(a) - this.handValue(b));\n\t\tconst myColors: { [t in Token]?: number } = {};\n\t\tme.cards.forEach((c) => {\n\t\t\tmyColors[c.color] = 1 + (myColors[c.color] || 0);\n\t\t});\n\t\tif (store.gameW.game.nobles) {\n\t\t\tstore.gameW.game.nobles\n\t\t\t\t.map((noble, index) => ({ noble, index }))\n\t\t\t\t.filter(\n\t\t\t\t\t(obj) =>\n\t\t\t\t\t\tObject.entries(obj.noble)\n\t\t\t\t\t\t\t.map(([token, number]) => ({\n\t\t\t\t\t\t\t\ttoken: parseInt(token) as Token,\n\t\t\t\t\t\t\t\tnumber,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t\t(obj) =>\n\t\t\t\t\t\t\t\t\t(myColors[obj.token] || 0) < obj.number!\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.filter(Boolean).length === 0\n\t\t\t\t)\n\t\t\t\t.forEach((obj, time) => {\n\t\t\t\t\tstore.gameW.game.nobles!.splice(obj.index - time, 1);\n\t\t\t\t\tme.nobles++;\n\t\t\t\t});\n\t\t}\n\t\tif (!store.gameW.game.over && utils.getScore(me) >= 15) {\n\t\t\tstore.gameW.info.alert = \"This is the last round.\";\n\t\t\tstore.gameW.game.over = true;\n\t\t}\n\t\tthis.setState({ selectedTokens: {}, goldSelected: false });\n\t\treturn true;\n\t}\n\n\thandValue(c: Card) {\n\t\treturn parseInt(\n\t\t\t`${c.level}${c.color}.${Array.from(JSON.stringify(c)).map((i) =>\n\t\t\t\ti.codePointAt(0)\n\t\t\t)}`\n\t\t);\n\t}\n\n\tselectGold(allowSelect: boolean = false) {\n\t\tthis.setState({\n\t\t\tgoldSelected: allowSelect && !this.state.goldSelected,\n\t\t});\n\t}\n}\n\nexport default Main;\n","import { LobbyType } from \"../../../../shared/store\";\n\nimport utils, { store } from \"./utils\";\nimport bank, { Token, Card, Level } from \"./bank\";\n\nexport type GameType = {\n\tparams: Params;\n\tcurrentPlayer: number;\n\tplayers: PlayerType[];\n\tcards: { [l in Level]?: Card[] };\n\tnobles?: { [t in Token]?: number }[];\n\ttokens: { [t in Token]: number };\n\ttooManyTokens?: boolean;\n\tover: boolean;\n};\n\nexport type Params = {\n\tlobby: LobbyType;\n};\n\nexport type PlayerType = {\n\tuserId: string;\n\tuserName: string;\n\ttokens?: Token[];\n\thand?: Card[];\n\tcards?: Card[];\n\tnobles: number;\n};\n\nfunction NewGame(params: Params): PromiseLike<GameType> {\n\t// @ts-ignore game being constructed\n\tconst game: GameType = {};\n\tgame.params = params;\n\treturn Promise.resolve(game)\n\t\t.then(setPlayers)\n\t\t.then(setCards)\n\t\t.then(setNobles)\n\t\t.then(setTokens);\n}\n\nfunction setPlayers(game: GameType): GameType {\n\tgame.players = Object.entries(store.lobby)\n\t\t.sort((a, b) => (b[0] === store.me.userId ? 1 : -1))\n\t\t.map(([userId, userName]) => ({\n\t\t\tuserId,\n\t\t\tuserName,\n\t\t\tnobles: 0,\n\t\t}));\n\tgame.currentPlayer = utils.myIndex(game);\n\treturn game;\n}\n\nfunction setCards(game: GameType): GameType {\n\t// @ts-ignore initializing cards\n\tgame.cards = {};\n\tutils.enumArray(Level).forEach((l: Level) => {\n\t\tgame.cards[l] = utils.shuffle(bank.cards.filter((c) => c.level === l));\n\t});\n\treturn game;\n}\n\nfunction setNobles(game: GameType): GameType {\n\tgame.nobles = utils.shuffle(bank.nobles).slice(0, game.players.length + 1);\n\treturn game;\n}\n\nfunction setTokens(game: GameType): GameType {\n\t// @ts-ignore initializing tokens\n\tgame.tokens = {};\n\tutils.enumArray(Token).forEach((t: Token) => {\n\t\tvar count;\n\t\tif (t === Token.gold) {\n\t\t\tcount = 5;\n\t\t} else if (game.players.length === 2) {\n\t\t\tcount = 4;\n\t\t} else if (game.players.length === 3) {\n\t\t\tcount = 5;\n\t\t} else {\n\t\t\tcount = 7;\n\t\t}\n\t\tgame.tokens[t] = count;\n\t});\n\treturn game;\n}\n\nexport default NewGame;\n","import React from \"react\";\n\nimport utils, { store } from \"../utils/utils\";\nimport NewGame, { Params } from \"../utils/NewGame\";\n\nimport SharedSidebar from \"../../../../shared/components/sidebar/SharedSidebar\";\n\nclass Sidebar extends SharedSidebar<Params> {\n\tname = \"Splendor\";\n\tNewGame = NewGame;\n\tisMyTurn = utils.isMyTurn.bind(utils);\n\n\trenderStartNewGame() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<button onClick={this.startNewGame.bind(this)}>New Game</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tgetParams(): Params {\n\t\treturn { lobby: store.lobby };\n\t}\n}\n\nexport default Sidebar;\n","import fox from \"../routes/fox/app/Fox\";\nimport timeline from \"../routes/timeline/app/Timeline\";\nimport _7wd from \"../routes/7wd/app/X7wd\";\nimport loveletter from \"../routes/love_letter/app/LoveLetter\";\nimport splendor from \"../routes/splendor/app/Splendor\";\n\nexport default { fox, timeline, \"7wd\": _7wd, loveletter, splendor };\n","import React from \"react\";\n\nimport utils, { store } from \"./utils/utils\";\nimport Main from \"./main/Main\";\nimport Sidebar from \"./sidebar/Sidebar\";\n\nimport styles from \"../../../shared/styles.module.css\";\n\nclass Splendor extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={`${utils.isMyTurn() && styles.my_turn}`}>\n\t\t\t\t<div className={styles.main}>\n\t\t\t\t\t<Sidebar />\n\t\t\t\t\t<div className={styles.content}>\n\t\t\t\t\t\t<div>{store.gameW.game && <Main />}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Splendor;\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport games from \"../games\";\n\nimport styles from \"../../shared/styles.module.css\";\n\nclass Home extends React.Component {\n\trender() {\n\t\treturn <h2>{Object.keys(games).map(this.renderLink.bind(this))}</h2>;\n\t}\n\n\trenderLink(gameName: string) {\n\t\treturn (\n\t\t\t<div key={gameName} className={styles.bubble}>\n\t\t\t\t<Link to={`/${gameName}`}>{gameName.toLocaleUpperCase()}</Link>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Home;\n","import React from \"react\";\nclass LoadingPage extends React.Component {\n\trender() {\n\t\treturn \"Loading...\";\n\t}\n}\n\nexport default LoadingPage;\n","import React, { FormEvent } from \"react\";\n\nimport store from \"../../shared/store\";\nimport writer from \"../writer/writer\";\n\nimport styles from \"../../shared/styles.module.css\";\nimport css from \"./index.module.css\";\n\nclass LoginPage extends React.Component {\n\tinputRef: React.RefObject<HTMLInputElement> = React.createRef();\n\trender() {\n\t\treturn (\n\t\t\t<div className={`${css.login} ${styles.bubble}`}>\n\t\t\t\t<p>Welcome to {store.me.gameName}!</p>\n\t\t\t\t<p>Enter your name to continue</p>\n\t\t\t\t<form onSubmit={this.setUsername.bind(this)}>\n\t\t\t\t\t<input type=\"text\" ref={this.inputRef} />\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tsetUsername(e: FormEvent<HTMLFormElement>): void {\n\t\te.preventDefault();\n\t\tconst username: string = this.inputRef.current!.value;\n\t\twriter.setUsername(username);\n\t}\n}\n\nexport default LoginPage;\n","import React from \"react\";\n\nimport store from \"../../shared/store\";\n\nimport writer from \"../writer/writer\";\n\nimport LoadingPage from \"./LoadingPage\";\nimport LoginPage from \"./LoginPage\";\n\nclass GameWrapper extends React.Component<{\n\tcomponent: typeof React.Component;\n\tgameName: string;\n\troomId: number;\n}> {\n\tcomponentDidMount() {\n\t\tdocument.title = this.props.gameName.toLocaleUpperCase();\n\t\twriter.init(\n\t\t\tthis.props.roomId,\n\t\t\tthis.props.gameName,\n\t\t\tthis.forceUpdate.bind(this)\n\t\t);\n\t}\n\n\trender() {\n\t\tif (!store.lobby) return <LoadingPage />;\n\t\tif (!store.lobby[store.me.userId]) return <LoginPage />;\n\t\tif (!store.gameW) return null;\n\t\treturn <this.props.component />;\n\t}\n}\n\nexport default GameWrapper;\n","import React from \"react\";\nimport {\n\tBrowserRouter as Router,\n\tRoute,\n\tRouteComponentProps,\n} from \"react-router-dom\";\n\nimport games from \"./firegame/games\";\n\nimport Home from \"./firegame/components/Home\";\nimport GameWrapper from \"./firegame/components/GameWrapper\";\n\nfunction App() {\n\treturn (\n\t\t<Router>\n\t\t\t<div>\n\t\t\t\t<Route exact path=\"/\" component={Home} />\n\t\t\t\t{getRoutes()}\n\t\t\t</div>\n\t\t</Router>\n\t);\n}\n\nfunction getRoutes(): JSX.Element {\n\tconst routes: JSX.Element[] = [];\n\tfor (let [gameName, component] of Object.entries(games)) {\n\t\troutes.push(\n\t\t\t<Route\n\t\t\t\tkey={gameName}\n\t\t\t\tpath={`/${gameName}/:roomId(\\\\d+)?`}\n\t\t\t\trender={(props: RouteComponentProps<{ roomId: string }>) => (\n\t\t\t\t\t<GameWrapper\n\t\t\t\t\t\tcomponent={component}\n\t\t\t\t\t\tgameName={gameName}\n\t\t\t\t\t\troomId={parseInt(props.match.params.roomId) || -1}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t/>\n\t\t);\n\t}\n\treturn <>{routes}</>;\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"info\":\"app_info__C4YU0\",\"image\":\"app_image__1tZgk\",\"settings_form\":\"app_settings_form__uelWK\",\"settings_input\":\"app_settings_input__2uaOu\",\"settings_select\":\"app_settings_select__1jS9v\",\"card\":\"app_card__2q0oc\",\"target\":\"app_target__n2IMe\",\"selectedCard\":\"app_selectedCard__o9hZ5\",\"correct\":\"app_correct__BEfuw\",\"incorrect\":\"app_incorrect__13cEZ\",\"wrongTarget\":\"app_wrongTarget__7fKUB\",\"board_card\":\"app_board_card__24D1v\"};"],"sourceRoot":""}